{
  "name": "Teams-Outlook RAG Assistant (Agent Generated)",
  "nodes": [
    {
      "name": "Outlook Email Trigger",
      "type": "n8n-nodes-base.microsoftOutlookTrigger",
      "position": [
        0,
        0
      ],
      "parameters": {
        "pollInterval": 60
      },
      "id": "08e1edec-e09b-4852-a24d-bebf3fe16c23",
      "typeVersion": 1
    },
    {
      "name": "Process Email for RAG",
      "type": "n8n-nodes-base.code",
      "position": [
        250,
        0
      ],
      "parameters": {
        "jsCode": "// Extract email body and metadata\nreturn items;"
      },
      "id": "d8902687-5126-49d0-afef-ce2ae37ce738",
      "typeVersion": 1
    },
    {
      "name": "Fraud Classifier",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        500,
        -150
      ],
      "parameters": {
        "mode": "text"
      },
      "id": "e5285b39-0398-4c37-ac0b-d091bf173de8",
      "typeVersion": 1
    },
    {
      "name": "Billing RAG Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        500,
        0
      ],
      "parameters": {
        "mode": "chat"
      },
      "id": "25ed52ef-041e-4670-badd-48da80a4cd4f",
      "typeVersion": 1
    },
    {
      "name": "High Priority RAG Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        500,
        150
      ],
      "parameters": {
        "mode": "chat"
      },
      "id": "3a28c6e3-bee0-4695-9ea2-9732599df729",
      "typeVersion": 1
    },
    {
      "name": "Teams Message Trigger",
      "type": "n8n-nodes-base.microsoftTeamsTrigger",
      "position": [
        0,
        400
      ],
      "parameters": {},
      "id": "45eb8605-7b3c-49e2-8aed-f263665b09f4",
      "typeVersion": 1
    },
    {
      "name": "Process Teams Input",
      "type": "n8n-nodes-base.code",
      "position": [
        250,
        400
      ],
      "parameters": {
        "jsCode": "// Format teams message for AI\nreturn items;"
      },
      "id": "12625239-3b06-48da-9ca2-631bc7a19a78",
      "typeVersion": 1
    },
    {
      "name": "AI Agent (Central)",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "position": [
        500,
        400
      ],
      "parameters": {
        "options": {
          "systemMessage": "You are a helpful Outlook & Teams assistant."
        }
      },
      "id": "283bbc5e-a7d9-4879-bc57-e5dca599b778",
      "typeVersion": 1
    },
    {
      "name": "Send Teams Response",
      "type": "n8n-nodes-base.microsoftTeams",
      "position": [
        800,
        400
      ],
      "parameters": {
        "operation": "sendMessage"
      },
      "id": "10dc5777-19ba-40cf-a4c2-e4b94912ee91",
      "typeVersion": 1
    },
    {
      "name": "Postgres Memory",
      "type": "n8n-nodes-base.postgres",
      "position": [
        400,
        600
      ],
      "parameters": {
        "operation": "executeQuery"
      },
      "id": "17f71809-8838-42b4-a706-b7bc252b71d3",
      "typeVersion": 1
    },
    {
      "name": "Search Emails",
      "type": "n8n-nodes-base.microsoftOutlook",
      "position": [
        500,
        600
      ],
      "parameters": {
        "resource": "message",
        "operation": "getAll"
      },
      "id": "ffa4110a-02a3-4a86-8cbe-16414673c42f",
      "typeVersion": 1
    },
    {
      "name": "Get Calendar Events",
      "type": "n8n-nodes-base.microsoftOutlook",
      "position": [
        650,
        600
      ],
      "parameters": {
        "resource": "event",
        "operation": "getAll"
      },
      "id": "3710212e-becf-4442-8d6f-b3d6409f99e5",
      "typeVersion": 1
    },
    {
      "name": "Create Calendar Event",
      "type": "n8n-nodes-base.microsoftOutlook",
      "position": [
        800,
        600
      ],
      "parameters": {
        "resource": "event",
        "operation": "create"
      },
      "id": "176c21ed-3cf9-4ea1-8f33-43a4dff29751",
      "typeVersion": 1
    },
    {
      "name": "Create Draft",
      "type": "n8n-nodes-base.microsoftOutlook",
      "position": [
        950,
        600
      ],
      "parameters": {
        "resource": "message",
        "operation": "create"
      },
      "id": "4c232c11-4e61-40fd-b0e5-38fb2975a969",
      "typeVersion": 1
    },
    {
      "name": "Send Email",
      "type": "n8n-nodes-base.microsoftOutlook",
      "position": [
        1100,
        600
      ],
      "parameters": {
        "resource": "message",
        "operation": "send"
      },
      "id": "6979cebc-7033-4297-83e5-d4207e6359fe",
      "typeVersion": 1
    },
    {
      "name": "OpenAI Chat Model",
      "type": "@n8n/n8n-nodes-langchain.openAiChatModel",
      "position": [
        200,
        400
      ],
      "parameters": {
        "model": "gpt-4o"
      },
      "id": "87a7a13c-f011-4807-8d54-246953aa7ff2",
      "typeVersion": 1
    },
    {
      "name": "Window Buffer Memory",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        200,
        550
      ],
      "parameters": {},
      "id": "9cd0912f-ed4e-4650-a063-eccf4b825ec8",
      "typeVersion": 1
    }
  ],
  "connections": {
    "Outlook Email Trigger": {
      "main": [
        [
          {
            "node": "Process Email for RAG",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Email for RAG": {
      "main": [
        [
          {
            "node": "Fraud Classifier",
            "type": "main",
            "index": 0
          },
          {
            "node": "Billing RAG Agent",
            "type": "main",
            "index": 0
          },
          {
            "node": "High Priority RAG Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Teams Message Trigger": {
      "main": [
        [
          {
            "node": "Process Teams Input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Teams Input": {
      "main": [
        [
          {
            "node": "AI Agent (Central)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent (Central)": {
      "main": [
        [
          {
            "node": "Send Teams Response",
            "type": "main",
            "index": 0
          },
          {
            "node": "Postgres Memory",
            "type": "main",
            "index": 0
          },
          {
            "node": "Search Emails",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get Calendar Events",
            "type": "main",
            "index": 0
          },
          {
            "node": "Create Calendar Event",
            "type": "main",
            "index": 0
          },
          {
            "node": "Create Draft",
            "type": "main",
            "index": 0
          },
          {
            "node": "Send Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "main": [
        [
          {
            "node": "Fraud Classifier",
            "type": "main",
            "index": 0
          },
          {
            "node": "Billing RAG Agent",
            "type": "main",
            "index": 0
          },
          {
            "node": "High Priority RAG Agent",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI Agent (Central)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Window Buffer Memory": {
      "main": [
        [
          {
            "node": "Fraud Classifier",
            "type": "main",
            "index": 0
          },
          {
            "node": "Billing RAG Agent",
            "type": "main",
            "index": 0
          },
          {
            "node": "High Priority RAG Agent",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI Agent (Central)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}