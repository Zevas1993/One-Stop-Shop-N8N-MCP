{
  "name": "AI Email Manager - Outlook & Teams",
  "description": "AI-powered email management agent that reads Outlook emails and responds via Microsoft Teams chat",
  "nodes": [
    {
      "parameters": {
        "path": "teams-email-manager",
        "options": {}
      },
      "id": "webhook-trigger",
      "name": "Webhook - Teams Chat",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [100, 300]
    },
    {
      "parameters": {
        "operation": "getMessages",
        "resource": "chatMessage",
        "limit": 50
      },
      "id": "teams-messages",
      "name": "Get Teams Messages",
      "type": "n8n-nodes-base.microsoftTeams",
      "typeVersion": 2,
      "position": [300, 300]
    },
    {
      "parameters": {
        "operation": "getEmails",
        "resource": "message",
        "mailbox": "user",
        "limit": 10
      },
      "id": "outlook-emails",
      "name": "Get Outlook Emails",
      "type": "n8n-nodes-base.microsoftOutlook",
      "typeVersion": 2,
      "position": [300, 500]
    },
    {
      "parameters": {
        "model": "gpt-4o-mini",
        "messages": {
          "messageValues": [
            {
              "content": "You are an AI Email Manager. Analyze the emails and Teams messages, then provide a brief response summarizing the emails and suggesting a reply."
            }
          ]
        }
      },
      "id": "openai-analyze",
      "name": "AI Email Analyzer",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 3,
      "position": [500, 300]
    },
    {
      "parameters": {
        "operation": "sendMessage",
        "resource": "chatMessage",
        "message": "Email analysis ready"
      },
      "id": "teams-response",
      "name": "Send Teams Response",
      "type": "n8n-nodes-base.microsoftTeams",
      "typeVersion": 2,
      "position": [700, 300]
    },
    {
      "parameters": {
        "operation": "sendEmail",
        "resource": "message",
        "subject": "Email Summary",
        "bodyContent": "Here is your email summary"
      },
      "id": "outlook-reply",
      "name": "Send Email Reply",
      "type": "n8n-nodes-base.microsoftOutlook",
      "typeVersion": 2,
      "position": [700, 500]
    },
    {
      "parameters": {},
      "id": "end",
      "name": "Complete",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [900, 400]
    }
  ],
  "connections": {
    "Webhook - Teams Chat": {
      "main": [
        [
          { "node": "Get Teams Messages", "type": "main", "index": 0 },
          { "node": "Get Outlook Emails", "type": "main", "index": 0 }
        ]
      ]
    },
    "Get Teams Messages": {
      "main": [
        [
          { "node": "AI Email Analyzer", "type": "main", "index": 0 }
        ]
      ]
    },
    "Get Outlook Emails": {
      "main": [
        [
          { "node": "AI Email Analyzer", "type": "main", "index": 0 }
        ]
      ]
    },
    "AI Email Analyzer": {
      "main": [
        [
          { "node": "Send Teams Response", "type": "main", "index": 0 },
          { "node": "Send Email Reply", "type": "main", "index": 0 }
        ]
      ]
    },
    "Send Teams Response": {
      "main": [
        [
          { "node": "Complete", "type": "main", "index": 0 }
        ]
      ]
    },
    "Send Email Reply": {
      "main": [
        [
          { "node": "Complete", "type": "main", "index": 0 }
        ]
      ]
    }
  }
}
