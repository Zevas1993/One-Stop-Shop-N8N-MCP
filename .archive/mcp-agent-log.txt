=== MCP AGENT SESSION START ===

[2025-11-25T00:56:17.974Z] STEP 1: Connecting to MCP server via stdio...
[2025-11-25T00:56:18.285Z] ‚úÖ Connected to MCP server

[2025-11-25T00:56:18.285Z] STEP 2: Calling workflow_manager with action='list'...
[2025-11-25T00:56:18.286Z] Request: { name: 'workflow_manager', arguments: { action: 'list' } }
[2025-11-25T00:56:18.335Z] 
Raw MCP Response:
[2025-11-25T00:56:18.337Z] {
  "content": [
    {
      "type": "text",
      "text": "{\n  \"success\": true,\n  \"data\": {\n    \"workflows\": [\n      {\n        \"createdAt\": \"2025-11-22T11:57:53.354Z\",\n        \"updatedAt\": \"2025-11-22T11:57:53.354Z\",\n        \"id\": \"2vxQTBROMOu5N4ss\",\n        \"name\": \"Teams-Outlook RAG Assistant (Agent Generated)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              0\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"93967975-dedc-4d45-99e3-836807b692e8\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              0\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body and metadata\\nreturn items;\"\n            },\n            \"id\": \"4a6a3806-2c23-41f8-8bf4-cea1a49f9072\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"n8n-nodes-base.aiAgent\",\n            \"position\": [\n              500,\n              -150\n            ],\n            \"parameters\": {\n              \"mode\": \"text\"\n            },\n            \"id\": \"919807bf-4d75-45e5-8a03-70f4137f1f0c\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"n8n-nodes-base.aiAgent\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"3b83a6b3-9ba2-430e-9d3f-f0401965a2c2\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"n8n-nodes-base.aiAgent\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"f7c680b3-0e41-4a40-b066-1d31213b2786\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              400\n            ],\n            \"parameters\": {},\n            \"id\": \"c6ec6ae6-4bb9-443d-be00-dc75f5dfa498\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Format teams message for AI\\nreturn items;\"\n            },\n            \"id\": \"8c592073-c472-4593-a39a-2f64e967ef98\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"n8n-nodes-base.aiAgent\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"systemMessage\": \"You are a helpful Outlook & Teams assistant.\"\n              }\n            },\n            \"id\": \"d32084a0-45ae-411b-b8ad-f436ff70699b\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              800,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"321db2af-62e8-404a-ab9a-39353bc88831\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Postgres Memory\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"position\": [\n              400,\n              650\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\"\n            },\n            \"id\": \"51d17a50-e8ef-421f-9556-6358caa5b899\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Email Search Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              500,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"40a4aec0-d712-4c33-a1a3-0a136301184b\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Calendar Management\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              600,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"7030bd7f-8c1d-4699-900f-208807b0afa7\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              700,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"c2ebb43d-9f70-4fbd-9dfe-b44110df95c5\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Postgres Memory\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Email Search Tool\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Calendar Management\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"8be55e0f-4c75-4802-8a8d-ad8eb82af45f\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-19T16:17:11.215Z\",\n        \"updatedAt\": \"2025-06-19T16:17:11.000Z\",\n        \"id\": \"5nwLsvR36Q9bACa5\",\n        \"name\": \"Draft Generation\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"parameters\": {},\n            \"id\": \"0be41c00-caa2-4bfb-bff6-87896d7a6f1e\",\n            \"name\": \"Workflow Trigger\",\n            \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n            \"typeVersion\": 1,\n            \"position\": [\n              0,\n              0\n            ]\n          },\n          {\n            \"parameters\": {},\n            \"id\": \"f122524b-8a62-406a-bbdc-214cba1f9eab\",\n            \"name\": \"Draft Generation AI\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1.3,\n            \"position\": [\n              200,\n              0\n            ]\n          },\n          {\n            \"parameters\": {\n              \"jsCode\": \"// Parse AI response and extract email components\\nconst aiResponse = $input.first().json.choices[0].message.content;\\n\\n// Try to extract subject and body from AI response\\nlet subject = '';\\nlet body = '';\\n\\n// Look for subject line\\nconst subjectMatch = aiResponse.match(/Subject:\\\\s*(.+?)\\\\n/i);\\nif (subjectMatch) {\\n  subject = subjectMatch[1].trim();\\n  body = aiResponse.replace(/Subject:\\\\s*.+?\\\\n/i, '').trim();\\n} else {\\n  // If no subject found, use first line or generate one\\n  const lines = aiResponse.split('\\\\n');\\n  if (lines.length > 0 && lines[0].length < 100) {\\n    subject = lines[0].trim();\\n    body = lines.slice(1).join('\\\\n').trim();\\n  } else {\\n    subject = 'Email Draft';\\n    body = aiResponse;\\n  }\\n}\\n\\nreturn [{\\n  json: {\\n    subject,\\n    body,\\n    fullResponse: aiResponse,\\n    draftId: 'draft_' + Date.now(),\\n    createdAt: new Date().toISOString(),\\n    status: 'pending_approval'\\n  }\\n}];\"\n            },\n            \"id\": \"7ecc0554-aef8-40ba-b36f-b65f061ccde6\",\n            \"name\": \"Parse Draft Content\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"typeVersion\": 2,\n            \"position\": [\n              400,\n              0\n            ]\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"draft\",\n              \"subject\": \"={{ $json.subject }}\",\n              \"bodyContent\": \"={{ $json.body }}\",\n              \"additionalFields\": {}\n            },\n            \"id\": \"12e4e25d-8401-4e3d-91ab-564b4864d9a2\",\n            \"name\": \"Create Outlook Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              600,\n              0\n            ],\n            \"webhookId\": \"a781e90c-b341-4f3c-82e7-f4fa1e024796\"\n          },\n          {\n            \"parameters\": {\n              \"schema\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"public\"\n              },\n              \"table\": \"draft_approvals\",\n              \"columns\": \"draft_id,outlook_draft_id,subject,body,status,created_at\",\n              \"options\": {}\n            },\n            \"id\": \"e37b053e-5fee-406b-bad4-253086a743a6\",\n            \"name\": \"Store Draft for Approval\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"typeVersion\": 2.4,\n            \"position\": [\n              800,\n              0\n            ]\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"channelMessage\",\n              \"teamId\": \"{{ $vars.TEAMS_TEAM_ID }}\",\n              \"channelId\": \"{{ $vars.TEAMS_CHANNEL_ID }}\",\n              \"message\": {\n                \"body\": {\n                  \"contentType\": \"html\",\n                  \"content\": \"<h3>üìß New Email Draft Ready for Review</h3><p><strong>Subject:</strong> {{ $('Parse Draft Content').item.json.subject }}</p><p><strong>Preview:</strong></p><div style='border-left: 3px solid #0078d4; padding-left: 10px; margin: 10px 0;'>{{ $('Parse Draft Content').item.json.body.substring(0, 200) }}...</div><p><a href='{{ $vars.N8N_WEBHOOK_URL }}/webhook/approve-draft?id={{ $('Parse Draft Content').item.json.draftId }}'>‚úÖ Approve</a> | <a href='{{ $vars.N8N_WEBHOOK_URL }}/webhook/reject-draft?id={{ $('Parse Draft Content').item.json.draftId }}'>‚ùå Reject</a></p>\"\n                }\n              },\n              \"options\": {}\n            },\n            \"id\": \"2f3bf1be-12da-4663-ac08-5d102710be30\",\n            \"name\": \"Send Teams Approval Request\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1000,\n              0\n            ],\n            \"webhookId\": \"2720d9ce-bcf7-48ff-8a8e-4f21987b8b66\"\n          }\n        ],\n        \"connections\": {\n          \"Parse Draft Content\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Create Outlook Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Create Outlook Draft\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Store Draft for Approval\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Store Draft for Approval\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Approval Request\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\"\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"c36384a8-42b5-46b4-976c-b8fd63aea8de\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-22T18:24:55.349Z\",\n        \"updatedAt\": \"2025-11-22T18:24:55.349Z\",\n        \"id\": \"6MDNTFs7ZBZKP8Dg\",\n        \"name\": \"Teams-Outlook RAG Assistant (Agent Generated)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              0\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"de18c13a-f378-419b-9796-dd6901f9706e\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              0\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body and metadata\\nreturn items;\"\n            },\n            \"id\": \"c1516599-5ffd-42ce-98ec-69f92b452746\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              -150\n            ],\n            \"parameters\": {\n              \"mode\": \"text\"\n            },\n            \"id\": \"b9810b54-e7b3-4754-9310-8bd26dcca81a\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"9b41933c-752a-4e04-9866-84a7cdda31f1\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"ef8d95c3-d5ac-4c16-80f9-952d0592caae\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              400\n            ],\n            \"parameters\": {},\n            \"id\": \"2456b7fe-5e18-48ac-a8da-6eb8b2776c8b\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Format teams message for AI\\nreturn items;\"\n            },\n            \"id\": \"c9e3ea9f-bbb3-4986-b5d0-552e4c8b8118\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"systemMessage\": \"You are a helpful Outlook & Teams assistant.\"\n              }\n            },\n            \"id\": \"94c9d884-c16d-48f4-befd-187654570dae\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              800,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"9710d855-3066-4f98-a213-cfd5daa071f6\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Postgres Memory\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"position\": [\n              400,\n              600\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\"\n            },\n            \"id\": \"92e24c41-5b14-4ca6-99a2-281a55f71886\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Search Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              500,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"46c900e0-57c5-42ea-9789-1d916420303f\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Get Calendar Events\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              650,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"cdf9385b-7236-40dc-8ed9-92836f8a5f04\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Calendar Event\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              800,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"b9872aba-b32a-467d-8eb7-70393df5a7f0\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              950,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"99c768fa-70eb-44aa-80e6-30d70a4ac710\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              1100,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"send\"\n            },\n            \"id\": \"fb2a8c13-dadb-4e53-8a3e-c9e1f34f5d30\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAiChatModel\",\n            \"position\": [\n              200,\n              400\n            ],\n            \"parameters\": {\n              \"model\": \"gpt-4o\"\n            },\n            \"id\": \"bd28e3a5-9b54-4b10-94bd-5bde8ae4efde\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Window Buffer Memory\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              200,\n              550\n            ],\n            \"parameters\": {},\n            \"id\": \"e7f97d19-728d-47a6-90a0-cb0fb3925b0d\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Postgres Memory\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Search Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Get Calendar Events\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Calendar Event\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Send Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Window Buffer Memory\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"42c7972f-1b5b-4a6c-a25d-ac7e1b24176b\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-19T01:47:21.210Z\",\n        \"updatedAt\": \"2025-07-19T01:48:15.398Z\",\n        \"id\": \"7qQAsJd2JLGDFV6V\",\n        \"name\": \"Email RAG Ingestion Pipeline\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"email-ingestion-trigger\",\n            \"name\": \"Email Ingestion Trigger\",\n            \"type\": \"n8n-nodes-base.cron\",\n            \"position\": [\n              200,\n              300\n            ],\n            \"parameters\": {\n              \"triggerTimes\": {\n                \"item\": [\n                  {\n                    \"mode\": \"everyMinute\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1.1\n          },\n          {\n            \"id\": \"fetch-email-batch\",\n            \"name\": \"Fetch Email Batch\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              400,\n              300\n            ],\n            \"parameters\": {\n              \"limit\": 50,\n              \"options\": {},\n              \"operation\": \"getAll\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"process-email-content\",\n            \"name\": \"Process Email Content\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"typeVersion\": 3.4,\n            \"position\": [\n              600,\n              300\n            ],\n            \"parameters\": {\n              \"options\": {},\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"email-content\",\n                    \"name\": \"content\",\n                    \"type\": \"string\",\n                    \"value\": \"=Subject: {{ $json.subject }}\\nFrom: {{ $json.sender?.emailAddress?.address || 'Unknown' }}\\nTo: {{ $json.toRecipients?.map(r => r.emailAddress?.address).join(', ') || 'Unknown' }}\\nDate: {{ $json.receivedDateTime }}\\nImportance: {{ $json.importance }}\\n\\n{{ $json.body?.content || $json.bodyPreview || 'No content available' }}\"\n                  },\n                  {\n                    \"id\": \"metadata\",\n                    \"name\": \"metadata\",\n                    \"type\": \"object\",\n                    \"value\": \"={{ { emailId: $json.id, sender: $json.sender?.emailAddress?.address, subject: $json.subject, receivedDate: $json.receivedDateTime, importance: $json.importance } }}\"\n                  }\n                ]\n              }\n            }\n          },\n          {\n            \"id\": \"text-chunker\",\n            \"name\": \"Text Chunker\",\n            \"type\": \"@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter\",\n            \"typeVersion\": 1,\n            \"position\": [\n              800,\n              300\n            ],\n            \"parameters\": {\n              \"chunkSize\": 1000,\n              \"chunkOverlap\": 200\n            }\n          },\n          {\n            \"id\": \"document-loader\",\n            \"name\": \"Document Loader\",\n            \"type\": \"@n8n/n8n-nodes-langchain.documentDefaultDataLoader\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1000,\n              300\n            ],\n            \"parameters\": {\n              \"jsonMode\": \"expressionData\",\n              \"jsonData\": \"={{ $json.content }}\",\n              \"options\": {\n                \"metadata\": {\n                  \"metadataValues\": [\n                    {\n                      \"name\": \"emailId\",\n                      \"value\": \"={{ $json.metadata.emailId }}\"\n                    },\n                    {\n                      \"name\": \"sender\",\n                      \"value\": \"={{ $json.metadata.sender }}\"\n                    },\n                    {\n                      \"name\": \"subject\",\n                      \"value\": \"={{ $json.metadata.subject }}\"\n                    },\n                    {\n                      \"name\": \"receivedDate\",\n                      \"value\": \"={{ $json.metadata.receivedDate }}\"\n                    }\n                  ]\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"email-embeddings\",\n            \"name\": \"Email Embeddings\",\n            \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1200,\n              200\n            ],\n            \"parameters\": {\n              \"model\": \"text-embedding-3-small\",\n              \"options\": {}\n            }\n          },\n          {\n            \"id\": \"store-vector-db\",\n            \"name\": \"Store in Vector DB\",\n            \"type\": \"@n8n/n8n-nodes-langchain.vectorStorePineconeInsert\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1200,\n              300\n            ],\n            \"parameters\": {\n              \"indexName\": \"email-knowledge-base\",\n              \"options\": {}\n            }\n          },\n          {\n            \"id\": \"batch-status\",\n            \"name\": \"Update Batch Status\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"typeVersion\": 3.4,\n            \"position\": [\n              1400,\n              300\n            ],\n            \"parameters\": {\n              \"options\": {},\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"processed-count\",\n                    \"name\": \"processedEmails\",\n                    \"type\": \"number\",\n                    \"value\": \"={{ $('Store in Vector DB').item.json.length || 1 }}\"\n                  },\n                  {\n                    \"id\": \"batch-timestamp\",\n                    \"name\": \"batchTimestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $now.toISOString() }}\"\n                  },\n                  {\n                    \"id\": \"status\",\n                    \"name\": \"status\",\n                    \"type\": \"string\",\n                    \"value\": \"batch_completed\"\n                  }\n                ]\n              }\n            }\n          }\n        ],\n        \"connections\": {\n          \"Email Ingestion Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fetch Email Batch\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Fetch Email Batch\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email Content\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email Content\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Text Chunker\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Text Chunker\": {\n            \"ai_textSplitter\": [\n              [\n                {\n                  \"node\": \"Document Loader\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Document Loader\": {\n            \"ai_document\": [\n              [\n                {\n                  \"node\": \"Store in Vector DB\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Embeddings\": {\n            \"ai_embedding\": [\n              [\n                {\n                  \"node\": \"Store in Vector DB\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Store in Vector DB\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Update Batch Status\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"7e1c9fb0-fb8a-4554-ba5b-b13e71cfff0a\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-22T12:44:42.436Z\",\n        \"updatedAt\": \"2025-11-22T12:44:42.436Z\",\n        \"id\": \"8ce8hR16XxGresgi\",\n        \"name\": \"Teams-Outlook RAG Assistant (Agent Generated)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              0\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"a4811d40-f23e-41ea-8ded-4a7b78d9bce9\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              0\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body and metadata\\nreturn items;\"\n            },\n            \"id\": \"ab0cb355-3b06-49a0-ae2c-8abeadff2359\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              -150\n            ],\n            \"parameters\": {\n              \"mode\": \"text\"\n            },\n            \"id\": \"07adadda-9253-4403-85c9-d54fe3d07189\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"c50d1d5c-ab8c-4067-a767-a0df0cb64180\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"6ea99c55-a9fa-4c9d-983c-f29a309b383d\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              400\n            ],\n            \"parameters\": {},\n            \"id\": \"a4fbdcdc-169e-4861-90c3-c6b0f4373d03\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Format teams message for AI\\nreturn items;\"\n            },\n            \"id\": \"828472c0-b6d8-4655-86d1-906a91638634\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"systemMessage\": \"You are a helpful Outlook & Teams assistant.\"\n              }\n            },\n            \"id\": \"19377a6d-db48-4790-9a28-10be9f4c3c76\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              800,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"53a41675-6fb0-4fb3-afc1-f64b237c3689\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Postgres Memory\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"position\": [\n              400,\n              650\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\"\n            },\n            \"id\": \"2ee12c22-bfc8-4656-8c02-9892383bd670\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Email Search Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              500,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"dff8770a-8201-4d6f-9062-f8236a2ad72a\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Calendar Management\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              600,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"233fede8-3b82-44aa-a647-0448f4b4d504\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              700,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"d01af109-42ad-42ed-b4ae-d8863a8ee186\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAiChatModel\",\n            \"position\": [\n              200,\n              400\n            ],\n            \"parameters\": {\n              \"model\": \"gpt-4o\"\n            },\n            \"id\": \"06428483-a37c-4cac-87be-302c29562ee3\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Window Buffer Memory\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              200,\n              550\n            ],\n            \"parameters\": {},\n            \"id\": \"5a0202b9-bcc4-4aab-8ab5-158e02789647\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Postgres Memory\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Email Search Tool\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Calendar Management\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Window Buffer Memory\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"539cb684-3fc8-47f2-afe8-1e6d28f06b65\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-06T13:59:44.761Z\",\n        \"updatedAt\": \"2025-11-23T00:32:04.899Z\",\n        \"id\": \"A9h8Zsm6kYpsmilu\",\n        \"name\": \"Teams-Outlook RAG Assistant - Natural Language Ready\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              200\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"1713fd7c-2fa4-4a6a-8733-cbf83e1c39a3\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              600\n            ],\n            \"parameters\": {},\n            \"id\": \"b6425482-7863-4b4d-b391-f2c97d86e45f\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              200\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body for RAG processing\"\n            },\n            \"id\": \"cfdc20af-d384-4454-82b9-b180a4ec075d\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              600\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Prepare Teams message for agent\"\n            },\n            \"id\": \"5b6c5872-937a-41dc-b2f7-d1bfe6097669\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"model\": \"gpt-4o\",\n              \"options\": {}\n            },\n            \"id\": \"84abdd8e-5c77-4f91-b702-f4aac51c8f91\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Window Buffer Memory\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {},\n            \"id\": \"9de80912-38b5-484a-a407-a86bd2d010d7\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              800,\n              100\n            ],\n            \"parameters\": {\n              \"text\": \"You are a fraud detection expert. Analyze the email content for suspicious patterns.\",\n              \"options\": {\n                \"systemMessage\": \"Classify the email as 'Fraud' or 'Safe'.\"\n              }\n            },\n            \"id\": \"10e8e1a6-0d30-4b45-9eba-b7d713c997a3\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              800,\n              300\n            ],\n            \"parameters\": {\n              \"text\": \"You are a billing support agent. Answer questions about invoices and payments.\",\n              \"options\": {\n                \"systemMessage\": \"Use the RAG tools to find billing information.\"\n              }\n            },\n            \"id\": \"afc65031-5425-4d8a-9e18-e44395e2923c\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              800,\n              500\n            ],\n            \"parameters\": {\n              \"text\": \"You are a priority support agent. Handle urgent requests immediately.\",\n              \"options\": {\n                \"systemMessage\": \"Prioritize this request above all others.\"\n              }\n            },\n            \"id\": \"9446d865-86c1-4bc5-b97e-7876a6289990\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              800\n            ],\n            \"parameters\": {\n              \"text\": \"You are the central orchestrator. Coordinate between specialized agents and tools.\",\n              \"options\": {\n                \"systemMessage\": \"Route the request to the appropriate agent or tool.\"\n              }\n            },\n            \"id\": \"5cd15849-02c3-4414-a844-21e79b198800\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Postgres Memory\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"position\": [\n              900,\n              700\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\"\n            },\n            \"id\": \"586f2696-b783-4bf9-8828-2ff40d3f41cd\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Search Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              900,\n              850\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"ee1c0c1f-fc00-48c5-9771-3ca6c6251f51\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Get Calendar Events\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              900,\n              1000\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"fd2c3f9f-b982-4c82-93a2-bd0f40e9666d\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Calendar Event\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              1100,\n              1000\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"009f73ae-9538-4115-8cc7-82eb610a8d5d\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              1100,\n              850\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"3073c33f-b828-4d3a-8e12-4808ede6d0b1\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              1300,\n              850\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"send\"\n            },\n            \"id\": \"e76d9496-4e79-4d48-9c1a-29ca47fedf31\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              900,\n              1150\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"ae4df26a-ce39-4e34-8dec-6b5b6bdd5e30\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Note: Inputs\",\n            \"type\": \"n8n-nodes-base.stickyNote\",\n            \"position\": [\n              -50,\n              150\n            ],\n            \"parameters\": {\n              \"content\": \"## Inputs\\nEmail and Teams triggers to start the workflow.\",\n              \"height\": 600,\n              \"width\": 200,\n              \"color\": 2\n            },\n            \"id\": \"91002a0e-d811-42b3-b6c2-a6604b2442d5\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Note: AI Config\",\n            \"type\": \"n8n-nodes-base.stickyNote\",\n            \"position\": [\n              450,\n              -50\n            ],\n            \"parameters\": {\n              \"content\": \"## AI Config\\nModel and Memory shared across agents.\",\n              \"height\": 300,\n              \"width\": 250,\n              \"color\": 3\n            },\n            \"id\": \"89a0d7d0-5764-4d00-9806-4e740cf1ba43\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Note: Specialized Agents\",\n            \"type\": \"n8n-nodes-base.stickyNote\",\n            \"position\": [\n              750,\n              50\n            ],\n            \"parameters\": {\n              \"content\": \"## Specialized Agents\\nDedicated agents for specific tasks (Fraud, Billing, Priority).\",\n              \"height\": 600,\n              \"width\": 250,\n              \"color\": 4\n            },\n            \"id\": \"07471ed4-5e37-4774-8a43-4a3d5e8e1fc5\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Note: Central Orchestrator\",\n            \"type\": \"n8n-nodes-base.stickyNote\",\n            \"position\": [\n              450,\n              750\n            ],\n            \"parameters\": {\n              \"content\": \"## Central Orchestrator\\nMain agent that coordinates tools and responses.\",\n              \"height\": 500,\n              \"width\": 300,\n              \"color\": 5\n            },\n            \"id\": \"b73839df-4807-47a3-97e4-593b8d52e2c2\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Note: Tools\",\n            \"type\": \"n8n-nodes-base.stickyNote\",\n            \"position\": [\n              850,\n              650\n            ],\n            \"parameters\": {\n              \"content\": \"## Tools\\nOutlook, Teams, and Database tools available to the Central Agent.\",\n              \"height\": 600,\n              \"width\": 600,\n              \"color\": 6\n            },\n            \"id\": \"967f2c1d-6337-4f08-8bbc-517d03e24615\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Postgres Memory\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Search Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Get Calendar Events\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Calendar Event\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Send Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Window Buffer Memory\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"09ed994a-9203-45b4-b0bf-08a2e237c076\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-16T19:02:20.868Z\",\n        \"updatedAt\": \"2025-06-16T19:08:22.000Z\",\n        \"id\": \"AOOCRsM4wenKrrE8\",\n        \"name\": \"Outlook AI Assistant - Core\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"webhook\",\n            \"name\": \"OpenWebUI Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"position\": [\n              300,\n              300\n            ],\n            \"parameters\": {\n              \"path\": \"outlook-ai\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"parse\",\n            \"name\": \"Parse Input\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              500,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"message\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.message || $json.body.text }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.sessionId || 'default' }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"assistant\",\n            \"name\": \"Email Assistant\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              700,\n              300\n            ],\n            \"parameters\": {\n              \"promptType\": \"define\",\n              \"text\": \"{{ $json.message }}\",\n              \"options\": {\n                \"systemMessage\": \"You are an intelligent Outlook email assistant. You can:\\n\\n**EMAIL FUNCTIONS:**\\n- Search emails by sender, subject, or content\\n- Send professional emails\\n- Create draft emails for review\\n- Get email summaries\\n\\n**CALENDAR FUNCTIONS:**\\n- Check calendar availability\\n- Schedule meetings\\n- View upcoming events\\n\\n**EXAMPLES:**\\n- 'Check emails from john@company.com'\\n- 'Send email to team about project update'\\n- 'Schedule meeting with Sarah tomorrow at 2pm'\\n- 'Show my calendar for this week'\\n- 'Create draft email about quarterly review'\\n\\nI'll help you manage your Outlook efficiently. What would you like me to do?\"\n              }\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"format\",\n            \"name\": \"Format Response\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              900,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"response\",\n                    \"type\": \"string\",\n                    \"value\": \"{{ $json.output }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"{{ $now.toISOString() }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"respond\",\n            \"name\": \"Send Response\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"position\": [\n              1100,\n              300\n            ],\n            \"parameters\": {},\n            \"typeVersion\": 1.1\n          },\n          {\n            \"id\": \"memory\",\n            \"name\": \"Memory Buffer\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              700,\n              200\n            ],\n            \"parameters\": {\n              \"sessionIdType\": \"customKey\",\n              \"sessionKey\": \"={{ $json.sessionId }}\"\n            },\n            \"typeVersion\": 1.3\n          },\n          {\n            \"id\": \"model\",\n            \"name\": \"OpenAI Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"position\": [\n              500,\n              200\n            ],\n            \"parameters\": {\n              \"model\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              }\n            },\n            \"typeVersion\": 1.2\n          },\n          {\n            \"id\": \"send-tool\",\n            \"name\": \"Send Email Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              700,\n              400\n            ],\n            \"parameters\": {\n              \"subject\": \"={{ $fromAI('subject') }}\",\n              \"bodyContent\": \"={{ $fromAI('body') }}\",\n              \"toRecipients\": \"={{ $fromAI('recipients') }}\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"search-tool\",\n            \"name\": \"Search Emails Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"getAll\",\n              \"limit\": 10,\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"search\": \"={{ $fromAI('search_query') }}\",\n                    \"sender\": \"={{ $fromAI('sender') }}\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"draft-tool\",\n            \"name\": \"Create Draft Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              900,\n              400\n            ],\n            \"parameters\": {\n              \"resource\": \"draft\",\n              \"subject\": \"={{ $fromAI('subject') }}\",\n              \"bodyContent\": \"={{ $fromAI('body') }}\",\n              \"additionalFields\": {\n                \"toRecipients\": \"={{ $fromAI('recipients') }}\"\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"calendar-tool\",\n            \"name\": \"Calendar Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              1100,\n              400\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\",\n              \"filters\": {\n                \"startDateTime\": \"={{ $fromAI('start_date') }}\",\n                \"endDateTime\": \"={{ $fromAI('end_date') }}\"\n              }\n            },\n            \"typeVersion\": 2\n          }\n        ],\n        \"connections\": {\n          \"OpenWebUI Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Parse Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Parse Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Assistant\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Assistant\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Format Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Format Response\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Memory Buffer\": {\n            \"ai_memory\": [\n              [\n                {\n                  \"node\": \"Email Assistant\",\n                  \"type\": \"ai_memory\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Model\": {\n            \"ai_languageModel\": [\n              [\n                {\n                  \"node\": \"Email Assistant\",\n                  \"type\": \"ai_languageModel\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Send Email Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Email Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Search Emails Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Email Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Create Draft Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Email Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Calendar Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Email Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"750f4e3a-6d42-44f9-8110-8f2d7f89a894\",\n        \"triggerCount\": 1,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-22T18:23:24.054Z\",\n        \"updatedAt\": \"2025-11-22T18:23:24.054Z\",\n        \"id\": \"AnukCvBWwhUDWMh7\",\n        \"name\": \"Teams-Outlook RAG Assistant (Agent Generated)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              0\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"faeeac2b-24e9-4f28-9d5d-bc7229202089\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              0\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body and metadata\\nreturn items;\"\n            },\n            \"id\": \"7f2a3260-f8a1-438f-99f7-39f0790e0ad6\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              -150\n            ],\n            \"parameters\": {\n              \"mode\": \"text\"\n            },\n            \"id\": \"cacdaa51-a838-44f5-94d3-e2ef70a26021\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"427ecd57-602d-48d0-a623-037ce0416045\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"0288f0b7-91ad-41b0-a134-2dc3796dba63\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              400\n            ],\n            \"parameters\": {},\n            \"id\": \"35ea3b70-544b-4862-aa6d-3d916cce1055\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Format teams message for AI\\nreturn items;\"\n            },\n            \"id\": \"9523a682-bcc6-4fb4-a6ff-8182fdae86ad\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"systemMessage\": \"You are a helpful Outlook & Teams assistant.\"\n              }\n            },\n            \"id\": \"b23dc7df-4011-445a-9ccd-2028f17f5ff4\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              800,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"fb91a1e0-f497-4491-8d91-8d9d109c7a61\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Postgres Memory\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"position\": [\n              400,\n              600\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\"\n            },\n            \"id\": \"f24170f3-a690-49dc-ad65-b58ea1dd8ec4\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Search Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              500,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"ceb2c27a-0dac-4e47-8d5f-2ba069ccf026\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Get Calendar Events\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              650,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"a11c0eb3-f9a0-4737-8ff2-850cd55b026d\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Calendar Event\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              800,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"7dd50bf8-9fbf-4003-974d-f2e17b7f41fa\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              950,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"60165290-86ed-4515-b295-8ba8fbc8d866\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              1100,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"send\"\n            },\n            \"id\": \"921cd05b-3ec9-404c-b80c-1e83b1b6ac0f\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAiChatModel\",\n            \"position\": [\n              200,\n              400\n            ],\n            \"parameters\": {\n              \"model\": \"gpt-4o\"\n            },\n            \"id\": \"00b6912b-e2c2-43d3-95a7-969c5eaa3d57\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Window Buffer Memory\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              200,\n              550\n            ],\n            \"parameters\": {},\n            \"id\": \"bc353f12-2bde-4cfa-b191-ba9cce16b347\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Postgres Memory\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Search Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Get Calendar Events\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Calendar Event\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Send Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Window Buffer Memory\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"b6e79246-09ad-4beb-8db3-6a0a5dc53dd6\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-15T22:54:49.604Z\",\n        \"updatedAt\": \"2025-11-24T12:22:44.538Z\",\n        \"id\": \"Baf9nylVDD1pzj9Q\",\n        \"name\": \"üéØ Ultimate AI Outlook Assistant - Proper Nodes\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"webhook_trigger\",\n            \"name\": \"üåê API Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"position\": [\n              250,\n              300\n            ],\n            \"parameters\": {\n              \"path\": \"outlook-ai-ultimate\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\"\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"manual_trigger\",\n            \"name\": \"‚ñ∂Ô∏è Manual Test\",\n            \"type\": \"n8n-nodes-base.manualTrigger\",\n            \"position\": [\n              250,\n              500\n            ],\n            \"parameters\": {},\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"smart_router\",\n            \"name\": \"üß† Smart Request Router\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              450,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"const input = items[0].json;\\nconst timestamp = new Date().toISOString();\\n\\nconst requestType = input.action || (input.message ? 'chat' : 'auto_process');\\nconst aiProvider = input.ai_provider || 'openai';\\n\\nconst routingData = {\\n  requestType,\\n  userMessage: input.message || input.query || 'Process my emails',\\n  userId: input.user_id || 'default',\\n  sessionId: input.session_id || `session_${Date.now()}`,\\n  emailConfig: {\\n    daysBack: parseInt(input.days_back) || 7,\\n    unreadOnly: input.unread_only !== false,\\n    maxEmails: parseInt(input.max_emails) || 50\\n  },\\n  aiConfig: {\\n    provider: aiProvider,\\n    model: input.model || 'gpt-4o-mini',\\n    temperature: parseFloat(input.temperature) || 0.7,\\n    maxTokens: parseInt(input.max_tokens) || 1500\\n  },\\n  metadata: {\\n    requestId: `req_${Date.now()}`,\\n    timestamp,\\n    source: input.source || 'api'\\n  }\\n};\\n\\nreturn [{ json: routingData }];\"\n            },\n            \"typeVersion\": 3\n          },\n          {\n            \"id\": \"request_dispatcher\",\n            \"name\": \"üö¶ Request Dispatcher\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"position\": [\n              650,\n              400\n            ],\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"conditions\": {\n                      \"string\": [\n                        {\n                          \"value1\": \"={{ $json.requestType }}\",\n                          \"value2\": \"chat\"\n                        }\n                      ]\n                    }\n                  },\n                  {\n                    \"conditions\": {\n                      \"string\": [\n                        {\n                          \"value1\": \"={{ $json.requestType }}\",\n                          \"value2\": \"auto_process\"\n                        }\n                      ]\n                    }\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"outlook_email_fetcher\",\n            \"name\": \"üìß Microsoft Graph Email Fetcher\",\n            \"type\": \"n8n-nodes-base.httpRequest\",\n            \"position\": [\n              850,\n              400\n            ],\n            \"parameters\": {\n              \"requestMethod\": \"GET\",\n              \"url\": \"https://graph.microsoft.com/v1.0/me/mailfolders/inbox/messages\",\n              \"qs\": {\n                \"$top\": \"={{ $json.emailConfig.maxEmails }}\",\n                \"$select\": \"id,subject,body,bodyPreview,from,to,receivedDateTime,hasAttachments,importance\"\n              },\n              \"authentication\": \"predefinedCredential\",\n              \"nodeCredentialType\": \"microsoftGraphApi\"\n            },\n            \"typeVersion\": 5\n          },\n          {\n            \"id\": \"email_intelligence\",\n            \"name\": \"üîç Email Intelligence Processor\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              1050,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"const emails = items[0].json.value || [];\\nconst processedEmails = [];\\n\\nfor (const email of emails) {\\n  const content = {\\n    id: email.id,\\n    subject: email.subject || 'No Subject',\\n    body: email.body?.content || email.bodyPreview || '',\\n    sender: email.from?.emailAddress?.address || '',\\n    senderName: email.from?.emailAddress?.name || '',\\n    receivedDateTime: email.receivedDateTime,\\n    importance: email.importance || 'normal',\\n    hasAttachments: email.hasAttachments || false\\n  };\\n  \\n  const fullText = (content.subject + ' ' + content.body).toLowerCase();\\n  \\n  let category = 'general';\\n  if (/urgent|asap|immediately/i.test(fullText)) category = 'urgent';\\n  else if (/meeting|project|deadline/i.test(fullText)) category = 'business';\\n  else if (/invoice|payment|bill/i.test(fullText)) category = 'financial';\\n  \\n  const analysis = {\\n    category,\\n    urgency: /urgent|asap|immediately/i.test(fullText) ? 'high' : 'normal',\\n    sentiment: 'neutral'\\n  };\\n  \\n  processedEmails.push({\\n    json: {\\n      ...content,\\n      analysis,\\n      processingTimestamp: new Date().toISOString()\\n    }\\n  });\\n}\\n\\nreturn processedEmails;\"\n            },\n            \"typeVersion\": 3\n          },\n          {\n            \"id\": \"ai_chat_handler\",\n            \"name\": \"ü§ñ AI Chat Handler\",\n            \"type\": \"n8n-nodes-base.httpRequest\",\n            \"position\": [\n              850,\n              200\n            ],\n            \"parameters\": {\n              \"requestMethod\": \"POST\",\n              \"url\": \"https://api.openai.com/v1/chat/completions\",\n              \"authentication\": \"predefinedCredential\",\n              \"nodeCredentialType\": \"openAiApi\",\n              \"sendHeaders\": true,\n              \"headerParameters\": {\n                \"parameters\": [\n                  {\n                    \"name\": \"Content-Type\",\n                    \"value\": \"application/json\"\n                  }\n                ]\n              },\n              \"sendBody\": true,\n              \"bodyContentType\": \"json\",\n              \"jsonBody\": \"{\\n  \\\"model\\\": \\\"{{ $json.aiConfig.model }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"system\\\",\\n      \\\"content\\\": \\\"You are an expert AI email assistant. Provide helpful responses based on user queries about their emails.\\\"\\n    },\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"{{ $json.userMessage }}\\\"\\n    }\\n  ],\\n  \\\"max_tokens\\\": {{ $json.aiConfig.maxTokens }},\\n  \\\"temperature\\\": {{ $json.aiConfig.temperature }}\\n}\"\n            },\n            \"typeVersion\": 5\n          },\n          {\n            \"id\": \"final_response\",\n            \"name\": \"üìä Final Response Formatter\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              1250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"const allResults = items;\\nconst timestamp = new Date().toISOString();\\n\\nconst response = {\\n  status: 'success',\\n  timestamp,\\n  emailsProcessed: 0,\\n  insights: [],\\n  aiResponse: '',\\n  recommendations: []\\n};\\n\\nallResults.forEach(item => {\\n  const data = item.json;\\n  \\n  if (data.analysis) {\\n    response.emailsProcessed++;\\n    response.insights.push({\\n      id: data.id,\\n      subject: data.subject,\\n      category: data.analysis.category,\\n      urgency: data.analysis.urgency\\n    });\\n  }\\n  \\n  if (data.choices && data.choices[0]) {\\n    response.aiResponse = data.choices[0].message.content;\\n  }\\n});\\n\\nif (response.emailsProcessed > 5) {\\n  response.recommendations.push('Consider setting up email filters for better organization');\\n}\\n\\nresponse.summary = `Processed ${response.emailsProcessed} emails. Found ${response.insights.filter(i => i.urgency === 'high').length} urgent items.`;\\n\\nreturn [{ json: response }];\"\n            },\n            \"typeVersion\": 3\n          }\n        ],\n        \"connections\": {\n          \"webhook_trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"smart_router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"manual_trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"smart_router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"smart_router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"request_dispatcher\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"request_dispatcher\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"ai_chat_handler\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"outlook_email_fetcher\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"outlook_email_fetcher\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"email_intelligence\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"email_intelligence\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"final_response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"ai_chat_handler\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"final_response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"d2d227e8-137c-4117-af95-80710ecf07d9\",\n        \"triggerCount\": 1,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-19T16:16:50.232Z\",\n        \"updatedAt\": \"2025-06-19T16:17:57.000Z\",\n        \"id\": \"Beusk4H0bV6gwFLg\",\n        \"name\": \"Email Processing Sub-workflow\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"parameters\": {\n              \"pollTimes\": {\n                \"item\": [\n                  {\n                    \"mode\": \"everyMinute\"\n                  }\n                ]\n              },\n              \"filters\": {},\n              \"options\": {}\n            },\n            \"id\": \"e35b28f2-d18d-45e7-b024-c20409a1f7cd\",\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"typeVersion\": 1,\n            \"position\": [\n              0,\n              0\n            ]\n          },\n          {\n            \"parameters\": {\n              \"jsCode\": \"// Email content processing and categorization\\nconst items = $input.all();\\nconst processedItems = [];\\n\\nfor (const item of items) {\\n  const email = item.json;\\n  \\n  // Extract email content\\n  const subject = email.subject || '';\\n  const body = email.body?.content || email.bodyPreview || '';\\n  const sender = email.from?.emailAddress?.address || '';\\n  const recipient = email.toRecipients?.[0]?.emailAddress?.address || '';\\n  const sentDate = email.sentDateTime;\\n  const messageId = email.id;\\n  \\n  // Simple categorization logic\\n  let category = 'general';\\n  let priority = 'normal';\\n  \\n  if (email.importance === 'high') {\\n    priority = 'high';\\n  }\\n  \\n  if (subject.toLowerCase().includes('urgent') || body.toLowerCase().includes('urgent')) {\\n    category = 'urgent';\\n    priority = 'high';\\n  } else if (subject.toLowerCase().includes('meeting') || body.toLowerCase().includes('meeting')) {\\n    category = 'meeting';\\n  } else if (subject.toLowerCase().includes('invoice') || body.toLowerCase().includes('payment')) {\\n    category = 'financial';\\n  }\\n  \\n  // Prepare content for vector storage\\n  const combinedContent = `Subject: ${subject}\\\\n\\\\nFrom: ${sender}\\\\nTo: ${recipient}\\\\n\\\\n${body}`;\\n  \\n  processedItems.push({\\n    json: {\\n      messageId,\\n      subject,\\n      body,\\n      sender,\\n      recipient,\\n      sentDate,\\n      category,\\n      priority,\\n      combinedContent,\\n      hasAttachments: email.hasAttachments || false,\\n      metadata: {\\n        threadId: email.conversationId,\\n        labels: [category],\\n        importance: email.importance,\\n        isRead: email.isRead\\n      }\\n    }\\n  });\\n}\\n\\nreturn processedItems;\"\n            },\n            \"id\": \"eac337bc-23fa-4c64-a877-2e77053b9aad\",\n            \"name\": \"Email Content Processor\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"typeVersion\": 2,\n            \"position\": [\n              200,\n              0\n            ]\n          },\n          {\n            \"parameters\": {},\n            \"id\": \"b276e853-b877-41e5-b50b-1023537f21bf\",\n            \"name\": \"Text Splitter\",\n            \"type\": \"n8n-nodes-base.textSplitter\",\n            \"typeVersion\": 1,\n            \"position\": [\n              400,\n              0\n            ]\n          },\n          {\n            \"parameters\": {},\n            \"id\": \"f6d1753e-da3b-4823-88a2-58d60e8212a2\",\n            \"name\": \"Generate Embeddings\",\n            \"type\": \"n8n-nodes-base.embeddingsOpenAi\",\n            \"typeVersion\": 1,\n            \"position\": [\n              600,\n              0\n            ]\n          },\n          {\n            \"parameters\": {},\n            \"id\": \"04f65138-3b84-4851-a290-944afef94c0b\",\n            \"name\": \"Store in Vector Database\",\n            \"type\": \"n8n-nodes-base.supabaseVectorStore\",\n            \"typeVersion\": 1,\n            \"position\": [\n              800,\n              0\n            ]\n          },\n          {\n            \"parameters\": {\n              \"schema\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"public\"\n              },\n              \"table\": \"emails\",\n              \"columns\": \"message_id,sender,recipient,subject,body,sent_date,category,priority,metadata\",\n              \"options\": {}\n            },\n            \"id\": \"338810c5-9db6-4854-a575-97e2d8d10c69\",\n            \"name\": \"Store Email Metadata\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"typeVersion\": 2.4,\n            \"position\": [\n              800,\n              200\n            ]\n          },\n          {\n            \"parameters\": {\n              \"conditions\": {\n                \"boolean\": [\n                  {\n                    \"value1\": \"={{ $json.hasAttachments }}\",\n                    \"value2\": true\n                  }\n                ]\n              },\n              \"options\": {}\n            },\n            \"id\": \"ca7d755c-ca34-47fe-99bb-b237f1f66f4e\",\n            \"name\": \"Check for Attachments\",\n            \"type\": \"n8n-nodes-base.if\",\n            \"typeVersion\": 2,\n            \"position\": [\n              200,\n              200\n            ]\n          },\n          {\n            \"parameters\": {\n              \"workflowId\": \"attachment_handler_workflow\",\n              \"options\": {}\n            },\n            \"id\": \"73aeb527-67c1-42cd-b5ac-1606d0e92cba\",\n            \"name\": \"Process Attachments\",\n            \"type\": \"n8n-nodes-base.executeWorkflow\",\n            \"typeVersion\": 1,\n            \"position\": [\n              400,\n              200\n            ]\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Content Processor\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Check for Attachments\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Content Processor\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Store Email Metadata\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Check for Attachments\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Attachments\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\"\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"df76d51b-7730-4dcf-a2b3-3a27f98b7a45\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-05T22:40:22.412Z\",\n        \"updatedAt\": \"2025-07-05T22:41:57.345Z\",\n        \"id\": \"D8tSJzVL9OPS4mVr\",\n        \"name\": \"Teams-Outlook Manager Pro\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"teams-webhook\",\n            \"name\": \"Teams Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              200,\n              300\n            ],\n            \"parameters\": {\n              \"path\": \"teams-outlook-manager\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\"\n            }\n          },\n          {\n            \"id\": \"intent-analyzer\",\n            \"name\": \"AI Intent Analyzer\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              500,\n              300\n            ],\n            \"parameters\": {\n              \"resource\": \"text\",\n              \"operation\": \"complete\",\n              \"model\": \"gpt-4o-mini\",\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"role\": \"system\",\n                    \"content\": \"Analyze user intent and respond with JSON: {\\\"intent\\\": \\\"status|respond|calendar|help\\\", \\\"action\\\": \\\"specific_action\\\"}\"\n                  },\n                  {\n                    \"role\": \"user\",\n                    \"content\": \"{{ $json.body.text || 'help' }}\"\n                  }\n                ],\n                \"values[0]\": {\n                  \"content\": \"You are a Microsoft Teams email and calendar assistant. Analyze the user's natural language input and determine their intent. Respond with JSON only:\\n\\n{\\n  \\\"intent\\\": \\\"status|respond|calendar|help\\\",\\n  \\\"action\\\": \\\"specific_action\\\",\\n  \\\"confidence\\\": 0.95,\\n  \\\"entities\\\": {\\n    \\\"recipient\\\": \\\"extracted_email_if_any\\\",\\n    \\\"subject\\\": \\\"extracted_subject_if_any\\\",\\n    \\\"message\\\": \\\"extracted_message_content\\\",\\n    \\\"timeframe\\\": \\\"today|week|month\\\"\\n  }\\n}\\n\\nINTENT MAPPING:\\n- status: \\\"check inbox\\\", \\\"any emails?\\\", \\\"what's new?\\\", \\\"email status\\\"\\n- respond: \\\"draft email\\\", \\\"compose\\\", \\\"send message\\\", \\\"write to\\\"\\n- calendar: \\\"schedule\\\", \\\"calendar\\\", \\\"meetings\\\", \\\"events\\\", \\\"what's today?\\\"\\n- help: \\\"help\\\", \\\"what can you do?\\\", \\\"commands\\\", unclear requests\\n\\nExtract entities when possible for better processing.\"\n                }\n              }\n            }\n          },\n          {\n            \"id\": \"command-router\",\n            \"name\": \"Command Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"typeVersion\": 3.2,\n            \"position\": [\n              800,\n              300\n            ],\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ JSON.parse($json.choices[0].message.content).intent }}\",\n                          \"rightValue\": \"status\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"status\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ JSON.parse($json.choices[0].message.content).intent }}\",\n                          \"rightValue\": \"respond\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"respond\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ JSON.parse($json.choices[0].message.content).intent }}\",\n                          \"rightValue\": \"calendar\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"calendar\"\n                  }\n                ]\n              },\n              \"fallbackOutput\": \"help\"\n            }\n          },\n          {\n            \"id\": \"email-checker\",\n            \"name\": \"Email Status Checker\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1200,\n              200\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\",\n              \"returnAll\": false,\n              \"limit\": 10\n            }\n          },\n          {\n            \"id\": \"help-response\",\n            \"name\": \"Help Response\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1200,\n              400\n            ],\n            \"parameters\": {\n              \"functionCode\": \"return {\\n  json: {\\n    type: \\\"message\\\",\\n    attachments: [{\\n      contentType: \\\"application/vnd.microsoft.card.adaptive\\\",\\n      content: {\\n        \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\n        \\\"type\\\": \\\"AdaptiveCard\\\",\\n        \\\"version\\\": \\\"1.3\\\",\\n        \\\"body\\\": [\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": \\\"ü§ñ Teams-Outlook Manager Pro\\\",\\n            \\\"weight\\\": \\\"Bolder\\\",\\n            \\\"size\\\": \\\"Large\\\",\\n            \\\"color\\\": \\\"Accent\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": \\\"Your AI-powered email and calendar assistant. Just chat naturally!\\\",\\n            \\\"wrap\\\": true,\\n            \\\"spacing\\\": \\\"Medium\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"FactSet\\\",\\n            \\\"facts\\\": [\\n              {\\n                \\\"title\\\": \\\"üìä Check Status:\\\",\\n                \\\"value\\\": \\\"\\\\\\\"What's in my inbox?\\\\\\\" or \\\\\\\"Any new emails?\\\\\\\"\\\"\\n              },\\n              {\\n                \\\"title\\\": \\\"üìù Draft Emails:\\\",\\n                \\\"value\\\": \\\"\\\\\\\"Draft email to John about the meeting\\\\\\\"\\\"\\n              },\\n              {\\n                \\\"title\\\": \\\"üìÖ Calendar:\\\",\\n                \\\"value\\\": \\\"\\\\\\\"What's on my calendar today?\\\\\\\"\\\"\\n              },\\n              {\\n                \\\"title\\\": \\\"‚ùì Help:\\\",\\n                \\\"value\\\": \\\"\\\\\\\"help\\\\\\\" or \\\\\\\"what can you do?\\\\\\\"\\\"\\n              }\\n            ]\\n          }\\n        ],\\n        \\\"actions\\\": [\\n          {\\n            \\\"type\\\": \\\"Action.Submit\\\",\\n            \\\"title\\\": \\\"üìä Check Inbox\\\",\\n            \\\"data\\\": { \\\"message\\\": \\\"status\\\" }\\n          },\\n          {\\n            \\\"type\\\": \\\"Action.Submit\\\",\\n            \\\"title\\\": \\\"üìÖ View Calendar\\\",\\n            \\\"data\\\": { \\\"message\\\": \\\"calendar\\\" }\\n          }\\n        ]\\n      }\\n    }]\\n  }\\n};\"\n            }\n          },\n          {\n            \"id\": \"teams-response\",\n            \"name\": \"Teams Response\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"typeVersion\": 1.4,\n            \"position\": [\n              1600,\n              300\n            ],\n            \"parameters\": {\n              \"options\": {},\n              \"respondWith\": \"json\"\n            }\n          },\n          {\n            \"id\": \"calendar-checker\",\n            \"name\": \"Calendar Checker\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1200,\n              100\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\",\n              \"returnAll\": false,\n              \"limit\": 10,\n              \"additionalFields\": {\n                \"filter\": \"start/dateTime ge '{{ $now.format('yyyy-MM-dd') }}T00:00:00.000Z'\"\n              }\n            }\n          },\n          {\n            \"id\": \"draft-composer\",\n            \"name\": \"AI Draft Composer\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              1200,\n              500\n            ],\n            \"parameters\": {\n              \"resource\": \"text\",\n              \"operation\": \"complete\",\n              \"model\": \"gpt-4o-mini\",\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"role\": \"system\",\n                    \"content\": \"Create professional email drafts. Return JSON: {\\\"subject\\\": \\\"subject\\\", \\\"body\\\": \\\"email body\\\", \\\"tone\\\": \\\"professional\\\"}\"\n                  },\n                  {\n                    \"role\": \"user\",\n                    \"content\": \"{{ $('AI Intent Analyzer').item.json.choices[0].message.content }}\"\n                  }\n                ]\n              }\n            }\n          },\n          {\n            \"id\": \"status-formatter\",\n            \"name\": \"Status Formatter\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1500,\n              200\n            ],\n            \"parameters\": {\n              \"functionCode\": \"const emails = $input.all();\\nconst unreadCount = emails.length;\\n\\nreturn {\\n  json: {\\n    type: \\\"message\\\",\\n    attachments: [{\\n      contentType: \\\"application/vnd.microsoft.card.adaptive\\\",\\n      content: {\\n        \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\n        \\\"type\\\": \\\"AdaptiveCard\\\",\\n        \\\"version\\\": \\\"1.3\\\",\\n        \\\"body\\\": [\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": `üìß Inbox Status: ${unreadCount} unread emails`,\\n            \\\"weight\\\": \\\"Bolder\\\",\\n            \\\"size\\\": \\\"Medium\\\",\\n            \\\"color\\\": unreadCount > 0 ? \\\"Attention\\\" : \\\"Good\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": unreadCount > 0 ? `You have ${unreadCount} unread emails to review.` : \\\"‚úÖ All caught up! No unread emails.\\\",\\n            \\\"wrap\\\": true\\n          }\\n        ],\\n        \\\"actions\\\": [\\n          {\\n            \\\"type\\\": \\\"Action.Submit\\\",\\n            \\\"title\\\": \\\"üîÑ Refresh\\\",\\n            \\\"data\\\": { \\\"message\\\": \\\"status\\\" }\\n          }\\n        ]\\n      }\\n    }]\\n  }\\n};\"\n            }\n          },\n          {\n            \"id\": \"calendar-formatter\",\n            \"name\": \"Calendar Formatter\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1500,\n              100\n            ],\n            \"parameters\": {\n              \"functionCode\": \"const events = $input.all();\\nconst eventCount = events.length;\\n\\nreturn {\\n  json: {\\n    type: \\\"message\\\",\\n    attachments: [{\\n      contentType: \\\"application/vnd.microsoft.card.adaptive\\\",\\n      content: {\\n        \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\n        \\\"type\\\": \\\"AdaptiveCard\\\",\\n        \\\"version\\\": \\\"1.3\\\",\\n        \\\"body\\\": [\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": `üìÖ Today's Calendar: ${eventCount} events`,\\n            \\\"weight\\\": \\\"Bolder\\\",\\n            \\\"size\\\": \\\"Medium\\\",\\n            \\\"color\\\": \\\"Accent\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": eventCount > 0 ? `You have ${eventCount} events scheduled for today.` : \\\"üÜì No events scheduled for today.\\\",\\n            \\\"wrap\\\": true\\n          }\\n        ],\\n        \\\"actions\\\": [\\n          {\\n            \\\"type\\\": \\\"Action.Submit\\\",\\n            \\\"title\\\": \\\"üîÑ Refresh\\\",\\n            \\\"data\\\": { \\\"message\\\": \\\"calendar\\\" }\\n          }\\n        ]\\n      }\\n    }]\\n  }\\n};\"\n            }\n          },\n          {\n            \"id\": \"draft-formatter\",\n            \"name\": \"Draft Formatter\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1500,\n              500\n            ],\n            \"parameters\": {\n              \"functionCode\": \"const aiResponse = JSON.parse($json.choices[0].message.content);\\n\\nreturn {\\n  json: {\\n    type: \\\"message\\\",\\n    attachments: [{\\n      contentType: \\\"application/vnd.microsoft.card.adaptive\\\",\\n      content: {\\n        \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\n        \\\"type\\\": \\\"AdaptiveCard\\\",\\n        \\\"version\\\": \\\"1.3\\\",\\n        \\\"body\\\": [\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": \\\"‚úèÔ∏è Email Draft Created\\\",\\n            \\\"weight\\\": \\\"Bolder\\\",\\n            \\\"size\\\": \\\"Medium\\\",\\n            \\\"color\\\": \\\"Good\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"FactSet\\\",\\n            \\\"facts\\\": [\\n              {\\n                \\\"title\\\": \\\"Subject:\\\",\\n                \\\"value\\\": aiResponse.subject || 'No subject'\\n              },\\n              {\\n                \\\"title\\\": \\\"Tone:\\\",\\n                \\\"value\\\": aiResponse.tone || 'Professional'\\n              }\\n            ]\\n          },\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": (aiResponse.body || 'No content').length > 200 ? (aiResponse.body || 'No content').substring(0, 200) + '...' : (aiResponse.body || 'No content'),\\n            \\\"wrap\\\": true\\n          }\\n        ],\\n        \\\"actions\\\": [\\n          {\\n            \\\"type\\\": \\\"Action.Submit\\\",\\n            \\\"title\\\": \\\"‚úèÔ∏è Edit Draft\\\",\\n            \\\"data\\\": { \\\"action\\\": \\\"edit\\\" }\\n          }\\n        ]\\n      }\\n    }]\\n  }\\n};\"\n            }\n          }\n        ],\n        \"connections\": {\n          \"Teams Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Intent Analyzer\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Intent Analyzer\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Command Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Command Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Status Checker\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Help Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ],\n            \"calendar\": [\n              [\n                {\n                  \"node\": \"Calendar Checker\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ],\n            \"respond\": [\n              [\n                {\n                  \"node\": \"AI Draft Composer\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Status Checker\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Status Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Help Response\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Calendar Checker\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Calendar Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Draft Composer\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Draft Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Status Formatter\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Calendar Formatter\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Draft Formatter\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"timezone\": \"America/New_York\"\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"6075ca9a-5cc1-42b3-92d9-364816ca02d9\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-16T19:01:30.923Z\",\n        \"updatedAt\": \"2025-06-16T19:01:30.923Z\",\n        \"id\": \"DnyizKfGh30JVeQJ\",\n        \"name\": \"Ultimate Outlook AI Assistant - Fixed\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"webui-webhook\",\n            \"name\": \"Open WebUI Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"position\": [\n              300,\n              300\n            ],\n            \"parameters\": {\n              \"path\": \"outlook-assistant\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\",\n              \"options\": {}\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"parse-input\",\n            \"name\": \"Parse User Input\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              520,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"userMessage\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.message || $json.body.text || $json.query.message }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.sessionId || $json.query.sessionId || 'session-' + $now.toUnixTimestamp() }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"userId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.userId || $json.query.userId || 'default-user' }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"email-trigger\",\n            \"name\": \"Email Processing Trigger\",\n            \"type\": \"n8n-nodes-base.manualTrigger\",\n            \"position\": [\n              300,\n              600\n            ],\n            \"parameters\": {},\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"get-emails\",\n            \"name\": \"Get New Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              520,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\",\n              \"limit\": 15,\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"custom\": \"flag/flagStatus eq 'notFlagged' and not categories/any()\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"email-loop\",\n            \"name\": \"Loop Through Emails\",\n            \"type\": \"n8n-nodes-base.splitInBatches\",\n            \"position\": [\n              740,\n              600\n            ],\n            \"parameters\": {\n              \"batchSize\": 1,\n              \"options\": {}\n            },\n            \"typeVersion\": 3\n          },\n          {\n            \"id\": \"clean-html\",\n            \"name\": \"Clean Email HTML\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n            \"position\": [\n              960,\n              600\n            ],\n            \"parameters\": {\n              \"modelId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"operation\": \"text\",\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"content\": \"Clean this email content by removing HTML tags while preserving structure and important information:\\n\\n{{ $json.body.content }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1.8\n          },\n          {\n            \"id\": \"extract-fields\",\n            \"name\": \"Extract Email Fields\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              1180,\n              600\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"emailId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get New Emails').item.json.id }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"subject\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get New Emails').item.json.subject }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"sender\",\n                    \"type\": \"object\",\n                    \"value\": \"={{ $('Get New Emails').item.json.sender.emailAddress }}\"\n                  },\n                  {\n                    \"id\": \"4\",\n                    \"name\": \"cleanBody\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Clean Email HTML').item.json.message.content }}\"\n                  },\n                  {\n                    \"id\": \"5\",\n                    \"name\": \"receivedDateTime\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get New Emails').item.json.receivedDateTime }}\"\n                  },\n                  {\n                    \"id\": \"6\",\n                    \"name\": \"hasAttachments\",\n                    \"type\": \"boolean\",\n                    \"value\": \"={{ $('Get New Emails').item.json.hasAttachments }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"classify-email\",\n            \"name\": \"Classify Email Type\",\n            \"type\": \"@n8n/n8n-nodes-langchain.textClassifier\",\n            \"position\": [\n              1400,\n              600\n            ],\n            \"parameters\": {\n              \"inputText\": \"{{ $json.cleanBody }}\",\n              \"categories\": {\n                \"categories\": [\n                  {\n                    \"category\": \"urgent_action\",\n                    \"description\": \"Critical emails requiring immediate attention: escalations, system failures, deadlines, security alerts\"\n                  },\n                  {\n                    \"category\": \"business_inquiry\",\n                    \"description\": \"Business opportunities: project inquiries, partnership requests, sales leads, proposals\"\n                  },\n                  {\n                    \"category\": \"support_request\",\n                    \"description\": \"Customer support: technical issues, troubleshooting, help requests, bug reports\"\n                  },\n                  {\n                    \"category\": \"billing_finance\",\n                    \"description\": \"Financial matters: invoices, payments, receipts, billing inquiries, accounting\"\n                  },\n                  {\n                    \"category\": \"meeting_calendar\",\n                    \"description\": \"Scheduling: meeting requests, calendar invites, appointments, availability checks\"\n                  },\n                  {\n                    \"category\": \"spam_junk\",\n                    \"description\": \"Unwanted content: spam, phishing, suspicious emails, irrelevant promotions\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"store-knowledge\",\n            \"name\": \"Store Email Knowledge\",\n            \"type\": \"@n8n/n8n-nodes-langchain.vectorStorePGVector\",\n            \"position\": [\n              1620,\n              600\n            ],\n            \"parameters\": {\n              \"mode\": \"insert\",\n              \"tableName\": \"email_knowledge\",\n              \"options\": {\n                \"metadata\": {\n                  \"metadataValues\": [\n                    {\n                      \"name\": \"email_id\",\n                      \"value\": \"={{ $json.emailId }}\"\n                    },\n                    {\n                      \"name\": \"sender_email\",\n                      \"value\": \"={{ $json.sender.address }}\"\n                    },\n                    {\n                      \"name\": \"sender_name\",\n                      \"value\": \"={{ $json.sender.name }}\"\n                    },\n                    {\n                      \"name\": \"category\",\n                      \"value\": \"={{ $('Classify Email Type').item.json.category }}\"\n                    },\n                    {\n                      \"name\": \"subject\",\n                      \"value\": \"={{ $json.subject }}\"\n                    },\n                    {\n                      \"name\": \"received_date\",\n                      \"value\": \"={{ $json.receivedDateTime }}\"\n                    }\n                  ]\n                }\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"route-category\",\n            \"name\": \"Route By Category\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"position\": [\n              1840,\n              600\n            ],\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"outputKey\": \"urgent\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('Classify Email Type').item.json.category }}\",\n                          \"rightValue\": \"urgent_action\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  },\n                  {\n                    \"outputKey\": \"business\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('Classify Email Type').item.json.category }}\",\n                          \"rightValue\": \"business_inquiry\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  },\n                  {\n                    \"outputKey\": \"spam\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('Classify Email Type').item.json.category }}\",\n                          \"rightValue\": \"spam_junk\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.2\n          },\n          {\n            \"id\": \"handle-urgent\",\n            \"name\": \"Handle Urgent Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              2060,\n              520\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"update\",\n              \"messageId\": \"={{ $json.emailId }}\",\n              \"updateFields\": {\n                \"flag\": {\n                  \"flagStatus\": \"flagged\"\n                },\n                \"categories\": [\n                  \"URGENT\"\n                ]\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"business-agent\",\n            \"name\": \"Business Response Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              2060,\n              620\n            ],\n            \"parameters\": {\n              \"promptType\": \"define\",\n              \"text\": \"Handle this business inquiry professionally:\\n\\nFrom: {{ $json.sender.name }} <{{ $json.sender.address }}>\\nSubject: {{ $json.subject }}\\nContent: {{ $json.cleanBody }}\",\n              \"options\": {\n                \"systemMessage\": \"You are a professional business development assistant. For business inquiries:\\n\\n1. Search the knowledge base for relevant company information and past projects\\n2. Create professional draft responses that highlight capabilities\\n3. Include specific value propositions and next steps\\n4. Suggest meeting scheduling when appropriate\\n\\nUse the Create Draft and Knowledge Search tools to generate informed, personalized responses.\"\n              }\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"archive-spam\",\n            \"name\": \"Archive Spam Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              2060,\n              720\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"move\",\n              \"messageId\": \"={{ $json.emailId }}\",\n              \"folderId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"junk\"\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"main-assistant\",\n            \"name\": \"Email Assistant Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              740,\n              300\n            ],\n            \"parameters\": {\n              \"promptType\": \"define\",\n              \"text\": \"{{ $json.userMessage }}\",\n              \"options\": {\n                \"systemMessage\": \"You are an intelligent email assistant accessible through Open WebUI. Your capabilities include:\\n\\n**EMAIL MANAGEMENT:**\\n- Search emails by sender, subject, content, or date range\\n- Create and send professional email responses\\n- Draft emails for review before sending\\n- Organize emails with categories and flags\\n\\n**CALENDAR FUNCTIONS:**\\n- Check calendar availability and schedule meetings\\n- Create calendar events and send invitations\\n- Find optimal meeting times for multiple participants\\n\\n**KNOWLEDGE & CONTEXT:**\\n- Search email history for past communications\\n- Access knowledge base for relevant company information\\n- Provide context from previous interactions and projects\\n\\n**COMMON COMMANDS YOU UNDERSTAND:**\\n- 'Check emails from [sender]' or 'Show emails from [company]'\\n- 'Send email to [recipient] about [topic]'\\n- 'Create draft email for [purpose]'\\n- 'Schedule meeting with [person] on [date]'\\n- 'Show urgent emails' or 'What needs immediate attention?'\\n- 'Search emails about [project/topic]'\\n- 'What meetings do I have today/this week?'\\n- 'Find all communications with [contact/company]'\\n\\n**WORKFLOW:**\\n1. Understand your request and ask for clarification if needed\\n2. Use appropriate tools to gather required information\\n3. Execute actions or provide detailed responses\\n4. Always confirm before sending emails or scheduling meetings\\n5. Provide clear next steps and follow-up actions\\n\\nI prioritize accuracy and will ask for confirmation on important actions. How can I help you manage your emails today?\"\n              }\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"send-email-tool\",\n            \"name\": \"Send Email Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              960,\n              200\n            ],\n            \"parameters\": {\n              \"subject\": \"={{ $fromAI('email_subject') }}\",\n              \"bodyContent\": \"={{ $fromAI('email_body') }}\",\n              \"toRecipients\": \"={{ $fromAI('email_recipients') }}\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"search-emails-tool\",\n            \"name\": \"Search Emails Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              960,\n              100\n            ],\n            \"parameters\": {\n              \"operation\": \"getAll\",\n              \"limit\": 10,\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"search\": \"={{ $fromAI('search_query') }}\",\n                    \"sender\": \"={{ $fromAI('sender_filter') }}\",\n                    \"receivedAfter\": \"={{ $fromAI('date_after') }}\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"create-draft-tool\",\n            \"name\": \"Create Draft Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              1180,\n              200\n            ],\n            \"parameters\": {\n              \"resource\": \"draft\",\n              \"subject\": \"={{ $fromAI('draft_subject') }}\",\n              \"bodyContent\": \"={{ $fromAI('draft_body') }}\",\n              \"additionalFields\": {\n                \"toRecipients\": \"={{ $fromAI('draft_recipients') }}\"\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"calendar-tool\",\n            \"name\": \"Calendar Events Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              1180,\n              100\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\",\n              \"filters\": {\n                \"startDateTime\": \"={{ $fromAI('start_date') }}\",\n                \"endDateTime\": \"={{ $fromAI('end_date') }}\"\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"create-meeting-tool\",\n            \"name\": \"Create Meeting Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              1400,\n              200\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\",\n              \"subject\": \"={{ $fromAI('meeting_title') }}\",\n              \"startDateTime\": \"={{ $fromAI('meeting_start') }}\",\n              \"endDateTime\": \"={{ $fromAI('meeting_end') }}\",\n              \"additionalFields\": {\n                \"body\": \"={{ $fromAI('meeting_description') }}\",\n                \"attendees\": \"={{ $fromAI('meeting_attendees') }}\"\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"knowledge-search\",\n            \"name\": \"Knowledge Search\",\n            \"type\": \"@n8n/n8n-nodes-langchain.vectorStorePGVector\",\n            \"position\": [\n              1400,\n              100\n            ],\n            \"parameters\": {\n              \"mode\": \"retrieve-as-tool\",\n              \"toolName\": \"knowledge_search\",\n              \"tableName\": \"email_knowledge\",\n              \"toolDescription\": \"Search email history and knowledge base for relevant context, past communications, and company information\"\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"openai-model\",\n            \"name\": \"OpenAI Language Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"position\": [\n              1180,\n              400\n            ],\n            \"parameters\": {\n              \"model\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"options\": {\n                \"temperature\": 0.3\n              }\n            },\n            \"typeVersion\": 1.2\n          },\n          {\n            \"id\": \"memory-system\",\n            \"name\": \"Memory System\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              960,\n              400\n            ],\n            \"parameters\": {\n              \"sessionIdType\": \"customKey\",\n              \"sessionKey\": \"={{ $json.sessionId }}\"\n            },\n            \"typeVersion\": 1.3\n          },\n          {\n            \"id\": \"openai-embeddings\",\n            \"name\": \"OpenAI Embeddings\",\n            \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n            \"position\": [\n              1620,\n              500\n            ],\n            \"parameters\": {\n              \"model\": \"text-embedding-3-small\"\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"format-response\",\n            \"name\": \"Format WebUI Response\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              960,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"response\",\n                    \"type\": \"string\",\n                    \"value\": \"{{ $json.output }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"{{ $now.toISOString() }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"{{ $('Parse User Input').item.json.sessionId }}\"\n                  },\n                  {\n                    \"id\": \"4\",\n                    \"name\": \"success\",\n                    \"type\": \"boolean\",\n                    \"value\": true\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"send-to-webui\",\n            \"name\": \"Send to Open WebUI\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"position\": [\n              1180,\n              300\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"responseHeaders\": {\n                  \"Content-Type\": \"application/json\"\n                }\n              }\n            },\n            \"typeVersion\": 1.1\n          }\n        ],\n        \"connections\": {\n          \"Open WebUI Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Parse User Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Parse User Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Assistant Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Processing Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Get New Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Get New Emails\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Loop Through Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Loop Through Emails\": {\n            \"main\": [\n              [],\n              [\n                {\n                  \"node\": \"Clean Email HTML\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Clean Email HTML\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Extract Email Fields\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Extract Email Fields\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Classify Email Type\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Classify Email Type\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Store Email Knowledge\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Store Email Knowledge\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Route By Category\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Route By Category\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Handle Urgent Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Business Response Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Archive Spam Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Assistant Agent\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Format WebUI Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Format WebUI Response\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send to Open WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Memory System\": {\n            \"ai_memory\": [\n              [\n                {\n                  \"node\": \"Email Assistant Agent\",\n                  \"type\": \"ai_memory\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Business Response Agent\",\n                  \"type\": \"ai_memory\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Language Model\": {\n            \"ai_languageModel\": [\n              [\n                {\n                  \"node\": \"Classify Email Type\",\n                  \"type\": \"ai_languageModel\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Email Assistant Agent\",\n                  \"type\": \"ai_languageModel\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Business Response Agent\",\n                  \"type\": \"ai_languageModel\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Embeddings\": {\n            \"ai_embedding\": [\n              [\n                {\n                  \"node\": \"Store Email Knowledge\",\n                  \"type\": \"ai_embedding\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Knowledge Search\",\n                  \"type\": \"ai_embedding\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Send Email Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Email Assistant Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Search Emails Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Email Assistant Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Create Draft Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Email Assistant Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Business Response Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Calendar Events Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Email Assistant Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Create Meeting Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Email Assistant Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Knowledge Search\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Email Assistant Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Business Response Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"68c00f3a-3453-47cc-acf6-711116c79319\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-06T00:56:57.598Z\",\n        \"updatedAt\": \"2025-07-06T00:56:57.598Z\",\n        \"id\": \"IZFUf12erA58Eou1\",\n        \"name\": \"Teams-Outlook Manager Pro\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"teams-webhook\",\n            \"name\": \"Teams Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              200,\n              300\n            ],\n            \"parameters\": {\n              \"path\": \"teams-outlook-manager\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\"\n            }\n          },\n          {\n            \"id\": \"intent-analyzer\",\n            \"name\": \"AI Intent Analyzer\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              500,\n              300\n            ],\n            \"parameters\": {\n              \"resource\": \"text\",\n              \"operation\": \"complete\",\n              \"model\": \"gpt-4o-mini\",\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"role\": \"system\",\n                    \"content\": \"You are a Microsoft Teams email and calendar assistant. Analyze the user's natural language input and determine their intent. Respond with JSON only:\\n\\n{\\n  \\\"intent\\\": \\\"status|respond|calendar|help\\\",\\n  \\\"action\\\": \\\"specific_action\\\",\\n  \\\"confidence\\\": 0.95,\\n  \\\"entities\\\": {\\n    \\\"recipient\\\": \\\"extracted_email_if_any\\\",\\n    \\\"subject\\\": \\\"extracted_subject_if_any\\\",\\n    \\\"message\\\": \\\"extracted_message_content\\\",\\n    \\\"timeframe\\\": \\\"today|week|month\\\"\\n  }\\n}\\n\\nINTENT MAPPING:\\n- status: \\\"check inbox\\\", \\\"any emails?\\\", \\\"what's new?\\\", \\\"email status\\\"\\n- respond: \\\"draft email\\\", \\\"compose\\\", \\\"send message\\\", \\\"write to\\\"\\n- calendar: \\\"schedule\\\", \\\"calendar\\\", \\\"meetings\\\", \\\"events\\\", \\\"what's today?\\\"\\n- help: \\\"help\\\", \\\"what can you do?\\\", \\\"commands\\\", unclear requests\\n\\nExtract entities when possible for better processing.\"\n                  },\n                  {\n                    \"role\": \"user\",\n                    \"content\": \"{{ $json.body.text || 'help' }}\"\n                  }\n                ]\n              }\n            }\n          },\n          {\n            \"id\": \"command-router\",\n            \"name\": \"Command Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"typeVersion\": 3.2,\n            \"position\": [\n              800,\n              300\n            ],\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ JSON.parse($json.choices[0].message.content).intent }}\",\n                          \"rightValue\": \"status\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"status\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ JSON.parse($json.choices[0].message.content).intent }}\",\n                          \"rightValue\": \"respond\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"respond\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ JSON.parse($json.choices[0].message.content).intent }}\",\n                          \"rightValue\": \"calendar\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"calendar\"\n                  }\n                ]\n              },\n              \"fallbackOutput\": \"help\"\n            }\n          },\n          {\n            \"id\": \"email-checker\",\n            \"name\": \"Email Status Checker\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1200,\n              200\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\",\n              \"returnAll\": false,\n              \"limit\": 10\n            }\n          },\n          {\n            \"id\": \"help-response\",\n            \"name\": \"Help Response\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1200,\n              400\n            ],\n            \"parameters\": {\n              \"functionCode\": \"return {\\n  json: {\\n    type: \\\"message\\\",\\n    attachments: [{\\n      contentType: \\\"application/vnd.microsoft.card.adaptive\\\",\\n      content: {\\n        \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\n        \\\"type\\\": \\\"AdaptiveCard\\\",\\n        \\\"version\\\": \\\"1.3\\\",\\n        \\\"body\\\": [\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": \\\"ü§ñ Teams-Outlook Manager Pro\\\",\\n            \\\"weight\\\": \\\"Bolder\\\",\\n            \\\"size\\\": \\\"Large\\\",\\n            \\\"color\\\": \\\"Accent\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": \\\"Your AI-powered email and calendar assistant. Just chat naturally!\\\",\\n            \\\"wrap\\\": true,\\n            \\\"spacing\\\": \\\"Medium\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"FactSet\\\",\\n            \\\"facts\\\": [\\n              {\\n                \\\"title\\\": \\\"üìä Check Status:\\\",\\n                \\\"value\\\": \\\"\\\\\\\"What's in my inbox?\\\\\\\" or \\\\\\\"Any new emails?\\\\\\\"\\\"\\n              },\\n              {\\n                \\\"title\\\": \\\"üìù Draft Emails:\\\",\\n                \\\"value\\\": \\\"\\\\\\\"Draft email to John about the meeting\\\\\\\"\\\"\\n              },\\n              {\\n                \\\"title\\\": \\\"üìÖ Calendar:\\\",\\n                \\\"value\\\": \\\"\\\\\\\"What's on my calendar today?\\\\\\\"\\\"\\n              },\\n              {\\n                \\\"title\\\": \\\"‚ùì Help:\\\",\\n                \\\"value\\\": \\\"\\\\\\\"help\\\\\\\" or \\\\\\\"what can you do?\\\\\\\"\\\"\\n              }\\n            ]\\n          }\\n        ],\\n        \\\"actions\\\": [\\n          {\\n            \\\"type\\\": \\\"Action.Submit\\\",\\n            \\\"title\\\": \\\"üìä Check Inbox\\\",\\n            \\\"data\\\": { \\\"message\\\": \\\"status\\\" }\\n          },\\n          {\\n            \\\"type\\\": \\\"Action.Submit\\\",\\n            \\\"title\\\": \\\"üìÖ View Calendar\\\",\\n            \\\"data\\\": { \\\"message\\\": \\\"calendar\\\" }\\n          }\\n        ]\\n      }\\n    }]\\n  }\\n};\"\n            }\n          },\n          {\n            \"id\": \"teams-response\",\n            \"name\": \"Teams Response\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"typeVersion\": 1.4,\n            \"position\": [\n              1600,\n              300\n            ],\n            \"parameters\": {\n              \"options\": {},\n              \"respondWith\": \"json\"\n            }\n          },\n          {\n            \"id\": \"calendar-checker\",\n            \"name\": \"Calendar Checker\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1200,\n              100\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\",\n              \"returnAll\": false,\n              \"limit\": 10,\n              \"additionalFields\": {\n                \"filter\": \"start/dateTime ge '{{ $now.format('yyyy-MM-dd') }}T00:00:00.000Z'\"\n              }\n            }\n          },\n          {\n            \"id\": \"draft-composer\",\n            \"name\": \"AI Draft Composer\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              1200,\n              500\n            ],\n            \"parameters\": {\n              \"resource\": \"text\",\n              \"operation\": \"complete\",\n              \"model\": \"gpt-4o-mini\",\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"role\": \"system\",\n                    \"content\": \"Create professional email drafts. Return JSON: {\\\"subject\\\": \\\"subject\\\", \\\"body\\\": \\\"email body\\\", \\\"tone\\\": \\\"professional\\\"}\"\n                  },\n                  {\n                    \"role\": \"user\",\n                    \"content\": \"{{ $('AI Intent Analyzer').item.json.choices[0].message.content }}\"\n                  }\n                ]\n              }\n            }\n          },\n          {\n            \"id\": \"status-formatter\",\n            \"name\": \"Status Formatter\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1500,\n              200\n            ],\n            \"parameters\": {\n              \"functionCode\": \"const emails = $input.all();\\nconst unreadCount = emails.length;\\n\\nreturn {\\n  json: {\\n    type: \\\"message\\\",\\n    attachments: [{\\n      contentType: \\\"application/vnd.microsoft.card.adaptive\\\",\\n      content: {\\n        \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\n        \\\"type\\\": \\\"AdaptiveCard\\\",\\n        \\\"version\\\": \\\"1.3\\\",\\n        \\\"body\\\": [\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": `üìß Inbox Status: ${unreadCount} unread emails`,\\n            \\\"weight\\\": \\\"Bolder\\\",\\n            \\\"size\\\": \\\"Medium\\\",\\n            \\\"color\\\": unreadCount > 0 ? \\\"Attention\\\" : \\\"Good\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": unreadCount > 0 ? `You have ${unreadCount} unread emails to review.` : \\\"‚úÖ All caught up! No unread emails.\\\",\\n            \\\"wrap\\\": true\\n          }\\n        ],\\n        \\\"actions\\\": [\\n          {\\n            \\\"type\\\": \\\"Action.Submit\\\",\\n            \\\"title\\\": \\\"üîÑ Refresh\\\",\\n            \\\"data\\\": { \\\"message\\\": \\\"status\\\" }\\n          }\\n        ]\\n      }\\n    }]\\n  }\\n};\"\n            }\n          },\n          {\n            \"id\": \"calendar-formatter\",\n            \"name\": \"Calendar Formatter\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1500,\n              100\n            ],\n            \"parameters\": {\n              \"functionCode\": \"const events = $input.all();\\nconst eventCount = events.length;\\n\\nreturn {\\n  json: {\\n    type: \\\"message\\\",\\n    attachments: [{\\n      contentType: \\\"application/vnd.microsoft.card.adaptive\\\",\\n      content: {\\n        \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\n        \\\"type\\\": \\\"AdaptiveCard\\\",\\n        \\\"version\\\": \\\"1.3\\\",\\n        \\\"body\\\": [\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": `üìÖ Today's Calendar: ${eventCount} events`,\\n            \\\"weight\\\": \\\"Bolder\\\",\\n            \\\"size\\\": \\\"Medium\\\",\\n            \\\"color\\\": \\\"Accent\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": eventCount > 0 ? `You have ${eventCount} events scheduled for today.` : \\\"üÜì No events scheduled for today.\\\",\\n            \\\"wrap\\\": true\\n          }\\n        ],\\n        \\\"actions\\\": [\\n          {\\n            \\\"type\\\": \\\"Action.Submit\\\",\\n            \\\"title\\\": \\\"üîÑ Refresh\\\",\\n            \\\"data\\\": { \\\"message\\\": \\\"calendar\\\" }\\n          }\\n        ]\\n      }\\n    }]\\n  }\\n};\"\n            }\n          },\n          {\n            \"id\": \"draft-formatter\",\n            \"name\": \"Draft Formatter\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1500,\n              500\n            ],\n            \"parameters\": {\n              \"functionCode\": \"const aiResponse = JSON.parse($json.choices[0].message.content);\\n\\nreturn {\\n  json: {\\n    type: \\\"message\\\",\\n    attachments: [{\\n      contentType: \\\"application/vnd.microsoft.card.adaptive\\\",\\n      content: {\\n        \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\n        \\\"type\\\": \\\"AdaptiveCard\\\",\\n        \\\"version\\\": \\\"1.3\\\",\\n        \\\"body\\\": [\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": \\\"‚úèÔ∏è Email Draft Created\\\",\\n            \\\"weight\\\": \\\"Bolder\\\",\\n            \\\"size\\\": \\\"Medium\\\",\\n            \\\"color\\\": \\\"Good\\\"\\n          },\\n          {\\n            \\\"type\\\": \\\"FactSet\\\",\\n            \\\"facts\\\": [\\n              {\\n                \\\"title\\\": \\\"Subject:\\\",\\n                \\\"value\\\": aiResponse.subject || 'No subject'\\n              },\\n              {\\n                \\\"title\\\": \\\"Tone:\\\",\\n                \\\"value\\\": aiResponse.tone || 'Professional'\\n              }\\n            ]\\n          },\\n          {\\n            \\\"type\\\": \\\"TextBlock\\\",\\n            \\\"text\\\": (aiResponse.body || 'No content').length > 200 ? (aiResponse.body || 'No content').substring(0, 200) + '...' : (aiResponse.body || 'No content'),\\n            \\\"wrap\\\": true\\n          }\\n        ],\\n        \\\"actions\\\": [\\n          {\\n            \\\"type\\\": \\\"Action.Submit\\\",\\n            \\\"title\\\": \\\"‚úèÔ∏è Edit Draft\\\",\\n            \\\"data\\\": { \\\"action\\\": \\\"edit\\\" }\\n          }\\n        ]\\n      }\\n    }]\\n  }\\n};\"\n            }\n          }\n        ],\n        \"connections\": {\n          \"Teams Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Intent Analyzer\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Intent Analyzer\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Command Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Command Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Status Checker\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Help Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ],\n            \"calendar\": [\n              [\n                {\n                  \"node\": \"Calendar Checker\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ],\n            \"respond\": [\n              [\n                {\n                  \"node\": \"AI Draft Composer\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Status Checker\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Status Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Help Response\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Calendar Checker\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Calendar Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Draft Composer\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Draft Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Status Formatter\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Calendar Formatter\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Draft Formatter\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"timezone\": \"America/New_York\"\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"7883555f-6963-4d1c-9c99-b446e3ee66e6\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-19T17:31:47.999Z\",\n        \"updatedAt\": \"2025-07-20T00:03:23.000Z\",\n        \"id\": \"L4Qe6bAT81Ns09cT\",\n        \"name\": \"Teams-Outlook Manager - Clean\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"parameters\": {\n              \"httpMethod\": \"POST\",\n              \"path\": \"teams-outlook-clean\",\n              \"responseMode\": \"responseNode\",\n              \"options\": {\n                \"rawBody\": true\n              }\n            },\n            \"name\": \"Teams Webhook\",\n            \"typeVersion\": 2,\n            \"id\": \"webhook-1\",\n            \"position\": [\n              100,\n              300\n            ],\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"webhookId\": \"f3e6afe8-4903-4027-9bf6-47086eb256ba\"\n          },\n          {\n            \"parameters\": {\n              \"respondWith\": \"text\",\n              \"responseBody\": \"Success\",\n              \"options\": {}\n            },\n            \"name\": \"Webhook Response\",\n            \"typeVersion\": 1,\n            \"id\": \"response-1\",\n            \"position\": [\n              100,\n              560\n            ],\n            \"type\": \"n8n-nodes-base.respondToWebhook\"\n          },\n          {\n            \"parameters\": {\n              \"functionCode\": \"// Process Teams message input\\nconst body = $json.body || {};\\nconst text = body.text || '';\\nconst user = body.from?.name || 'User';\\n\\nreturn {\\n  json: {\\n    message: text.replace(/<[^>]*>/g, '').trim(),\\n    user: user,\\n    timestamp: new Date().toISOString()\\n  }\\n};\"\n            },\n            \"id\": \"input-processor\",\n            \"name\": \"Process Input\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              340,\n              120\n            ]\n          },\n          {\n            \"parameters\": {\n              \"model\": \"gpt-4o-mini\",\n              \"options\": {\n                \"maxTokens\": 1000,\n                \"temperature\": 0.7\n              }\n            },\n            \"id\": \"openai-model\",\n            \"name\": \"OpenAI Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"typeVersion\": 1.2,\n            \"position\": [\n              500,\n              200\n            ],\n            \"credentials\": {\n              \"openAiApi\": {\n                \"name\": \"OpenAI API\",\n                \"id\": \"openai-credentials\"\n              }\n            }\n          },\n          {\n            \"parameters\": {\n              \"promptType\": \"define\",\n              \"text\": \"={{ $json.message }}\",\n              \"options\": {\n                \"systemMessage\": \"You are a Teams-Outlook Manager assistant. You can help users with:\\n- Searching emails\\n- Sending emails\\n- Creating draft emails\\n- Managing calendar events\\n- Getting calendar information\\n\\nUse the available tools to help users with their Outlook tasks.\"\n              }\n            },\n            \"id\": \"ai-agent\",\n            \"name\": \"AI Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"typeVersion\": 1.7,\n            \"position\": [\n              700,\n              300\n            ]\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"getAll\",\n              \"limit\": 10,\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {}\n                }\n              },\n              \"options\": {}\n            },\n            \"id\": \"search-emails\",\n            \"name\": \"Search Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1020,\n              20\n            ],\n            \"webhookId\": \"388bf7df-50c1-475e-92b9-9425364f5156\",\n            \"credentials\": {\n              \"microsoftOutlookOAuth2Api\": {\n                \"name\": \"Microsoft Outlook OAuth2\",\n                \"id\": \"microsoft-outlook-credentials\"\n              }\n            }\n          },\n          {\n            \"parameters\": {\n              \"toRecipients\": \"={{ $fromAI('recipients', '', 'string') }}\",\n              \"subject\": \"={{ $fromAI('subject', '', 'string') }}\",\n              \"bodyContent\": \"={{ $fromAI('body', '', 'string') }}\",\n              \"additionalFields\": {}\n            },\n            \"id\": \"send-email\",\n            \"name\": \"Send Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1220,\n              140\n            ],\n            \"webhookId\": \"18f7f2c2-852a-415b-8ae4-a327c8a97adf\",\n            \"credentials\": {\n              \"microsoftOutlookOAuth2Api\": {\n                \"name\": \"Microsoft Outlook OAuth2\",\n                \"id\": \"microsoft-outlook-credentials\"\n              }\n            }\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"draft\",\n              \"subject\": \"={{ $fromAI('subject', '', 'string') }}\",\n              \"bodyContent\": \"={{ $fromAI('body', '', 'string') }}\",\n              \"additionalFields\": {\n                \"bodyContentType\": \"html\",\n                \"toRecipients\": \"={{ $fromAI('recipients', '', 'string') }}\"\n              }\n            },\n            \"id\": \"create-draft\",\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1220,\n              320\n            ],\n            \"webhookId\": \"3276aba2-39db-477c-82dc-50be73826c5e\",\n            \"credentials\": {\n              \"microsoftOutlookOAuth2Api\": {\n                \"name\": \"Microsoft Outlook OAuth2\",\n                \"id\": \"microsoft-outlook-credentials\"\n              }\n            }\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"limit\": 10,\n              \"filters\": {}\n            },\n            \"id\": \"get-calendar\",\n            \"name\": \"Get Calendar Events\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1200,\n              580\n            ],\n            \"webhookId\": \"f1a5de27-298b-442d-8ecb-7c62d6968acf\",\n            \"credentials\": {\n              \"microsoftOutlookOAuth2Api\": {\n                \"name\": \"Microsoft Outlook OAuth2\",\n                \"id\": \"microsoft-outlook-credentials\"\n              }\n            }\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\",\n              \"calendarId\": \"primary\",\n              \"subject\": \"={{ $fromAI('subject', '', 'string') }}\",\n              \"startDateTime\": \"={{ $fromAI('start_time', '', 'string') }}\",\n              \"endDateTime\": \"={{ $fromAI('end_time', '', 'string') }}\",\n              \"additionalFields\": {}\n            },\n            \"id\": \"create-event\",\n            \"name\": \"Create Calendar Event\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              940,\n              600\n            ],\n            \"webhookId\": \"f12f5471-11d9-4461-923c-f70d9d235f4f\",\n            \"credentials\": {\n              \"microsoftOutlookOAuth2Api\": {\n                \"name\": \"Microsoft Outlook OAuth2\",\n                \"id\": \"microsoft-outlook-credentials\"\n              }\n            }\n          }\n        ],\n        \"connections\": {\n          \"Teams Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"type\": \"main\",\n                  \"node\": \"Webhook Response\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Process Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Webhook Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Model\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"model\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Search Emails\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"tools\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Send Email\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"tools\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Create Draft\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"tools\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Get Calendar Events\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"tools\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Create Calendar Event\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"tools\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"ffc5f6e7-59a8-4b61-9a37-d2822d00ba6f\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-17T11:04:45.307Z\",\n        \"updatedAt\": \"2025-06-17T11:04:45.307Z\",\n        \"id\": \"LfuvupekzzGN8ya4\",\n        \"name\": \"My workflow\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"parameters\": {},\n            \"id\": \"b269600b-684f-49a1-bb6b-d421dc9ff561\",\n            \"name\": \"Initial Setup Trigger\",\n            \"type\": \"n8n-nodes-base.manualTrigger\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -240,\n              240\n            ]\n          },\n          {\n            \"parameters\": {},\n            \"id\": \"29bc71a6-c225-4dba-a126-2fe6ef4ff2e6\",\n            \"name\": \"Incremental Sync Schedule\",\n            \"type\": \"n8n-nodes-base.cron\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -240,\n              440\n            ]\n          },\n          {\n            \"parameters\": {\n              \"httpMethod\": \"POST\",\n              \"path\": \"outlook-ai-webhook\",\n              \"responseMode\": \"responseNode\",\n              \"options\": {}\n            },\n            \"id\": \"3535286b-c1b2-44d5-8460-0eedb506f412\",\n            \"name\": \"Open WebUI Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -240,\n              640\n            ],\n            \"webhookId\": \"outlook-ai-assistant\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"getAll\",\n              \"options\": {}\n            },\n            \"id\": \"07002a6f-3b57-4a27-90e1-775ebe575bde\",\n            \"name\": \"Batch Email Fetcher\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              160,\n              240\n            ],\n            \"webhookId\": \"6010e1e5-4de3-41fd-a7e6-d61d0e5d8f86\",\n            \"continueOnFail\": true\n          },\n          {\n            \"parameters\": {},\n            \"id\": \"dec10030-a1ca-44b9-b6ba-ac6904987c7e\",\n            \"name\": \"Email Parser\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"typeVersion\": 1,\n            \"position\": [\n              360,\n              240\n            ]\n          },\n          {\n            \"parameters\": {\n              \"method\": \"POST\",\n              \"url\": \"={{ $credentials.baseUrl }}/api/generate\",\n              \"authentication\": \"predefinedCredentialType\",\n              \"nodeCredentialType\": \"ollamaApi\",\n              \"sendBody\": true,\n              \"specifyBody\": \"json\",\n              \"jsonBody\": \"={\\n  \\\"model\\\": \\\"llama3.2:3b\\\",\\n  \\\"prompt\\\": \\\"Categorize this email into one of these categories: Business, Personal, Newsletter, Spam, Important, Project, Meeting, Invoice, Support, Marketing.\\\\n\\\\nEmail subject: {{ $json.subject }}\\\\nPreview: {{ $json.bodyPreview }}\\\\n\\\\nRespond with only the category name.\\\",\\n  \\\"stream\\\": false,\\n  \\\"options\\\": {\\n    \\\"temperature\\\": 0.1\\n  }\\n}\",\n              \"options\": {\n                \"response\": {\n                  \"response\": {\n                    \"responseFormat\": \"json\"\n                  }\n                }\n              }\n            },\n            \"id\": \"da5ee5ff-a0c7-4566-b6cb-43f675542985\",\n            \"name\": \"Category Classifier\",\n            \"type\": \"n8n-nodes-base.httpRequest\",\n            \"typeVersion\": 3,\n            \"position\": [\n              560,\n              240\n            ]\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"upsert\"\n            },\n            \"id\": \"9546bcdf-1fd9-4cd0-93a8-539d7d7b97f9\",\n            \"name\": \"Supabase Email Storage\",\n            \"type\": \"n8n-nodes-base.supabase\",\n            \"typeVersion\": 1,\n            \"position\": [\n              760,\n              240\n            ],\n            \"continueOnFail\": true\n          },\n          {\n            \"parameters\": {\n              \"conditions\": {\n                \"boolean\": [\n                  {\n                    \"value1\": \"={{ $json.hasAttachments }}\",\n                    \"value2\": true\n                  }\n                ]\n              }\n            },\n            \"id\": \"ad825de7-023c-40df-8e31-d48626aeed33\",\n            \"name\": \"Has Attachments?\",\n            \"type\": \"n8n-nodes-base.if\",\n            \"typeVersion\": 1,\n            \"position\": [\n              560,\n              440\n            ]\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"messageAttachment\",\n              \"operation\": \"download\",\n              \"messageId\": \"={{ $json.id }}\",\n              \"attachmentId\": \"={{ $json.attachments[0].id }}\"\n            },\n            \"id\": \"4721667e-e980-4411-b06f-c3c03a153469\",\n            \"name\": \"Download Attachments\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              760,\n              540\n            ],\n            \"webhookId\": \"857fb50c-f043-48ea-815b-b103dc39588c\"\n          },\n          {\n            \"parameters\": {\n              \"dataType\": \"string\",\n              \"value1\": \"={{ $json.fileName.split('.').pop().toLowerCase() }}\",\n              \"rules\": {\n                \"rules\": [\n                  {\n                    \"value2\": \"pdf\"\n                  },\n                  {\n                    \"value2\": \"jpg\",\n                    \"output\": 1\n                  },\n                  {\n                    \"value2\": \"jpeg\",\n                    \"output\": 1\n                  },\n                  {\n                    \"value2\": \"png\",\n                    \"output\": 1\n                  },\n                  {\n                    \"value2\": \"doc\",\n                    \"output\": 2\n                  },\n                  {\n                    \"value2\": \"docx\",\n                    \"output\": 2\n                  },\n                  {\n                    \"value2\": \"xls\",\n                    \"output\": 3\n                  },\n                  {\n                    \"value2\": \"xlsx\",\n                    \"output\": 3\n                  },\n                  {\n                    \"value2\": \"csv\",\n                    \"output\": 3\n                  }\n                ]\n              },\n              \"fallbackOutput\": 4\n            },\n            \"id\": \"ccc61aed-125f-473e-8d17-cf6c6e929305\",\n            \"name\": \"File Type Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"typeVersion\": 1,\n            \"position\": [\n              960,\n              540\n            ]\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"pdf\",\n              \"options\": {}\n            },\n            \"id\": \"010788f5-1252-46c2-a80b-7ed3ec07a72b\",\n            \"name\": \"PDF Text Extractor\",\n            \"type\": \"n8n-nodes-base.extractFromFile\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1160,\n              440\n            ],\n            \"continueOnFail\": true\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"executeQuery\",\n              \"query\": \"INSERT INTO documents_pg (email_id, file_name, content_type, extracted_text) VALUES ($1, $2, $3, $4)\",\n              \"options\": {}\n            },\n            \"id\": \"00278250-992e-4582-b746-56bed63cf45f\",\n            \"name\": \"Store Document Data\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1360,\n              540\n            ]\n          },\n          {\n            \"parameters\": {\n              \"method\": \"POST\",\n              \"url\": \"={{ $credentials.baseUrl }}/api/embeddings\",\n              \"authentication\": \"predefinedCredentialType\",\n              \"nodeCredentialType\": \"ollamaApi\",\n              \"sendBody\": true,\n              \"specifyBody\": \"json\",\n              \"jsonBody\": \"={\\n  \\\"model\\\": \\\"nomic-embed-text\\\",\\n  \\\"prompt\\\": \\\"{{ $json.query }}\\\"\\n}\",\n              \"options\": {\n                \"response\": {\n                  \"response\": {\n                    \"responseFormat\": \"json\"\n                  }\n                }\n              }\n            },\n            \"id\": \"96bc6106-97a8-41f6-916f-e62c1fb2523d\",\n            \"name\": \"Generate Query Embedding\",\n            \"type\": \"n8n-nodes-base.httpRequest\",\n            \"typeVersion\": 3,\n            \"position\": [\n              160,\n              840\n            ]\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"executeQuery\",\n              \"query\": \"SELECT email_id, subject, body_preview, extracted_text \\nFROM emails e\\nLEFT JOIN documents_pg d ON e.email_id = d.email_id\\nORDER BY sent_date DESC\\nLIMIT 10\",\n              \"options\": {}\n            },\n            \"id\": \"9e0874fc-a66b-4d5d-b7a1-f1b0fb75b5f9\",\n            \"name\": \"RAG Context Retriever\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"typeVersion\": 2,\n            \"position\": [\n              360,\n              840\n            ]\n          },\n          {\n            \"parameters\": {\n              \"method\": \"POST\",\n              \"url\": \"={{ $credentials.baseUrl }}/api/generate\",\n              \"authentication\": \"predefinedCredentialType\",\n              \"nodeCredentialType\": \"ollamaApi\",\n              \"sendBody\": true,\n              \"specifyBody\": \"json\",\n              \"jsonBody\": \"={\\n  \\\"model\\\": \\\"{{ $json.selectedModel || 'llama3.2:3b' }}\\\",\\n  \\\"prompt\\\": \\\"You are an AI assistant with access to the user's email history. Based on the following context from their emails, answer their query.\\\\n\\\\nContext:\\\\n{{ $json.context }}\\\\n\\\\nUser Query: {{ $json.query }}\\\\n\\\\nResponse:\\\",\\n  \\\"stream\\\": false,\\n  \\\"options\\\": {\\n    \\\"temperature\\\": 0.7\\n  }\\n}\",\n              \"options\": {\n                \"response\": {\n                  \"response\": {\n                    \"responseFormat\": \"json\"\n                  }\n                }\n              }\n            },\n            \"id\": \"10b6385e-acf6-4d87-99ba-4fc996a7351f\",\n            \"name\": \"LLM Response Generator\",\n            \"type\": \"n8n-nodes-base.httpRequest\",\n            \"typeVersion\": 3,\n            \"position\": [\n              560,\n              840\n            ]\n          },\n          {\n            \"parameters\": {\n              \"conditions\": {\n                \"string\": [\n                  {\n                    \"value1\": \"={{ $json.intent }}\",\n                    \"operation\": \"contains\",\n                    \"value2\": \"draft\"\n                  }\n                ]\n              }\n            },\n            \"id\": \"55dea971-37b3-40c1-942f-37259c5f6059\",\n            \"name\": \"Is Draft Request?\",\n            \"type\": \"n8n-nodes-base.if\",\n            \"typeVersion\": 1,\n            \"position\": [\n              760,\n              840\n            ]\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"insert\"\n            },\n            \"id\": \"4b6af191-daf5-4eb7-ad0e-188939d420a5\",\n            \"name\": \"Queue Draft for Approval\",\n            \"type\": \"n8n-nodes-base.supabase\",\n            \"typeVersion\": 1,\n            \"position\": [\n              960,\n              940\n            ]\n          },\n          {\n            \"parameters\": {\n              \"options\": {}\n            },\n            \"id\": \"543d3d5b-3d20-40de-8b4a-20190e21187b\",\n            \"name\": \"Send Response to WebUI\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1160,\n              840\n            ]\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"executeQuery\",\n              \"query\": \"CREATE EXTENSION IF NOT EXISTS vector;\\n\\nCREATE TABLE IF NOT EXISTS emails (\\n  email_id VARCHAR(255) PRIMARY KEY,\\n  subject TEXT,\\n  sender VARCHAR(255),\\n  sent_date TIMESTAMP,\\n  body_preview TEXT,\\n  category VARCHAR(50),\\n  has_attachments BOOLEAN,\\n  folder_id VARCHAR(255),\\n  created_at TIMESTAMP DEFAULT NOW()\\n);\\n\\nCREATE TABLE IF NOT EXISTS documents_pg (\\n  id SERIAL PRIMARY KEY,\\n  email_id VARCHAR(255) REFERENCES emails(email_id),\\n  file_name VARCHAR(255),\\n  content_type VARCHAR(50),\\n  extracted_text TEXT,\\n  vector_embedding vector(384),\\n  created_at TIMESTAMP DEFAULT NOW()\\n);\\n\\nCREATE TABLE IF NOT EXISTS draft_queue (\\n  draft_id VARCHAR(255) PRIMARY KEY,\\n  recipient VARCHAR(255),\\n  subject TEXT,\\n  body TEXT,\\n  status VARCHAR(50),\\n  user_feedback TEXT,\\n  created_at TIMESTAMP,\\n  reviewed_at TIMESTAMP\\n);\\n\\nCREATE TABLE IF NOT EXISTS learning_data (\\n  id SERIAL PRIMARY KEY,\\n  draft_id VARCHAR(255),\\n  approved BOOLEAN,\\n  original_draft TEXT,\\n  final_version TEXT,\\n  feedback TEXT,\\n  created_at TIMESTAMP DEFAULT NOW()\\n);\",\n              \"options\": {}\n            },\n            \"id\": \"1ade9e52-db69-4eb0-9e7e-c676733d2868\",\n            \"name\": \"Database Schema Setup\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -40,\n              40\n            ]\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"folder\",\n              \"operation\": \"getAll\",\n              \"returnAll\": true,\n              \"filters\": {},\n              \"options\": {}\n            },\n            \"id\": \"469e2b03-61fd-428d-93a9-81ecf84cb9c4\",\n            \"name\": \"Get All Folders\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -40,\n              240\n            ],\n            \"webhookId\": \"b73786ce-ffc9-418a-8162-1b51396690c0\"\n          },\n          {\n            \"parameters\": {\n              \"batchSize\": 1,\n              \"options\": {}\n            },\n            \"id\": \"21d309eb-71f6-4b87-b6ba-cee28bec4688\",\n            \"name\": \"Process Each Folder\",\n            \"type\": \"n8n-nodes-base.splitInBatches\",\n            \"typeVersion\": 1,\n            \"position\": [\n              360,\n              340\n            ]\n          }\n        ],\n        \"connections\": {\n          \"Initial Setup Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Get All Folders\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Incremental Sync Schedule\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Get All Folders\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Open WebUI Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Generate Query Embedding\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Get All Folders\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Each Folder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Each Folder\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Batch Email Fetcher\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Batch Email Fetcher\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Parser\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Parser\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Category Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Category Classifier\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Supabase Email Storage\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Has Attachments?\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Supabase Email Storage\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Each Folder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Has Attachments?\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Download Attachments\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Process Each Folder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Download Attachments\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"File Type Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"File Type Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"PDF Text Extractor\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Store Document Data\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Store Document Data\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Store Document Data\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"PDF Text Extractor\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Store Document Data\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Store Document Data\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Each Folder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Generate Query Embedding\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"RAG Context Retriever\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"RAG Context Retriever\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"LLM Response Generator\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"LLM Response Generator\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Is Draft Request?\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Is Draft Request?\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Queue Draft for Approval\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Send Response to WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Queue Draft for Approval\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Response to WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\"\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"2c0f24f3-8c34-441a-831b-9cafe5926fe1\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-24T11:14:33.146Z\",\n        \"updatedAt\": \"2025-11-24T12:25:07.000Z\",\n        \"id\": \"LpAFvk5XmT91CXEo\",\n        \"name\": \"Complex Multi-Node Test\",\n        \"active\": false,\n        \"isArchived\": true,\n        \"nodes\": [\n          {\n            \"id\": \"webhook_0\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"name\": \"Webhook\",\n            \"parameters\": {\n              \"path\": \"webhook-data\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\"\n            },\n            \"position\": [\n              240,\n              300\n            ],\n            \"webhookId\": \"exiku3ivb\",\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"d6tc0163h\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"name\": \"Process Data 2\",\n            \"parameters\": {\n              \"functionCode\": \"\\n            // Process the incoming data\\n            const processedData = {\\n              timestamp: new Date().toISOString(),\\n              originalData: $input.all(),\\n              processed: true\\n            };\\n            \\n            return [processedData];\\n          \"\n            },\n            \"position\": [\n              540,\n              300\n            ],\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Data 2\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"97d04f28-4030-40e4-88d0-b9c86cd926ad\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-16T20:26:40.137Z\",\n        \"updatedAt\": \"2025-06-16T20:35:44.897Z\",\n        \"id\": \"NsvsXTp51HoMw5rK\",\n        \"name\": \"Ultimate Outlook Enterprise Agent\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"parameters\": {\n              \"httpMethod\": \"POST\",\n              \"path\": \"ultimate-outlook-enterprise\",\n              \"responseMode\": \"responseNode\",\n              \"options\": {\n                \"rawBody\": true\n              }\n            },\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -400,\n              300\n            ],\n            \"id\": \"openwebui-webhook\",\n            \"name\": \"OpenWebUI Interface\",\n            \"webhookId\": \"ultimate-outlook-enterprise-001\"\n          },\n          {\n            \"parameters\": {\n              \"pollTimes\": {\n                \"item\": [\n                  {\n                    \"mode\": \"everyMinute\"\n                  }\n                ]\n              },\n              \"output\": \"raw\",\n              \"filters\": {\n                \"foldersToExclude\": [\n                  \"Deleted Items\",\n                  \"Junk Email\"\n                ],\n                \"custom\": \"flag/flagStatus eq 'notFlagged' and not categories/any()\"\n              },\n              \"options\": {\n                \"fields\": [\n                  \"sender\",\n                  \"subject\",\n                  \"body\",\n                  \"importance\",\n                  \"categories\",\n                  \"flag\",\n                  \"receivedDateTime\",\n                  \"conversationId\",\n                  \"internetMessageHeaders\",\n                  \"isRead\",\n                  \"hasAttachments\"\n                ]\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -400,\n              600\n            ],\n            \"id\": \"outlook-monitor\",\n            \"name\": \"Outlook Real-time Monitor\"\n          },\n          {\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"message-text\",\n                    \"name\": \"message\",\n                    \"value\": \"={{ $json.body?.message || $json.body?.text || $json.message }}\",\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"id\": \"session-id\",\n                    \"name\": \"sessionId\",\n                    \"value\": \"={{ $json.body?.sessionId || $json.sessionId || 'default-session' }}\",\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"id\": \"user-context\",\n                    \"name\": \"userContext\",\n                    \"value\": \"={{ $json.body?.user || {} }}\",\n                    \"type\": \"object\"\n                  },\n                  {\n                    \"id\": \"timestamp\",\n                    \"name\": \"timestamp\",\n                    \"value\": \"={{ $now.toISOString() }}\",\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"id\": \"processing-start\",\n                    \"name\": \"processingStart\",\n                    \"value\": \"={{ $now.toMillis() }}\",\n                    \"type\": \"number\"\n                  }\n                ]\n              },\n              \"options\": {}\n            },\n            \"type\": \"n8n-nodes-base.set\",\n            \"typeVersion\": 3.4,\n            \"position\": [\n              -200,\n              300\n            ],\n            \"id\": \"parse-openwebui-input\",\n            \"name\": \"Parse OpenWebUI Input\"\n          },\n          {\n            \"parameters\": {\n              \"modelId\": {\n                \"__rl\": true,\n                \"value\": \"gpt-4\",\n                \"mode\": \"list\"\n              },\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"content\": \"=Email Content: {{ $json.body?.content || $json.body }}\\n\\nSender: {{ $json.sender?.emailAddress?.name }} ({{ $json.sender?.emailAddress?.address }})\\n\\nSubject: {{ $json.subject }}\\n\\nImportance: {{ $json.importance }}\\n\\nReceived: {{ $json.receivedDateTime }}\\n\\nHas Attachments: {{ $json.hasAttachments }}\"\n                  },\n                  {\n                    \"content\": \"You are an advanced email intelligence processor. Analyze and extract comprehensive information:\\n\\n1. Clean email content and remove HTML formatting\\n2. Extract key information, intent, and business context\\n3. Identify urgency levels and priority indicators\\n4. Detect security threats, phishing, and suspicious content\\n5. Extract actionable items with deadlines\\n6. Analyze sentiment and communication tone\\n7. Categorize email type and business relevance\\n8. Generate intelligent summary and recommendations\\n\\nReturn a detailed JSON object:\\n{\\n  \\\"cleanContent\\\": \\\"cleaned and formatted email text\\\",\\n  \\\"intent\\\": \\\"primary purpose and intent of email\\\",\\n  \\\"urgency\\\": \\\"low/medium/high/critical\\\",\\n  \\\"priority\\\": \\\"routine/important/urgent/critical\\\",\\n  \\\"actionItems\\\": [\\\"specific action items with deadlines\\\"],\\n  \\\"summary\\\": \\\"intelligent 2-3 sentence summary\\\",\\n  \\\"securityFlags\\\": [\\\"security concerns detected\\\"],\\n  \\\"sentiment\\\": \\\"positive/neutral/negative/mixed\\\",\\n  \\\"category\\\": \\\"business/personal/marketing/support/legal/financial\\\",\\n  \\\"businessRelevance\\\": \\\"high/medium/low\\\",\\n  \\\"suggestedResponse\\\": \\\"recommended response approach\\\",\\n  \\\"keyEntities\\\": [\\\"people, companies, dates, amounts\\\"],\\n  \\\"followUpRequired\\\": true/false,\\n  \\\"estimatedResponseTime\\\": \\\"immediate/1hour/1day/1week\\\"\\n}\",\n                    \"role\": \"system\"\n                  }\n                ]\n              },\n              \"options\": {\n                \"temperature\": 0.1\n              }\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n            \"typeVersion\": 1.8,\n            \"position\": [\n              0,\n              600\n            ],\n            \"id\": \"email-intelligence-processor\",\n            \"name\": \"Email Intelligence Processor\"\n          },\n          {\n            \"parameters\": {\n              \"inputText\": \"={{ $json.message?.content || $json.cleanContent }}\",\n              \"categories\": {\n                \"categories\": [\n                  {\n                    \"category\": \"Critical Emergency\",\n                    \"description\": \"Immediate action required within 15 minutes. System outages, security breaches, legal emergencies, CEO/executive urgent communications, production failures, safety incidents.\\n\\nKeywords: EMERGENCY, CRITICAL, SYSTEM DOWN, SECURITY BREACH, URGENT CEO, LEGAL EMERGENCY, PRODUCTION FAILURE, SAFETY INCIDENT, IMMEDIATE ACTION, CODE RED\"\n                  },\n                  {\n                    \"category\": \"High Priority Business\",\n                    \"description\": \"Important business matters requiring response within 2-4 hours. Major client issues, project deadlines, important meetings, business opportunities, partnership negotiations.\\n\\nKeywords: Important Client, Project Deadline, Major Opportunity, Partnership, Important Meeting, Business Critical, Time Sensitive, Response Required\"\n                  },\n                  {\n                    \"category\": \"Standard Business\",\n                    \"description\": \"Regular business communications, updates, reports, team communications, documentation, routine inquiries.\\n\\nKeywords: Team Update, Project Status, Report, Documentation, Routine Inquiry, Standard Business, Weekly Update, Progress Report\"\n                  },\n                  {\n                    \"category\": \"Customer Support\",\n                    \"description\": \"Customer service inquiries, support tickets, user issues, feature requests, bug reports, account problems.\\n\\nKeywords: Support Request, Customer Issue, Bug Report, Account Problem, Help Needed, Technical Issue, User Inquiry, Service Request\"\n                  },\n                  {\n                    \"category\": \"Financial & Billing\",\n                    \"description\": \"Financial communications, invoices, payment notices, billing inquiries, accounting matters, expense reports.\\n\\nKeywords: Invoice, Payment, Billing, Financial Report, Expense, Accounting, Revenue, Budget, Financial Statement, Payment Due\"\n                  },\n                  {\n                    \"category\": \"Marketing & Promotion\",\n                    \"description\": \"Marketing campaigns, promotional emails, newsletters, product announcements, sales communications, advertising.\\n\\nKeywords: Newsletter, Promotion, Sale, Marketing Campaign, Product Launch, Advertisement, Special Offer, Discount, Announcement\"\n                  },\n                  {\n                    \"category\": \"Automated & System\",\n                    \"description\": \"Automated notifications, system alerts, monitoring reports, backup notifications, scheduled reports.\\n\\nKeywords: Automated, System Alert, Monitoring, Backup Complete, Scheduled Report, Notification, System Update, Maintenance\"\n                  },\n                  {\n                    \"category\": \"Spam & Junk\",\n                    \"description\": \"Spam emails, phishing attempts, suspicious communications, unwanted solicitations, scam attempts.\\n\\nKeywords: Suspicious Link, Phishing, Scam, Unwanted, Spam, Suspicious Sender, Too Good To Be True, Free Money, Lottery\"\n                  }\n                ]\n              },\n              \"options\": {\n                \"model\": \"gpt-4\"\n              }\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.textClassifier\",\n            \"typeVersion\": 1,\n            \"position\": [\n              200,\n              600\n            ],\n            \"id\": \"email-classifier\",\n            \"name\": \"AI Email Classifier\"\n          },\n          {\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": false,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\",\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $('AI Email Classifier').isExecuted ? $('AI Email Classifier').item.json.classification : 'unknown' }}\",\n                          \"rightValue\": \"Critical Emergency\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"or\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"CriticalEmergency\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": false,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\",\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $('AI Email Classifier').isExecuted ? $('AI Email Classifier').item.json.classification : 'unknown' }}\",\n                          \"rightValue\": \"High Priority Business\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"or\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"HighPriority\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": false,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\",\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $('AI Email Classifier').isExecuted ? $('AI Email Classifier').item.json.classification : 'unknown' }}\",\n                          \"rightValue\": \"Spam & Junk\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"or\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"SpamJunk\"\n                  }\n                ]\n              },\n              \"options\": {\n                \"fallbackOutput\": \"ProcessNormally\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.switch\",\n            \"typeVersion\": 3.2,\n            \"position\": [\n              400,\n              600\n            ],\n            \"id\": \"priority-router\",\n            \"name\": \"Email Priority Router\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"move\",\n              \"messageId\": {\n                \"__rl\": true,\n                \"value\": \"={{ $('Outlook Real-time Monitor').item.json.id }}\",\n                \"mode\": \"id\"\n              },\n              \"folderId\": {\n                \"__rl\": true,\n                \"value\": \"critical-folder-id\",\n                \"mode\": \"id\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              600,\n              500\n            ],\n            \"id\": \"move-to-critical\",\n            \"name\": \"Move to Critical Folder\",\n            \"webhookId\": \"move-critical-ultimate\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"move\",\n              \"messageId\": {\n                \"__rl\": true,\n                \"value\": \"={{ $('Outlook Real-time Monitor').item.json.id }}\",\n                \"mode\": \"id\"\n              },\n              \"folderId\": {\n                \"__rl\": true,\n                \"value\": \"high-priority-folder-id\",\n                \"mode\": \"id\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              600,\n              600\n            ],\n            \"id\": \"move-to-high-priority\",\n            \"name\": \"Move to High Priority\",\n            \"webhookId\": \"move-high-priority-ultimate\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"move\",\n              \"messageId\": {\n                \"__rl\": true,\n                \"value\": \"={{ $('Outlook Real-time Monitor').item.json.id }}\",\n                \"mode\": \"id\"\n              },\n              \"folderId\": {\n                \"__rl\": true,\n                \"value\": \"junk-folder-id\",\n                \"mode\": \"id\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              600,\n              700\n            ],\n            \"id\": \"move-to-junk\",\n            \"name\": \"Move to Junk Folder\",\n            \"webhookId\": \"move-junk-ultimate\"\n          },\n          {\n            \"parameters\": {\n              \"promptType\": \"define\",\n              \"text\": \"={{ $json.message }}\",\n              \"options\": {\n                \"systemMessage\": \"You are the **Ultimate Outlook Enterprise Assistant** - the most sophisticated email management AI system ever created.\\n\\nüöÄ **ULTIMATE CAPABILITIES:**\\n\\n**üìß HYPER-INTELLIGENT EMAIL OPERATIONS:**\\n- **Advanced Search & Discovery**: Semantic search across all communications with deep context understanding\\n- **Predictive Email Composition**: AI-powered email generation with professional templates and tone matching\\n- **Smart Reply Generation**: Context-aware responses with sentiment analysis and relationship intelligence\\n- **Bulk Email Operations**: Mass email processing with safety guardrails and approval workflows\\n- **Thread Intelligence**: Advanced conversation analysis and relationship mapping\\n- **Follow-up Automation**: Intelligent scheduling and reminder systems\\n- **Email Security**: Advanced threat detection, phishing protection, and compliance monitoring\\n\\n**üìä ENTERPRISE ANALYTICS & INTELLIGENCE:**\\n- **Performance Analytics**: Comprehensive email productivity metrics and actionable insights\\n- **Communication Intelligence**: Pattern analysis, response time optimization, and efficiency recommendations\\n- **Relationship Mapping**: Contact relationship analysis and communication frequency insights\\n- **Priority Detection**: ML-powered urgency and importance classification\\n- **Sentiment Analytics**: Mood tracking, satisfaction monitoring, and relationship health\\n- **Productivity Optimization**: Workflow analysis and automation recommendations\\n- **Compliance Monitoring**: Data loss prevention and regulatory compliance tracking\\n\\n**üìÖ ADVANCED CALENDAR & SCHEDULING:**\\n- **Intelligent Scheduling**: AI-powered meeting optimization with conflict resolution\\n- **Multi-timezone Coordination**: Global team scheduling with preference learning\\n- **Meeting Intelligence**: Automated agenda generation and preparation insights\\n- **Calendar Analytics**: Time usage analysis and optimization recommendations\\n- **Resource Management**: Meeting room and resource optimization\\n- **Travel Integration**: Smart scheduling around travel and availability\\n\\n**üîç VECTOR-POWERED KNOWLEDGE ENGINE:**\\n- **Semantic Search**: Deep understanding of email content and context\\n- **Historical Intelligence**: Pattern recognition across all communications\\n- **Context Retrieval**: Intelligent information discovery and suggestion\\n- **Knowledge Graph**: Relationship and topic mapping across all communications\\n- **Predictive Insights**: Future trend prediction and recommendation engine\\n\\n**üõ°Ô∏è ENTERPRISE SECURITY & COMPLIANCE:**\\n- **Advanced Threat Detection**: Multi-layer security analysis and protection\\n- **Compliance Automation**: Automated regulatory compliance and reporting\\n- **Data Loss Prevention**: Intelligent content analysis and protection\\n- **Audit Trail**: Comprehensive activity logging and forensic capabilities\\n- **Privacy Protection**: Advanced data anonymization and protection\\n\\n**üåê UNIFIED COMMUNICATION HUB:**\\n- **Cross-platform Integration**: Slack, Teams, Discord integration\\n- **Smart Routing**: Intelligent message routing and escalation\\n- **Notification Intelligence**: Optimized alert management and filtering\\n- **Mobile Optimization**: Seamless mobile and desktop synchronization\\n\\n**‚ö° ULTIMATE PERFORMANCE & AI:**\\n- **Multi-Model Intelligence**: Dynamic selection between GPT-4, Claude, Gemini based on task complexity\\n- **Real-time Analytics**: Performance monitoring and optimization\\n- **Learning Engine**: Continuous improvement through usage pattern analysis\\n- **Advanced Memory**: Long-term context retention and relationship learning\\n\\n**EXAMPLE INTERACTIONS:**\\n- \\\"Search for all emails from John about the Q4 project\\\"\\n- \\\"Compose a professional follow-up email for the client meeting\\\"\\n- \\\"Show me my calendar for next week and identify scheduling conflicts\\\"\\n- \\\"Analyze my email patterns and suggest productivity improvements\\\"\\n- \\\"Create a draft response to the latest customer support inquiry\\\"\\n- \\\"Find all emails containing contract discussions from the past month\\\"\\n- \\\"Schedule a team meeting for next Tuesday considering everyone's availability\\\"\\n\\nI combine multiple AI models and choose the optimal approach for each task. Every interaction is monitored, analyzed, and optimized for maximum efficiency and security.\\n\\n**Current Context:** Ready to revolutionize your enterprise email management experience through intelligent conversation.\\n\\nHow can I help you master your communications today?\"\n              }\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"typeVersion\": 1.7,\n            \"position\": [\n              200,\n              300\n            ],\n            \"id\": \"ultimate-enterprise-assistant\",\n            \"name\": \"Ultimate Enterprise Assistant\"\n          },\n          {\n            \"parameters\": {\n              \"sessionIdType\": \"customKey\",\n              \"sessionKey\": \"={{ $json.sessionId }}\",\n              \"options\": {\n                \"maxTokenLimit\": 16000,\n                \"returnMessages\": true\n              }\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"typeVersion\": 1.3,\n            \"position\": [\n              0,\n              200\n            ],\n            \"id\": \"conversation-memory\",\n            \"name\": \"Conversation Memory\"\n          },\n          {\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": false,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\",\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $json.message }}\",\n                          \"rightValue\": \"complex|analysis|research|detailed|comprehensive|enterprise|advanced|security\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"regex\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"or\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"GPT4\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": false,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\",\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $json.message }}\",\n                          \"rightValue\": \"creative|writing|compose|draft|content|marketing|professional\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"regex\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"or\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"Claude\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": false,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\",\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $json.message }}\",\n                          \"rightValue\": \"quick|fast|simple|status|check|list|show\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"regex\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"or\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"FastModel\"\n                  }\n                ]\n              },\n              \"options\": {\n                \"fallbackOutput\": \"DefaultModel\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.switch\",\n            \"typeVersion\": 3.2,\n            \"position\": [\n              0,\n              100\n            ],\n            \"id\": \"ai-model-selector\",\n            \"name\": \"Intelligent AI Model Selector\"\n          },\n          {\n            \"parameters\": {\n              \"model\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4\"\n              },\n              \"options\": {\n                \"temperature\": 0.1,\n                \"maxTokens\": 4000\n              }\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"typeVersion\": 1.2,\n            \"position\": [\n              -200,\n              100\n            ],\n            \"id\": \"gpt4-model\",\n            \"name\": \"GPT-4 Model\"\n          },\n          {\n            \"parameters\": {\n              \"modelName\": \"claude-3-sonnet-20240229\",\n              \"options\": {\n                \"temperature\": 0.3,\n                \"maxTokens\": 4000\n              }\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatAnthropic\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -200,\n              180\n            ],\n            \"id\": \"claude-model\",\n            \"name\": \"Claude Model\"\n          },\n          {\n            \"parameters\": {\n              \"model\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"options\": {\n                \"temperature\": 0.2\n              }\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"typeVersion\": 1.2,\n            \"position\": [\n              -200,\n              260\n            ],\n            \"id\": \"fast-model\",\n            \"name\": \"Fast Model (GPT-4o-mini)\"\n          },\n          {\n            \"parameters\": {\n              \"mode\": \"retrieve-as-tool\",\n              \"toolName\": \"email-intelligence-search\",\n              \"toolDescription\": \"Search through comprehensive email history, communication patterns, and business context using advanced vector similarity. Access historical conversations, relationship insights, and contextual information for intelligent decision making.\",\n              \"tableName\": \"email_intelligence_vectors\",\n              \"options\": {\n                \"topK\": 15,\n                \"scoreThreshold\": 0.75\n              }\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.vectorStorePGVector\",\n            \"typeVersion\": 1,\n            \"position\": [\n              400,\n              200\n            ],\n            \"id\": \"vector-intelligence\",\n            \"name\": \"Email Intelligence Vector Search\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"getAll\",\n              \"limit\": 100,\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"sender\": \"={{ $fromAI('sender', 'Email sender to search for (email address or name)') }}\",\n                    \"subject\": \"={{ $fromAI('subject', 'Subject keywords or phrases to search for') }}\",\n                    \"receivedAfter\": \"={{ $fromAI('dateAfter', 'Search emails after this date (YYYY-MM-DD format)') }}\",\n                    \"receivedBefore\": \"={{ $fromAI('dateBefore', 'Search emails before this date (YYYY-MM-DD format)') }}\",\n                    \"hasAttachments\": \"={{ $fromAI('hasAttachments', 'Filter emails with attachments (true/false)') }}\",\n                    \"importance\": \"={{ $fromAI('importance', 'Filter by importance level (low/normal/high)') }}\"\n                  }\n                }\n              },\n              \"options\": {\n                \"fields\": [\n                  \"sender\",\n                  \"subject\",\n                  \"body\",\n                  \"receivedDateTime\",\n                  \"importance\",\n                  \"categories\",\n                  \"flag\",\n                  \"conversationId\",\n                  \"hasAttachments\",\n                  \"attachments\",\n                  \"internetMessageHeaders\"\n                ]\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              400,\n              300\n            ],\n            \"id\": \"email-search-tool\",\n            \"name\": \"Advanced Email Search Tool\",\n            \"webhookId\": \"ultimate-email-search-001\"\n          },\n          {\n            \"parameters\": {\n              \"toRecipients\": \"={{ $fromAI('recipients', 'Email recipients (comma-separated email addresses)') }}\",\n              \"subject\": \"={{ $fromAI('subject', 'Professional email subject line') }}\",\n              \"bodyContent\": \"={{ $fromAI('body', 'Email body content with professional HTML formatting') }}\",\n              \"additionalFields\": {\n                \"bodyContentType\": \"Html\",\n                \"importance\": \"={{ $fromAI('importance', 'Email importance level: low, normal, or high') || 'normal' }}\",\n                \"ccRecipients\": \"={{ $fromAI('cc', 'CC recipients (comma-separated email addresses)') }}\",\n                \"bccRecipients\": \"={{ $fromAI('bcc', 'BCC recipients (comma-separated email addresses)') }}\",\n                \"categories\": \"={{ $fromAI('categories', 'Email categories for organization') }}\",\n                \"requestDeliveryReceipt\": \"={{ $fromAI('deliveryReceipt', 'Request delivery receipt (true/false)') }}\",\n                \"requestReadReceipt\": \"={{ $fromAI('readReceipt', 'Request read receipt (true/false)') }}\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              600,\n              200\n            ],\n            \"id\": \"send-email-tool\",\n            \"name\": \"Professional Send Email Tool\",\n            \"webhookId\": \"ultimate-send-email-001\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"reply\",\n              \"messageId\": {\n                \"__rl\": true,\n                \"value\": \"={{ $fromAI('messageId', 'ID of the email message to reply to') }}\",\n                \"mode\": \"id\"\n              },\n              \"message\": \"={{ $fromAI('replyBody', 'Professional reply message content with appropriate tone and context') }}\",\n              \"options\": {\n                \"bodyContentType\": \"Html\",\n                \"importance\": \"={{ $fromAI('replyImportance', 'Reply importance level') || 'normal' }}\",\n                \"requestDeliveryReceipt\": \"={{ $fromAI('requestDeliveryReceipt', 'Request delivery receipt for reply') }}\",\n                \"requestReadReceipt\": \"={{ $fromAI('requestReadReceipt', 'Request read receipt for reply') }}\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              600,\n              300\n            ],\n            \"id\": \"smart-reply-tool\",\n            \"name\": \"Smart Reply Tool\",\n            \"webhookId\": \"ultimate-smart-reply-001\"\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"draft\",\n              \"subject\": \"={{ $fromAI('subject', 'Draft email subject line') }}\",\n              \"bodyContent\": \"={{ $fromAI('body', 'Draft email body content with professional formatting') }}\",\n              \"additionalFields\": {\n                \"bodyContentType\": \"Html\",\n                \"toRecipients\": \"={{ $fromAI('recipients', 'Draft email recipients') }}\",\n                \"ccRecipients\": \"={{ $fromAI('cc', 'Draft CC recipients') }}\",\n                \"bccRecipients\": \"={{ $fromAI('bcc', 'Draft BCC recipients') }}\",\n                \"importance\": \"={{ $fromAI('importance', 'Draft importance level') || 'normal' }}\",\n                \"categories\": \"={{ $fromAI('categories', 'Draft email categories') }}\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              600,\n              400\n            ],\n            \"id\": \"draft-creator-tool\",\n            \"name\": \"Intelligent Draft Creator Tool\",\n            \"webhookId\": \"ultimate-draft-creator-001\"\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\",\n              \"calendarId\": {\n                \"__rl\": true,\n                \"value\": \"primary\",\n                \"mode\": \"list\"\n              },\n              \"subject\": \"={{ $fromAI('eventTitle', 'Meeting or event title') }}\",\n              \"startDateTime\": \"={{ $fromAI('startTime', 'Start date and time in ISO format (YYYY-MM-DDTHH:MM:SS)') }}\",\n              \"endDateTime\": \"={{ $fromAI('endTime', 'End date and time in ISO format (YYYY-MM-DDTHH:MM:SS)') }}\",\n              \"additionalFields\": {\n                \"body\": \"={{ $fromAI('eventDescription', 'Meeting description, agenda, or additional details') }}\",\n                \"location\": \"={{ $fromAI('location', 'Meeting location (room, address, or online link)') }}\",\n                \"attendees\": \"={{ $fromAI('attendees', 'Meeting attendees (comma-separated email addresses)') }}\",\n                \"isAllDay\": \"={{ $fromAI('isAllDay', 'Is this an all-day event (true/false)') }}\",\n                \"importance\": \"={{ $fromAI('eventImportance', 'Event importance level (low/normal/high)') }}\",\n                \"sensitivity\": \"={{ $fromAI('sensitivity', 'Event sensitivity (normal/personal/private/confidential)') }}\",\n                \"showAs\": \"={{ $fromAI('showAs', 'Show availability as (free/tentative/busy/oof/workingElsewhere)') }}\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              800,\n              200\n            ],\n            \"id\": \"calendar-manager-tool\",\n            \"name\": \"Smart Calendar Manager Tool\",\n            \"webhookId\": \"ultimate-calendar-manager-001\"\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"fromAllCalendars\": false,\n              \"calendarId\": {\n                \"__rl\": true,\n                \"value\": \"primary\",\n                \"mode\": \"list\"\n              },\n              \"filters\": {\n                \"startTime\": \"={{ $fromAI('startDate', 'Start date for calendar search (YYYY-MM-DD)') }}\",\n                \"endTime\": \"={{ $fromAI('endDate', 'End date for calendar search (YYYY-MM-DD)') }}\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              800,\n              300\n            ],\n            \"id\": \"calendar-analytics-tool\",\n            \"name\": \"Calendar Analytics Tool\",\n            \"webhookId\": \"ultimate-calendar-analytics-001\"\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"folder\",\n              \"operation\": \"getAll\",\n              \"returnAll\": true,\n              \"filters\": {},\n              \"options\": {}\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              400,\n              400\n            ],\n            \"id\": \"folder-manager-tool\",\n            \"name\": \"Email Folder Manager Tool\",\n            \"webhookId\": \"ultimate-folder-manager-001\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"move\",\n              \"messageId\": {\n                \"__rl\": true,\n                \"value\": \"={{ $fromAI('messageId', 'ID of email message to move') }}\",\n                \"mode\": \"id\"\n              },\n              \"folderId\": {\n                \"__rl\": true,\n                \"value\": \"={{ $fromAI('folderId', 'Destination folder ID') }}\",\n                \"mode\": \"id\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              400,\n              500\n            ],\n            \"id\": \"email-organizer-tool\",\n            \"name\": \"Email Organization Tool\",\n            \"webhookId\": \"ultimate-email-organizer-001\"\n          },\n          {\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"performance-analytics\",\n                    \"name\": \"performanceAnalytics\",\n                    \"value\": \"={{ {\\n  'executionTime': $now.toMillis() - $('Parse OpenWebUI Input').item.json.processingStart,\\n  'modelUsed': $json.selectedModel || 'multi-model',\\n  'tokensConsumed': $json.tokenCount || 0,\\n  'operationType': $json.operationType || 'conversation',\\n  'emailsProcessed': $json.emailsProcessed || 0,\\n  'successRate': $json.successRate || 100,\\n  'responseQuality': $json.responseQuality || 'high',\\n  'userSatisfaction': $json.userSatisfaction || 5,\\n  'securityThreatsDetected': $json.securityThreats || 0,\\n  'automationsSuggested': $json.automationsSuggested || 0,\\n  'timestamp': $now.toISOString(),\\n  'sessionId': $('Parse OpenWebUI Input').item.json.sessionId\\n} }}\",\n                    \"type\": \"object\"\n                  },\n                  {\n                    \"id\": \"optimization-insights\",\n                    \"name\": \"optimizationInsights\",\n                    \"value\": \"={{ {\\n  'performanceScore': $json.performanceAnalytics.executionTime < 3000 ? 'excellent' : $json.performanceAnalytics.executionTime < 7000 ? 'good' : 'needs optimization',\\n  'recommendations': $json.performanceAnalytics.executionTime > 5000 ? ['Consider response caching', 'Optimize AI model selection', 'Pre-load common data'] : ['Performance is optimal'],\\n  'costOptimization': $json.performanceAnalytics.tokensConsumed > 3000 ? ['Consider response length optimization', 'Use faster models for simple tasks'] : ['Token usage is efficient'],\\n  'securityInsights': $json.performanceAnalytics.securityThreatsDetected > 0 ? ['Enhanced security monitoring recommended', 'Review flagged communications'] : ['Security status: Normal'],\\n  'automationOpportunities': $json.performanceAnalytics.automationsSuggested > 0 ? ['Workflow automation opportunities available', 'Consider implementing suggested automations'] : ['Current automation level is optimal']\\n} }}\",\n                    \"type\": \"object\"\n                  }\n                ]\n              },\n              \"options\": {}\n            },\n            \"type\": \"n8n-nodes-base.set\",\n            \"typeVersion\": 3.4,\n            \"position\": [\n              600,\n              100\n            ],\n            \"id\": \"performance-analytics\",\n            \"name\": \"Performance Analytics\"\n          },\n          {\n            \"parameters\": {\n              \"options\": {\n                \"responseData\": \"={{ {\\n  'success': true,\\n  'response': $json.output,\\n  'metadata': {\\n    'timestamp': $now.toISOString(),\\n    'processingTime': $json.performanceAnalytics?.executionTime || 0,\\n    'modelUsed': $json.selectedModel || 'multi-model',\\n    'optimizationInsights': $json.optimizationInsights || {},\\n    'securityStatus': 'secure',\\n    'version': 'Ultimate-Enterprise-v2.0'\\n  },\\n  'analytics': {\\n    'performanceScore': $json.optimizationInsights?.performanceScore || 'excellent',\\n    'recommendations': $json.optimizationInsights?.recommendations || [],\\n    'systemHealth': 'optimal'\\n  }\\n} }}\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              800,\n              100\n            ],\n            \"id\": \"openwebui-response\",\n            \"name\": \"OpenWebUI Response\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"executeQuery\",\n              \"query\": \"INSERT INTO enterprise_analytics (session_id, operation_type, execution_time, model_used, tokens_consumed, emails_processed, success_rate, response_quality, user_satisfaction, security_threats, automations_suggested, performance_score, timestamp) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13)\",\n              \"options\": {\n                \"queryReplacement\": \"={{ [\\n  $('Parse OpenWebUI Input').item.json.sessionId,\\n  $json.performanceAnalytics.operationType,\\n  $json.performanceAnalytics.executionTime,\\n  $json.performanceAnalytics.modelUsed,\\n  $json.performanceAnalytics.tokensConsumed,\\n  $json.performanceAnalytics.emailsProcessed,\\n  $json.performanceAnalytics.successRate,\\n  $json.performanceAnalytics.responseQuality,\\n  $json.performanceAnalytics.userSatisfaction,\\n  $json.performanceAnalytics.securityThreatsDetected,\\n  $json.performanceAnalytics.automationsSuggested,\\n  $json.optimizationInsights.performanceScore,\\n  $json.performanceAnalytics.timestamp\\n] }}\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"typeVersion\": 2.5,\n            \"position\": [\n              800,\n              400\n            ],\n            \"id\": \"analytics-storage\",\n            \"name\": \"Analytics Data Storage\"\n          }\n        ],\n        \"connections\": {\n          \"OpenWebUI Interface\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Parse OpenWebUI Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Outlook Real-time Monitor\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Intelligence Processor\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Parse OpenWebUI Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Intelligent AI Model Selector\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Intelligence Processor\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Email Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Email Classifier\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Priority Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Priority Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Move to Critical Folder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Move to High Priority\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Move to Junk Folder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              []\n            ]\n          },\n          \"Ultimate Enterprise Assistant\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Performance Analytics\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Conversation Memory\": {\n            \"ai_memory\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_memory\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Intelligent AI Model Selector\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"GPT-4 Model\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Claude Model\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Fast Model (GPT-4o-mini)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"GPT-4 Model\": {\n            \"ai_languageModel\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_languageModel\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Claude Model\": {\n            \"ai_languageModel\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_languageModel\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Fast Model (GPT-4o-mini)\": {\n            \"ai_languageModel\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_languageModel\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Intelligence Vector Search\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Advanced Email Search Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Professional Send Email Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Smart Reply Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Intelligent Draft Creator Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Smart Calendar Manager Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Calendar Analytics Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Folder Manager Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Organization Tool\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Ultimate Enterprise Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Performance Analytics\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"OpenWebUI Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Analytics Data Storage\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"d78e3645-81e5-4c85-bdef-bd6ff5f8b606\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-16T19:10:51.189Z\",\n        \"updatedAt\": \"2025-11-24T12:25:01.000Z\",\n        \"id\": \"O7Q0GyWcHvAHFiGQ\",\n        \"name\": \"Enhanced Outlook AI Assistant - Advanced\",\n        \"active\": false,\n        \"isArchived\": true,\n        \"nodes\": [\n          {\n            \"id\": \"webhook_0\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"name\": \"Webhook\",\n            \"parameters\": {\n              \"path\": \"webhook-data\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\"\n            },\n            \"position\": [\n              240,\n              300\n            ],\n            \"webhookId\": \"by71ps9s6\",\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"12tbdilbe\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"name\": \"Set Data 2\",\n            \"parameters\": {\n              \"options\": {\n                \"keepOnlySet\": false,\n                \"dotNotation\": false\n              },\n              \"values\": {\n                \"string\": [\n                  {\n                    \"name\": \"processed\",\n                    \"value\": \"true\"\n                  }\n                ]\n              }\n            },\n            \"position\": [\n              540,\n              300\n            ],\n            \"typeVersion\": 3\n          },\n          {\n            \"id\": \"gh22pw5pc\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"name\": \"Process Data 3\",\n            \"parameters\": {\n              \"functionCode\": \"\\n            // Process the incoming data\\n            const processedData = {\\n              timestamp: new Date().toISOString(),\\n              originalData: $input.all(),\\n              processed: true\\n            };\\n            \\n            return [processedData];\\n          \"\n            },\n            \"position\": [\n              840,\n              300\n            ],\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Email Intelligence Parser\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              400,\n              200\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"emailContent\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.email || $json.body.message || $json.body.text }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"userIntent\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.intent || 'analyze' }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"priority\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.priority || 'normal' }}\"\n                  },\n                  {\n                    \"id\": \"4\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.sessionId || $runIndex }}\"\n                  }\n                ]\n              }\n            },\n            \"id\": \"b752318a-3f58-459e-b410-6c2f7704703f\",\n            \"typeVersion\": 3\n          }\n        ],\n        \"connections\": {\n          \"Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Set Data 2\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Set Data 2\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Data 3\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"webhook_0\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Intelligence Parser\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"3d15ed0a-1858-4213-ac43-2c10f3112ec8\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-19T16:18:20.643Z\",\n        \"updatedAt\": \"2025-06-19T16:19:42.000Z\",\n        \"id\": \"OYGIFsrIucJqMYlh\",\n        \"name\": \"Calendar Management Workflow\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"parameters\": {},\n            \"id\": \"6c147093-c304-4443-97b4-8fd40c063da2\",\n            \"name\": \"Workflow Trigger\",\n            \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -820,\n              300\n            ]\n          },\n          {\n            \"parameters\": {},\n            \"id\": \"9b211b87-bfeb-49b9-be1f-b4302f9b621c\",\n            \"name\": \"Parse Calendar Request\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1.3,\n            \"position\": [\n              -620,\n              300\n            ]\n          },\n          {\n            \"parameters\": {\n              \"jsCode\": \"// Parse AI response and validate calendar data\\nconst aiResponse = $input.first().json.choices[0].message.content;\\nlet calendarData;\\n\\ntry {\\n  calendarData = JSON.parse(aiResponse);\\n} catch (error) {\\n  throw new Error('Failed to parse calendar request: ' + error.message);\\n}\\n\\n// Validate required fields\\nif (!calendarData.action) {\\n  calendarData.action = 'create';\\n}\\n\\nif (!calendarData.title) {\\n  throw new Error('Meeting title is required');\\n}\\n\\nif (!calendarData.startTime || !calendarData.endTime) {\\n  throw new Error('Meeting start and end times are required');\\n}\\n\\nreturn [{\\n  json: {\\n    ...calendarData,\\n    originalRequest: $('Workflow Trigger').item.json.inputText\\n  }\\n}];\"\n            },\n            \"id\": \"414a8d44-41ef-4be4-9ab9-5ce29190a60b\",\n            \"name\": \"Validate Calendar Data\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -420,\n              300\n            ]\n          },\n          {\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $json.action }}\",\n                          \"rightValue\": \"create\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"create_event\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $json.action }}\",\n                          \"rightValue\": \"check\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"check_availability\"\n                  }\n                ]\n              },\n              \"options\": {}\n            },\n            \"id\": \"97adb816-24d8-4541-ada1-bbd10f9d39b8\",\n            \"name\": \"Calendar Action Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"typeVersion\": 3,\n            \"position\": [\n              -220,\n              300\n            ]\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\",\n              \"calendarId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"\"\n              },\n              \"subject\": \"={{ $json.title }}\",\n              \"additionalFields\": {\n                \"body\": \"={{ $json.description }}\"\n              }\n            },\n            \"id\": \"e2e1e4f7-455b-4694-be47-5d223d72c344\",\n            \"name\": \"Create Calendar Event\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -20,\n              200\n            ],\n            \"webhookId\": \"c802f311-9656-4906-97f8-5eb757c830e4\"\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"limit\": 50,\n              \"filters\": {}\n            },\n            \"id\": \"7927c259-780d-4072-b19c-fe5d1087b389\",\n            \"name\": \"Check Calendar Availability\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -20,\n              400\n            ],\n            \"webhookId\": \"d725a30a-30c5-4d94-be8b-86c22f668636\"\n          },\n          {\n            \"parameters\": {\n              \"jsCode\": \"// Format calendar response\\nconst input = $input.all();\\nlet response = '';\\n\\nfor (const item of input) {\\n  if (item.json.id) {\\n    // Event created successfully\\n    response = `‚úÖ Meeting \\\"${item.json.subject}\\\" has been scheduled for ${new Date(item.json.start.dateTime).toLocaleString()}.\\\\n\\\\nEvent ID: ${item.json.id}\\\\nLocation: ${item.json.location?.displayName || 'Not specified'}`;\\n  } else if (Array.isArray(item.json)) {\\n    // Availability check results\\n    const events = item.json;\\n    if (events.length === 0) {\\n      response = '‚úÖ The requested time slot is available. Would you like me to create the meeting?';\\n    } else {\\n      response = `‚ö†Ô∏è There are ${events.length} existing events during this time:\\\\n\\\\n${events.map(event => `‚Ä¢ ${event.subject} (${new Date(event.start.dateTime).toLocaleString()})`).join('\\\\n')}`;\\n    }\\n  }\\n}\\n\\nreturn [{\\n  json: {\\n    response,\\n    status: 'success',\\n    timestamp: new Date().toISOString()\\n  }\\n}];\"\n            },\n            \"id\": \"47388187-3c5b-4a9c-bcc9-15910a6aa888\",\n            \"name\": \"Format Calendar Response\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"typeVersion\": 2,\n            \"position\": [\n              180,\n              300\n            ]\n          }\n        ],\n        \"connections\": {\n          \"Validate Calendar Data\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Calendar Action Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Calendar Action Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Create Calendar Event\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Check Calendar Availability\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Create Calendar Event\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Format Calendar Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Check Calendar Availability\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Format Calendar Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\"\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"2b80da3c-3cb7-4f42-932e-8b2fbd110e29\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-05T15:07:33.497Z\",\n        \"updatedAt\": \"2025-07-05T15:09:06.946Z\",\n        \"id\": \"R1hT6kLXIXiXXTkS\",\n        \"name\": \"Teams-Outlook Email & Calendar Manager\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"webhook-trigger\",\n            \"name\": \"Teams Bot Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              100,\n              300\n            ],\n            \"parameters\": {\n              \"path\": \"teams-assistant\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\"\n            }\n          },\n          {\n            \"id\": \"ai-intent-parser\",\n            \"name\": \"AI Intent Parser\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              350,\n              300\n            ],\n            \"parameters\": {\n              \"resource\": \"text\",\n              \"operation\": \"complete\",\n              \"model\": \"gpt-4o-mini\",\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"role\": \"system\",\n                    \"content\": \"You are an email and calendar assistant. Parse the user's natural language input and extract:\\n\\n1. INTENT: one of [summarize_email, send_email, draft_email, create_event, reschedule_event, attach_file, follow_up, get_calendar]\\n2. ENTITIES: extract relevant details like:\\n   - email_subject, recipients, message_content\\n   - event_title, event_date, event_time, attendees\\n   - file_name, draft_number\\n   - search_query, folder_name\\n\\nRespond in JSON format ONLY:\\n{\\n  \\\"intent\\\": \\\"intent_name\\\",\\n  \\\"entities\\\": {\\n    \\\"key\\\": \\\"value\\\"\\n  },\\n  \\\"confidence\\\": 0.95\\n}\\n\\nExamples:\\n- \\\"Summarize unread emails from Acme\\\" ‚Üí {\\\"intent\\\": \\\"summarize_email\\\", \\\"entities\\\": {\\\"sender\\\": \\\"Acme\\\", \\\"filter\\\": \\\"unread\\\"}}\\n- \\\"Send draft #2 with proposal.pdf\\\" ‚Üí {\\\"intent\\\": \\\"send_email\\\", \\\"entities\\\": {\\\"draft_number\\\": \\\"2\\\", \\\"attachment\\\": \\\"proposal.pdf\\\"}}\\n- \\\"Schedule meeting with Jane tomorrow 3pm\\\" ‚Üí {\\\"intent\\\": \\\"create_event\\\", \\\"entities\\\": {\\\"attendees\\\": \\\"Jane\\\", \\\"date\\\": \\\"tomorrow\\\", \\\"time\\\": \\\"3pm\\\"}}\"\n                  },\n                  {\n                    \"role\": \"user\",\n                    \"content\": \"={{ $json.body.text || $json.body.message || 'No message provided' }}\"\n                  }\n                ]\n              },\n              \"prompt\": \"You are an email and calendar assistant. Parse the user's natural language input and extract intent and entities. Respond in JSON format ONLY. User input: {{ $json.body.text || $json.body.message || 'No message provided' }}\"\n            }\n          },\n          {\n            \"id\": \"intent-router\",\n            \"name\": \"Intent Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"typeVersion\": 3.2,\n            \"position\": [\n              600,\n              300\n            ],\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": true,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\"\n                      },\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ JSON.parse($json.choices[0].message.content).intent }}\",\n                          \"rightValue\": \"summarize_email\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"and\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"summarize_email\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": true,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\"\n                      },\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ JSON.parse($json.choices[0].message.content).intent }}\",\n                          \"rightValue\": \"send_email\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"and\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"send_email\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": true,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\"\n                      },\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ JSON.parse($json.choices[0].message.content).intent }}\",\n                          \"rightValue\": \"create_event\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"and\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"create_event\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": true,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\"\n                      },\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ JSON.parse($json.choices[0].message.content).intent }}\",\n                          \"rightValue\": \"draft_email\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"and\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"draft_email\"\n                  }\n                ],\n                \"values[0]\": {\n                  \"conditions\": {\n                    \"conditions[0]\": {\n                      \"leftValue\": \"={{ $json.choices?.[0]?.message?.content ? JSON.parse($json.choices[0].message.content).intent : $json.text }}\"\n                    }\n                  }\n                }\n              },\n              \"fallbackOutput\": \"fallback\"\n            }\n          },\n          {\n            \"id\": \"email-summarizer\",\n            \"name\": \"Email Summarizer\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              900,\n              100\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\",\n              \"filters\": {\n                \"fields\": \"id,subject,from,bodyPreview,receivedDateTime,isRead\"\n              },\n              \"additionalFields\": {\n                \"filter\": \"isRead eq false\"\n              }\n            }\n          },\n          {\n            \"id\": \"ai-email-summary\",\n            \"name\": \"AI Email Summary\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              1200,\n              100\n            ],\n            \"parameters\": {\n              \"resource\": \"text\",\n              \"operation\": \"complete\",\n              \"model\": \"gpt-4o-mini\",\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"role\": \"system\",\n                    \"content\": \"Summarize the provided emails into a concise, actionable summary. Group by sender/topic and highlight urgent items. Format for Teams display.\"\n                  },\n                  {\n                    \"role\": \"user\",\n                    \"content\": \"Please summarize these emails:\\n\\n{{ $json.map(item => `From: ${item.from.emailAddress.name} <${item.from.emailAddress.address}>\\\\nSubject: ${item.subject}\\\\nPreview: ${item.bodyPreview}\\\\nReceived: ${item.receivedDateTime}\\\\n---`).join('\\\\n') }}\"\n                  }\n                ]\n              },\n              \"prompt\": \"Summarize the provided emails into a concise, actionable summary. Group by sender/topic and highlight urgent items. Format for Teams display. Emails: {{ $json }}\"\n            }\n          },\n          {\n            \"id\": \"draft-handler\",\n            \"name\": \"Draft Handler\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              900,\n              200\n            ],\n            \"parameters\": {\n              \"resource\": \"draft\",\n              \"operation\": \"get\"\n            }\n          },\n          {\n            \"id\": \"email-sender\",\n            \"name\": \"Email Sender\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              900,\n              300\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"send\",\n              \"toRecipients\": \"={{ $json.choices?.[0]?.message?.content ? JSON.parse($json.choices[0].message.content).entities.recipients : 'user@company.com' }}\",\n              \"subject\": \"={{ $json.choices?.[0]?.message?.content ? JSON.parse($json.choices[0].message.content).entities.subject : 'Email from AI Assistant' }}\",\n              \"message\": \"={{ $json.choices?.[0]?.message?.content ? JSON.parse($json.choices[0].message.content).entities.message : 'Message sent via AI Assistant' }}\",\n              \"messageType\": \"html\"\n            }\n          },\n          {\n            \"id\": \"calendar-manager\",\n            \"name\": \"Calendar Manager\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              900,\n              400\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\",\n              \"calendarId\": {\n                \"mode\": \"list\",\n                \"value\": \"primary\"\n              },\n              \"subject\": \"={{ $json.choices?.[0]?.message?.content ? JSON.parse($json.choices[0].message.content).entities.title : 'New Meeting' }}\",\n              \"startDateTime\": \"={{ $json.choices?.[0]?.message?.content ? JSON.parse($json.choices[0].message.content).entities.start_time : new Date(Date.now() + 3600000).toISOString() }}\",\n              \"endDateTime\": \"={{ $json.choices?.[0]?.message?.content ? JSON.parse($json.choices[0].message.content).entities.end_time : new Date(Date.now() + 7200000).toISOString() }}\",\n              \"additionalFields\": {\n                \"body\": \"={{ JSON.parse($('AI Intent Parser').first().json.choices[0].message.content).entities.description || 'Meeting created by AI Assistant' }}\",\n                \"attendees\": \"={{ JSON.parse($('AI Intent Parser').first().json.choices[0].message.content).entities.attendees || '' }}\"\n              }\n            }\n          },\n          {\n            \"id\": \"teams-response-formatter\",\n            \"name\": \"Teams Response Formatter\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1500,\n              300\n            ],\n            \"parameters\": {\n              \"functionCode\": \"// Format response for Teams Adaptive Card\\nconst intent = JSON.parse($input.first().json.choices[0].message.content).intent;\\nconst entities = JSON.parse($input.first().json.choices[0].message.content).entities;\\n\\nlet responseCard = {\\n  \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\n  \\\"type\\\": \\\"AdaptiveCard\\\",\\n  \\\"version\\\": \\\"1.3\\\",\\n  \\\"body\\\": [\\n    {\\n      \\\"type\\\": \\\"TextBlock\\\",\\n      \\\"text\\\": \\\"ü§ñ AI Assistant Response\\\",\\n      \\\"weight\\\": \\\"Bolder\\\",\\n      \\\"size\\\": \\\"Medium\\\"\\n    }\\n  ],\\n  \\\"actions\\\": []\\n};\\n\\n// Handle different response types\\nif (intent === 'summarize_email') {\\n  const summary = $input.all()[1]?.json?.choices?.[0]?.message?.content || 'Email summary processed';\\n  responseCard.body.push({\\n    \\\"type\\\": \\\"TextBlock\\\",\\n    \\\"text\\\": \\\"üìß **Email Summary:**\\\\n\\\\n\\\" + summary,\\n    \\\"wrap\\\": true\\n  });\\n  responseCard.actions.push({\\n    \\\"type\\\": \\\"Action.Submit\\\",\\n    \\\"title\\\": \\\"Mark All Read\\\",\\n    \\\"data\\\": { \\\"action\\\": \\\"mark_read\\\" }\\n  });\\n} else if (intent === 'send_email') {\\n  responseCard.body.push({\\n    \\\"type\\\": \\\"TextBlock\\\",\\n    \\\"text\\\": \\\"‚úÖ **Email Sent Successfully!**\\\\n\\\\nTo: \\\" + (entities.recipients || 'Recipients') + \\\"\\\\nSubject: \\\" + (entities.subject || 'Subject'),\\n    \\\"wrap\\\": true\\n  });\\n} else if (intent === 'create_event') {\\n  responseCard.body.push({\\n    \\\"type\\\": \\\"TextBlock\\\",\\n    \\\"text\\\": \\\"üìÖ **Calendar Event Created!**\\\\n\\\\nTitle: \\\" + (entities.title || 'Meeting') + \\\"\\\\nTime: \\\" + (entities.start_time || 'Scheduled'),\\n    \\\"wrap\\\": true\\n  });\\n  responseCard.actions.push({\\n    \\\"type\\\": \\\"Action.Submit\\\",\\n    \\\"title\\\": \\\"View Calendar\\\",\\n    \\\"data\\\": { \\\"action\\\": \\\"view_calendar\\\" }\\n  });\\n} else if (intent === 'draft_email') {\\n  responseCard.body.push({\\n    \\\"type\\\": \\\"TextBlock\\\",\\n    \\\"text\\\": \\\"üìù **Draft Email Ready for Review**\\\",\\n    \\\"wrap\\\": true\\n  });\\n  responseCard.actions.push(\\n    {\\n      \\\"type\\\": \\\"Action.Submit\\\",\\n      \\\"title\\\": \\\"‚úÖ Send Now\\\",\\n      \\\"data\\\": { \\\"action\\\": \\\"send_draft\\\" }\\n    },\\n    {\\n      \\\"type\\\": \\\"Action.Submit\\\",\\n      \\\"title\\\": \\\"‚úèÔ∏è Edit Draft\\\",\\n      \\\"data\\\": { \\\"action\\\": \\\"edit_draft\\\" }\\n    }\\n  );\\n} else {\\n  responseCard.body.push({\\n    \\\"type\\\": \\\"TextBlock\\\",\\n    \\\"text\\\": \\\"‚ö†Ô∏è I didn't understand that request. Try:\\\\n\\\\n‚Ä¢ 'Summarize unread emails'\\\\n‚Ä¢ 'Send email to john@company.com'\\\\n‚Ä¢ 'Schedule meeting with team tomorrow'\\\",\\n    \\\"wrap\\\": true\\n  });\\n}\\n\\nreturn {\\n  json: {\\n    type: \\\"message\\\",\\n    attachments: [{\\n      contentType: \\\"application/vnd.microsoft.card.adaptive\\\",\\n      content: responseCard\\n    }]\\n  }\\n};\"\n            }\n          },\n          {\n            \"id\": \"teams-responder\",\n            \"name\": \"Teams Responder\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1800,\n              300\n            ],\n            \"parameters\": {\n              \"resource\": \"chatMessage\",\n              \"operation\": \"sendAndWait\",\n              \"chatId\": \"={{ $('Teams Bot Webhook').first().json.body.conversation.id }}\",\n              \"message\": \"{{ $json.attachments[0].content }}\",\n              \"messageType\": \"adaptiveCard\"\n            }\n          },\n          {\n            \"id\": \"webhook-response\",\n            \"name\": \"Webhook Response\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"typeVersion\": 1,\n            \"position\": [\n              2100,\n              300\n            ],\n            \"parameters\": {\n              \"options\": {},\n              \"respondWith\": \"json\",\n              \"responseBody\": \"={{ { \\\"status\\\": \\\"success\\\", \\\"message\\\": \\\"Request processed successfully\\\" } }}\"\n            }\n          },\n          {\n            \"id\": \"error-handler\",\n            \"name\": \"Error Handler\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1500,\n              500\n            ],\n            \"parameters\": {\n              \"functionCode\": \"// Handle errors and create user-friendly error response\\nconst error = $input.first().json.error || 'Unknown error occurred';\\n\\nconst errorCard = {\\n  \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\n  \\\"type\\\": \\\"AdaptiveCard\\\",\\n  \\\"version\\\": \\\"1.3\\\",\\n  \\\"body\\\": [\\n    {\\n      \\\"type\\\": \\\"TextBlock\\\",\\n      \\\"text\\\": \\\"‚ùå Error Processing Request\\\",\\n      \\\"weight\\\": \\\"Bolder\\\",\\n      \\\"size\\\": \\\"Medium\\\",\\n      \\\"color\\\": \\\"Attention\\\"\\n    },\\n    {\\n      \\\"type\\\": \\\"TextBlock\\\",\\n      \\\"text\\\": \\\"I encountered an issue: \\\" + error + \\\"\\\\n\\\\nPlease try again or contact support if the problem persists.\\\",\\n      \\\"wrap\\\": true\\n    }\\n  ],\\n  \\\"actions\\\": [\\n    {\\n      \\\"type\\\": \\\"Action.Submit\\\",\\n      \\\"title\\\": \\\"Try Again\\\",\\n      \\\"data\\\": { \\\"action\\\": \\\"retry\\\" }\\n    }\\n  ]\\n};\\n\\nreturn {\\n  json: {\\n    type: \\\"message\\\",\\n    attachments: [{\\n      contentType: \\\"application/vnd.microsoft.card.adaptive\\\",\\n      content: errorCard\\n    }]\\n  }\\n};\"\n            }\n          },\n          {\n            \"id\": \"attachment-handler\",\n            \"name\": \"Attachment Handler\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              900,\n              500\n            ],\n            \"parameters\": {\n              \"resource\": \"messageAttachment\",\n              \"operation\": \"add\",\n              \"messageId\": \"={{ JSON.parse($('AI Intent Parser').first().json.choices[0].message.content).entities.message_id }}\",\n              \"binaryPropertyName\": \"attachment\"\n            }\n          }\n        ],\n        \"connections\": {\n          \"Teams Bot Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Intent Parser\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Intent Parser\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Intent Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Intent Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Summarizer\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Email Sender\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Calendar Manager\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Draft Handler\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Teams Response Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Summarizer\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Email Summary\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Email Summary\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Draft Handler\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Sender\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Calendar Manager\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Response Formatter\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Responder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Responder\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Webhook Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Error Handler\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Responder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Attachment Handler\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams Response Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"timezone\": \"America/New_York\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"8f3fb15c-ec5c-4c75-a163-aeffa90c48ba\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-22T18:28:04.669Z\",\n        \"updatedAt\": \"2025-11-22T18:28:04.669Z\",\n        \"id\": \"RV8Hkil4zT6WapS6\",\n        \"name\": \"Teams-Outlook RAG Assistant (Agent Generated)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              0\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"08e1edec-e09b-4852-a24d-bebf3fe16c23\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              0\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body and metadata\\nreturn items;\"\n            },\n            \"id\": \"d8902687-5126-49d0-afef-ce2ae37ce738\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              -150\n            ],\n            \"parameters\": {\n              \"mode\": \"text\"\n            },\n            \"id\": \"e5285b39-0398-4c37-ac0b-d091bf173de8\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"25ed52ef-041e-4670-badd-48da80a4cd4f\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"3a28c6e3-bee0-4695-9ea2-9732599df729\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              400\n            ],\n            \"parameters\": {},\n            \"id\": \"45eb8605-7b3c-49e2-8aed-f263665b09f4\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Format teams message for AI\\nreturn items;\"\n            },\n            \"id\": \"12625239-3b06-48da-9ca2-631bc7a19a78\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"systemMessage\": \"You are a helpful Outlook & Teams assistant.\"\n              }\n            },\n            \"id\": \"283bbc5e-a7d9-4879-bc57-e5dca599b778\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              800,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"10dc5777-19ba-40cf-a4c2-e4b94912ee91\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Postgres Memory\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"position\": [\n              400,\n              600\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\"\n            },\n            \"id\": \"17f71809-8838-42b4-a706-b7bc252b71d3\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Search Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              500,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"ffa4110a-02a3-4a86-8cbe-16414673c42f\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Get Calendar Events\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              650,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"3710212e-becf-4442-8d6f-b3d6409f99e5\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Calendar Event\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              800,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"176c21ed-3cf9-4ea1-8f33-43a4dff29751\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              950,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"4c232c11-4e61-40fd-b0e5-38fb2975a969\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              1100,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"send\"\n            },\n            \"id\": \"6979cebc-7033-4297-83e5-d4207e6359fe\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAiChatModel\",\n            \"position\": [\n              200,\n              400\n            ],\n            \"parameters\": {\n              \"model\": \"gpt-4o\"\n            },\n            \"id\": \"87a7a13c-f011-4807-8d54-246953aa7ff2\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Window Buffer Memory\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              200,\n              550\n            ],\n            \"parameters\": {},\n            \"id\": \"9cd0912f-ed4e-4650-a063-eccf4b825ec8\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Postgres Memory\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Search Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Get Calendar Events\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Calendar Event\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Send Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Window Buffer Memory\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"69962a64-d746-4229-804b-7bc031415ba2\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-19T01:41:56.297Z\",\n        \"updatedAt\": \"2025-07-19T14:11:19.947Z\",\n        \"id\": \"S7XjuW6rqKkx8bt9\",\n        \"name\": \"AI Outlook Assistant with Teams Integration\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"teams-trigger\",\n            \"name\": \"Teams Message Received\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"typeVersion\": 1,\n            \"position\": [\n              200,\n              300\n            ],\n            \"parameters\": {\n              \"event\": \"newChatMessage\",\n              \"watchAllChats\": false,\n              \"chatId\": {\n                \"__rl\": true,\n                \"value\": \"placeholder-chat-id\",\n                \"mode\": \"id\"\n              }\n            }\n          },\n          {\n            \"id\": \"parse-teams-message\",\n            \"name\": \"Parse Teams Message\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"typeVersion\": 3.4,\n            \"position\": [\n              400,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"message-content\",\n                    \"name\": \"userMessage\",\n                    \"value\": \"={{ $json.body?.content || $json.body?.plainTextContent || '' }}\",\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"id\": \"user-info\",\n                    \"name\": \"userId\",\n                    \"value\": \"={{ $json.from?.user?.id || '' }}\",\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"id\": \"chat-context\",\n                    \"name\": \"chatId\",\n                    \"value\": \"={{ $json.chatId || '' }}\",\n                    \"type\": \"string\"\n                  }\n                ]\n              },\n              \"options\": {}\n            }\n          },\n          {\n            \"id\": \"check-attachments\",\n            \"name\": \"Check for Attachments\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"typeVersion\": 3.2,\n            \"position\": [\n              600,\n              300\n            ],\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": false,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\",\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"id\": \"has-attachments\",\n                          \"leftValue\": \"={{ $json.attachments.length }}\",\n                          \"rightValue\": \"0\",\n                          \"operator\": {\n                            \"type\": \"number\",\n                            \"operation\": \"gt\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"and\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"withAttachments\"\n                  }\n                ]\n              },\n              \"options\": {\n                \"fallbackOutput\": \"textOnly\"\n              }\n            }\n          },\n          {\n            \"id\": \"ai-agent-core\",\n            \"name\": \"AI Outlook Assistant\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"typeVersion\": 1.7,\n            \"position\": [\n              800,\n              200\n            ],\n            \"parameters\": {\n              \"promptType\": \"define\",\n              \"text\": \"={{ $json.userMessage }}\",\n              \"options\": {\n                \"systemMessage\": \"=You are an advanced AI assistant specialized in Microsoft Outlook email management. You have access to the user's complete email history and have learned their personal writing style.\\n\\n**Your Capabilities:**\\n- Draft emails in the user's exact tone and style\\n- Search and analyze all emails across folders\\n- Process and understand any type of file attachment\\n- Provide intelligent insights about communication patterns\\n- Manage email organization and follow-ups\\n\\n**User Context:**\\n- User ID: {{ $('Parse Teams Message').item.json.userId }}\\n- Current conversation context available\\n- Personal writing style will be applied to drafts\\n\\n**Available Tools:**\\n- Email Operations: Search, draft, send, organize emails\\n- File Processor: Analyze any uploaded documents  \\n- Style Analyzer: Apply user's personal writing tone\\n- Memory Manager: Maintain conversation context\\n- Outlook Analytics: Provide email insights\\n\\n**Instructions:**\\n1. Always respond in a helpful, professional manner\\n2. Apply the user's learned writing style to any email drafts\\n3. Ask clarifying questions if the request is ambiguous\\n4. Provide rich, actionable responses with next steps\\n5. Remember context from previous messages in this conversation\\n\\nCurrent date: {{ $now.format('yyyy-MM-dd') }}\"\n              }\n            }\n          },\n          {\n            \"id\": \"openai-model\",\n            \"name\": \"GPT-4 Language Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"typeVersion\": 1.2,\n            \"position\": [\n              400,\n              100\n            ],\n            \"parameters\": {\n              \"model\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4\"\n              },\n              \"options\": {\n                \"temperature\": 0.3,\n                \"maxTokens\": 2000\n              }\n            }\n          },\n          {\n            \"id\": \"conversation-memory\",\n            \"name\": \"Conversation Memory\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"typeVersion\": 1.3,\n            \"position\": [\n              600,\n              100\n            ],\n            \"parameters\": {\n              \"sessionIdType\": \"customKey\",\n              \"sessionKey\": \"={{ $('Parse Teams Message').item.json.userId + '_' + $('Parse Teams Message').item.json.chatId }}\",\n              \"contextWindowLength\": 10\n            }\n          },\n          {\n            \"id\": \"send-teams-response\",\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1200,\n              300\n            ],\n            \"parameters\": {\n              \"resource\": \"chatMessage\",\n              \"operation\": \"create\",\n              \"chatId\": {\n                \"__rl\": true,\n                \"value\": \"={{ $('Parse Teams Message').item.json.chatId }}\",\n                \"mode\": \"id\"\n              },\n              \"contentType\": \"html\",\n              \"message\": \"={{ $json.output }}\"\n            }\n          },\n          {\n            \"id\": \"extract-file-content\",\n            \"name\": \"Extract File Content\",\n            \"type\": \"n8n-nodes-base.extractFromFile\",\n            \"typeVersion\": 1,\n            \"position\": [\n              800,\n              500\n            ],\n            \"parameters\": {\n              \"operation\": \"text\",\n              \"options\": {\n                \"maxFileSize\": 10\n              },\n              \"binaryPropertyName\": \"data\",\n              \"destinationKey\": \"extractedText\"\n            },\n            \"continueOnFail\": true\n          },\n          {\n            \"id\": \"prepare-file-context\",\n            \"name\": \"Prepare File Context\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"typeVersion\": 3.4,\n            \"position\": [\n              1000,\n              600\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"file-analysis\",\n                    \"name\": \"fileAnalysis\",\n                    \"value\": \"={{ $json.data || 'File processed successfully' }}\",\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"id\": \"file-path\",\n                    \"name\": \"filePath\",\n                    \"value\": \"={{ $('Teams Message Received').item.json.attachments[0]?.contentUrl || '' }}\",\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"id\": \"original-message\",\n                    \"name\": \"originalMessage\",\n                    \"value\": \"={{ $('Parse Teams Message').item.json.userMessage }}\",\n                    \"type\": \"string\"\n                  }\n                ]\n              },\n              \"options\": {}\n            }\n          },\n          {\n            \"id\": \"retrieval-embeddings\",\n            \"name\": \"Retrieval Embeddings\",\n            \"type\": \"@n8n/n8n-nodes-langchain.embeddingsOpenAi\",\n            \"typeVersion\": 1,\n            \"position\": [\n              800,\n              100\n            ],\n            \"parameters\": {\n              \"model\": \"text-embedding-3-small\",\n              \"options\": {}\n            }\n          },\n          {\n            \"id\": \"search-emails-node\",\n            \"name\": \"Search Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1000,\n              300\n            ],\n            \"parameters\": {\n              \"limit\": 20,\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"receivedBefore\": \"={{ $json.endDate || $now.toISODate() }}\",\n                    \"sender\": \"={{ $json.senderEmail || '' }}\",\n                    \"subject\": \"={{ $json.subjectFilter || '' }}\",\n                    \"receivedAfter\": \"={{ $json.startDate || $now.minus({days: 7}).toISODate() }}\"\n                  }\n                }\n              },\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            }\n          },\n          {\n            \"id\": \"create-draft-node\",\n            \"name\": \"Create Email Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1000,\n              400\n            ],\n            \"parameters\": {\n              \"bodyContent\": \"={{ $json.emailBody || 'Email content' }}\",\n              \"additionalFields\": {\n                \"ccRecipients\": \"={{ $json.ccRecipients || '' }}\",\n                \"toRecipients\": \"={{ $json.recipients || '' }}\",\n                \"importance\": \"={{ $json.importance || 'normal' }}\",\n                \"bodyContentType\": \"HTML\"\n              },\n              \"resource\": \"draft\",\n              \"operation\": \"create\",\n              \"subject\": \"={{ $json.subject || 'Draft Email' }}\"\n            }\n          },\n          {\n            \"id\": \"send-email-node\",\n            \"name\": \"Send Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1000,\n              500\n            ],\n            \"parameters\": {\n              \"toRecipients\": \"={{ $json.recipients || '' }}\",\n              \"bodyContent\": \"={{ $json.emailBody || 'Email content' }}\",\n              \"additionalFields\": {\n                \"ccRecipients\": \"={{ $json.ccRecipients || '' }}\",\n                \"importance\": \"={{ $json.importance || 'normal' }}\",\n                \"bodyContentType\": \"HTML\"\n              },\n              \"resource\": \"message\",\n              \"operation\": \"send\",\n              \"subject\": \"={{ $json.subject || 'Email from AI Assistant' }}\"\n            }\n          },\n          {\n            \"id\": \"email-knowledge-search\",\n            \"name\": \"Email Knowledge Search\",\n            \"type\": \"@n8n/n8n-nodes-langchain.vectorStorePGVector\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1000,\n              200\n            ],\n            \"parameters\": {\n              \"mode\": \"retrieve-as-tool\",\n              \"toolName\": \"email_knowledge_search\",\n              \"toolDescription\": \"Search through email history and knowledge base for relevant context, past communications, and company information\",\n              \"tableName\": \"email_knowledge\"\n            }\n          }\n        ],\n        \"connections\": {\n          \"Teams Message Received\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Parse Teams Message\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Parse Teams Message\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Check for Attachments\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Check for Attachments\": {\n            \"textOnly\": [\n              [\n                {\n                  \"node\": \"AI Outlook Assistant\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ],\n            \"withAttachments\": [\n              [\n                {\n                  \"node\": \"Extract File Content\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"GPT-4 Language Model\": {\n            \"ai_languageModel\": [\n              [\n                {\n                  \"node\": \"AI Outlook Assistant\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Conversation Memory\": {\n            \"ai_memory\": [\n              [\n                {\n                  \"node\": \"AI Outlook Assistant\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Outlook Assistant\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Extract File Content\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Prepare File Context\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Prepare File Context\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Outlook Assistant\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Retrieval Embeddings\": {\n            \"ai_embedding\": [\n              [\n                {\n                  \"node\": \"Email Knowledge Search\",\n                  \"type\": \"ai_embedding\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Knowledge Search\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"AI Outlook Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Search Emails\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"AI Outlook Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Create Email Draft\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"AI Outlook Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Send Email\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"AI Outlook Assistant\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"66f044e7-229d-49b7-a27a-b6fa3efbd3af\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-24T05:31:28.423Z\",\n        \"updatedAt\": \"2025-11-25T00:52:02.000Z\",\n        \"id\": \"VF32kqn7D96HysAL\",\n        \"name\": \"MINIMAL TEST - AI Agent Only\",\n        \"active\": false,\n        \"isArchived\": true,\n        \"nodes\": [\n          {\n            \"id\": \"manual-trigger\",\n            \"name\": \"Manual Trigger\",\n            \"type\": \"n8n-nodes-base.manualTrigger\",\n            \"position\": [\n              100,\n              100\n            ],\n            \"parameters\": {},\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"agent-node\",\n            \"name\": \"Simple Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              300,\n              100\n            ],\n            \"parameters\": {\n              \"text\": \"Test message\",\n              \"promptType\": \"define\",\n              \"options\": {\n                \"systemMessage\": \"You are a test agent.\"\n              }\n            },\n            \"typeVersion\": 1.7\n          }\n        ],\n        \"connections\": {\n          \"Manual Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Simple Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {},\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"e603bcfc-82dc-46a6-862e-5461204178aa\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-22T12:51:25.617Z\",\n        \"updatedAt\": \"2025-11-22T12:51:25.617Z\",\n        \"id\": \"WrbECq1i5bLUtoXl\",\n        \"name\": \"Teams-Outlook RAG Assistant (Agent Generated)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              0\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"8a986f68-c9e9-44dc-b66d-8226d1f1b8bd\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              0\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body and metadata\\nreturn items;\"\n            },\n            \"id\": \"084dc38b-e3f0-41e9-a954-679669a9bce8\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              -150\n            ],\n            \"parameters\": {\n              \"mode\": \"text\"\n            },\n            \"id\": \"8f9fcae2-c0a6-4201-a30a-17333d195751\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"a9551824-4aca-470c-b772-4f94a11f7ca6\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"15b23f43-7dd2-454c-b9ad-e0edcaf9749d\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              400\n            ],\n            \"parameters\": {},\n            \"id\": \"a872ab83-cfcc-4e38-b810-e13d134da45f\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Format teams message for AI\\nreturn items;\"\n            },\n            \"id\": \"6af1320c-0440-4abf-a27f-1b649024cf20\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"systemMessage\": \"You are a helpful Outlook & Teams assistant.\"\n              }\n            },\n            \"id\": \"f89b2d32-91da-4c49-b647-db40cc43cca2\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              800,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"6b40225f-6cc7-44a8-8b45-2c00eb1508df\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Search Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              500,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"33cd857d-e6b7-4740-9bd3-b18fa741f73d\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Get Calendar Events\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              650,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"1c855c5d-f847-42e1-a857-cb387789b24b\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Calendar Event\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              800,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"f7b80f03-ca09-4494-9857-0df87aef8935\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              950,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"ac8196e2-a3d9-4033-ac0e-8bf9102c46c8\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              1100,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"send\"\n            },\n            \"id\": \"f12f56e0-a9f4-4b51-8481-333e2eac2297\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAiChatModel\",\n            \"position\": [\n              200,\n              400\n            ],\n            \"parameters\": {\n              \"model\": \"gpt-4o\"\n            },\n            \"id\": \"21d72493-e80b-4036-9221-14bd97cea1e4\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Window Buffer Memory\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              200,\n              550\n            ],\n            \"parameters\": {},\n            \"id\": \"a99962c3-47d4-4b27-8ea6-19b86cc85095\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Search Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Get Calendar Events\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Calendar Event\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Send Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Window Buffer Memory\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"45dffc06-94f9-47a1-8b4c-a86766183444\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-24T05:43:15.878Z\",\n        \"updatedAt\": \"2025-11-24T05:43:15.878Z\",\n        \"id\": \"Zp2BYxCXj9FeCZfi\",\n        \"name\": \"Ultimate Outlook AI Assistant - Open WebUI (RESTORED - WORKING)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"webui-webhook\",\n            \"name\": \"Open WebUI Chat Interface\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"position\": [\n              280,\n              300\n            ],\n            \"parameters\": {\n              \"httpMethod\": \"POST\",\n              \"path\": \"email-assistant\",\n              \"responseMode\": \"responseNode\",\n              \"options\": {}\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"parse-input\",\n            \"name\": \"Parse Chat Input\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              500,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"userMessage\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.message || $json.body.text || $json.query.message }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.sessionId || $json.query.sessionId || 'default' }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"userId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.userId || $json.query.userId || 'user' }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"email-trigger\",\n            \"name\": \"Email Processing Trigger\",\n            \"type\": \"n8n-nodes-base.manualTrigger\",\n            \"position\": [\n              280,\n              600\n            ],\n            \"parameters\": {},\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"get-emails\",\n            \"name\": \"Get Unprocessed Emails\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              500,\n              600\n            ],\n            \"parameters\": {\n              \"limit\": 15,\n              \"resource\": \"message\",\n              \"operation\": \"getAll\",\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"custom\": \"flag/flagStatus eq 'notFlagged' and not categories/any()\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"split-emails\",\n            \"name\": \"Process Each Email\",\n            \"type\": \"n8n-nodes-base.splitInBatches\",\n            \"position\": [\n              720,\n              600\n            ],\n            \"parameters\": {\n              \"batchSize\": 1,\n              \"options\": {}\n            },\n            \"typeVersion\": 3\n          },\n          {\n            \"id\": \"clean-content\",\n            \"name\": \"Clean Email Content\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n            \"position\": [\n              940,\n              600\n            ],\n            \"parameters\": {\n              \"modelId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"content\": \"Clean and extract key information from this email, removing HTML while preserving structure:\\n\\n{{ $json.body.content }}\"\n                  }\n                ]\n              },\n              \"operation\": \"text\"\n            },\n            \"typeVersion\": 1.8\n          },\n          {\n            \"id\": \"extract-metadata\",\n            \"name\": \"Extract Email Metadata\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              1160,\n              600\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"emailId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.id }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"subject\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.subject }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"sender\",\n                    \"type\": \"object\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.sender.emailAddress }}\"\n                  },\n                  {\n                    \"id\": \"4\",\n                    \"name\": \"cleanBody\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Clean Email Content').item.json.message.content }}\"\n                  },\n                  {\n                    \"id\": \"5\",\n                    \"name\": \"hasAttachments\",\n                    \"type\": \"boolean\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.hasAttachments }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"classify-email\",\n            \"name\": \"AI Email Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.textClassifier\",\n            \"position\": [\n              1380,\n              600\n            ],\n            \"parameters\": {\n              \"inputText\": \"{{ $json.cleanBody }}\",\n              \"categories\": {\n                \"categories\": [\n                  {\n                    \"category\": \"urgent_action\",\n                    \"description\": \"Emails requiring immediate attention: escalations, critical issues, deadlines, system failures\"\n                  },\n                  {\n                    \"category\": \"business_inquiry\",\n                    \"description\": \"Business opportunities: project inquiries, partnership requests, sales leads\"\n                  },\n                  {\n                    \"category\": \"support_request\",\n                    \"description\": \"Technical support: customer service, troubleshooting, help requests\"\n                  },\n                  {\n                    \"category\": \"billing_finance\",\n                    \"description\": \"Financial matters: invoices, payments, receipts, accounting\"\n                  },\n                  {\n                    \"category\": \"meeting_calendar\",\n                    \"description\": \"Scheduling: meeting requests, calendar invites, appointments\"\n                  },\n                  {\n                    \"category\": \"spam_junk\",\n                    \"description\": \"Unwanted content: spam, phishing, suspicious emails\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"route-category\",\n            \"name\": \"Email Category Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"position\": [\n              1600,\n              600\n            ],\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"outputKey\": \"urgent\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"urgent_action\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  },\n                  {\n                    \"outputKey\": \"business\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"business_inquiry\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  },\n                  {\n                    \"outputKey\": \"spam\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"spam_junk\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.2\n          },\n          {\n            \"id\": \"business-agent\",\n            \"name\": \"Business Inquiry Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              1820,\n              500\n            ],\n            \"parameters\": {\n              \"text\": \"Process this business inquiry:\\n\\nFrom: {{ $json.sender.name }} ({{ $json.sender.address }})\\nSubject: {{ $json.subject }}\\nContent: {{ $json.cleanBody }}\",\n              \"options\": {\n                \"systemMessage\": \"You are a professional business development assistant. For business inquiries:\\n1. Analyze the opportunity and requirements\\n2. Search knowledge base for relevant information\\n3. Create professional draft responses\\n4. Include relevant company capabilities\\n5. Suggest next steps\\n\\nUse the Create Draft tool to generate responses and Knowledge Search to find relevant context.\"\n              },\n              \"promptType\": \"define\"\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"move-spam\",\n            \"name\": \"Move Spam to Junk\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              1820,\n              700\n            ],\n            \"parameters\": {\n              \"folderId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"junk\"\n              },\n              \"messageId\": \"={{ $json.emailId }}\",\n              \"operation\": \"move\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"main-agent\",\n            \"name\": \"Main Email Assistant\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              720,\n              300\n            ],\n            \"parameters\": {\n              \"text\": \"{{ $json.userMessage }}\",\n              \"options\": {\n                \"systemMessage\": \"You are an intelligent email assistant with comprehensive capabilities:\\n\\n**EMAIL MANAGEMENT:**\\n- Search emails by sender, subject, content, or date\\n- Create and send professional responses\\n- Categorize and organize emails\\n- Handle attachments and extract information\\n\\n**CALENDAR FUNCTIONS:**\\n- Check availability and schedule meetings\\n- Manage calendar events and appointments\\n- Send meeting invitations\\n\\n**KNOWLEDGE & CONTEXT:**\\n- Search email history for past communications\\n- Access knowledge base for relevant information\\n- Provide context from previous interactions\\n\\n**COMMON COMMANDS:**\\n- 'Check emails from [sender]'\\n- 'Send email to [recipient] about [topic]'\\n- 'Schedule meeting with [person]'\\n- 'Show urgent emails'\\n- 'Create draft response'\\n- 'What meetings do I have today?'\\n- 'Search emails about [topic]'\\n\\nAlways confirm important actions before executing. Provide clear, actionable responses.\"\n              },\n              \"promptType\": \"define\"\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"create-draft-tool\",\n            \"name\": \"Create Draft Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              200\n            ],\n            \"parameters\": {\n              \"subject\": \"={{ $json.draft_subject || '' }}\",\n              \"resource\": \"draft\",\n              \"bodyContent\": \"={{ $json.draft_body || '' }}\",\n              \"additionalFields\": {\n                \"toRecipients\": \"={{ $json.draft_recipients || '' }}\"\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"send-email-tool\",\n            \"name\": \"Send Email Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              100\n            ],\n            \"parameters\": {\n              \"subject\": \"={{ $json.email_subject || '' }}\",\n              \"bodyContent\": \"={{ $json.email_body || '' }}\",\n              \"toRecipients\": \"={{ $json.email_recipients || '' }}\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"search-emails-tool\",\n            \"name\": \"Search Emails Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              400\n            ],\n            \"parameters\": {\n              \"limit\": 10,\n              \"operation\": \"getAll\",\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"search\": \"={{ $json.search_query || '' }}\",\n                    \"sender\": \"={{ $json.sender_filter || '' }}\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"knowledge-tool\",\n            \"name\": \"Knowledge Search Tool\",\n            \"type\": \"@n8n/n8n-nodes-langchain.vectorStorePGVector\",\n            \"position\": [\n              1160,\n              400\n            ],\n            \"parameters\": {\n              \"mode\": \"retrieve-as-tool\",\n              \"toolName\": \"knowledge_search\",\n              \"tableName\": \"email_knowledge\",\n              \"toolDescription\": \"Search email history and knowledge base for relevant context, past communications, and information\"\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"openai-model\",\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"position\": [\n              1160,\n              200\n            ],\n            \"parameters\": {\n              \"model\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"options\": {\n                \"temperature\": 0.3\n              }\n            },\n            \"typeVersion\": 1.2\n          },\n          {\n            \"id\": \"memory-buffer\",\n            \"name\": \"Memory Buffer\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              1160,\n              100\n            ],\n            \"parameters\": {\n              \"sessionKey\": \"={{ $json.sessionId }}\",\n              \"sessionIdType\": \"customKey\"\n            },\n            \"typeVersion\": 1.3\n          },\n          {\n            \"id\": \"format-response\",\n            \"name\": \"Format Response for WebUI\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              940,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"response\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.output }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $now.toISOString() }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Parse Chat Input').item.json.sessionId }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"send-response\",\n            \"name\": \"Send Response to WebUI\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"position\": [\n              1160,\n              300\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"responseHeaders\": {\n                  \"Content-Type\": \"application/json\"\n                }\n              }\n            },\n            \"typeVersion\": 1.1\n          },\n          {\n            \"id\": \"update-categories\",\n            \"name\": \"Update Email Categories\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              1820,\n              600\n            ],\n            \"parameters\": {\n              \"messageId\": \"={{ $json.emailId }}\",\n              \"operation\": \"update\",\n              \"updateFields\": {\n                \"categories\": [\n                  \"{{ $('AI Email Classifier').item.json.category }}\"\n                ]\n              }\n            },\n            \"typeVersion\": 2\n          }\n        ],\n        \"connections\": {\n          \"Open WebUI Chat Interface\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Parse Chat Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Parse Chat Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Main Email Assistant\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Processing Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Get Unprocessed Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Get Unprocessed Emails\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Each Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Each Email\": {\n            \"main\": [\n              [],\n              [\n                {\n                  \"node\": \"Clean Email Content\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Clean Email Content\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Extract Email Metadata\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Extract Email Metadata\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Email Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Email Classifier\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Category Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Category Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Update Email Categories\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Business Inquiry Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Move Spam to Junk\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Main Email Assistant\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Format Response for WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Format Response for WebUI\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Response to WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"ai_languageModel\": [\n              {\n                \"node\": \"Business Inquiry Agent\"\n              },\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Memory Buffer\": {\n            \"ai_memory\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Create Draft Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              },\n              {\n                \"node\": \"Business Inquiry Agent\"\n              }\n            ]\n          },\n          \"Send Email Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Search Emails Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Knowledge Search Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              },\n              {\n                \"node\": \"Business Inquiry Agent\"\n              }\n            ]\n          },\n          \"Business Inquiry Agent\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Update Email Categories\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"92ca09b1-e4a1-4148-a413-7c4b94a78f7e\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-24T05:37:35.508Z\",\n        \"updatedAt\": \"2025-11-24T05:37:35.508Z\",\n        \"id\": \"ZpvA8l39wQLCuoF3\",\n        \"name\": \"Ultimate Outlook AI Assistant - Open WebUI (FRESH BUILD)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"webui-webhook\",\n            \"name\": \"Open WebUI Chat Interface\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"position\": [\n              280,\n              300\n            ],\n            \"parameters\": {\n              \"httpMethod\": \"POST\",\n              \"path\": \"email-assistant\",\n              \"responseMode\": \"responseNode\",\n              \"options\": {}\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"parse-input\",\n            \"name\": \"Parse Chat Input\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              500,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"userMessage\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.message || $json.body.text || $json.query.message }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.sessionId || $json.query.sessionId || 'default' }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"userId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.userId || $json.query.userId || 'user' }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"email-trigger\",\n            \"name\": \"Email Processing Trigger\",\n            \"type\": \"n8n-nodes-base.manualTrigger\",\n            \"position\": [\n              280,\n              600\n            ],\n            \"parameters\": {},\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"get-emails\",\n            \"name\": \"Get Unprocessed Emails\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              500,\n              600\n            ],\n            \"parameters\": {\n              \"limit\": 15,\n              \"resource\": \"message\",\n              \"operation\": \"getAll\",\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"custom\": \"flag/flagStatus eq 'notFlagged' and not categories/any()\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"split-emails\",\n            \"name\": \"Process Each Email\",\n            \"type\": \"n8n-nodes-base.splitInBatches\",\n            \"position\": [\n              720,\n              600\n            ],\n            \"parameters\": {\n              \"batchSize\": 1,\n              \"options\": {}\n            },\n            \"typeVersion\": 3\n          },\n          {\n            \"id\": \"clean-content\",\n            \"name\": \"Clean Email Content\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n            \"position\": [\n              940,\n              600\n            ],\n            \"parameters\": {\n              \"modelId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"content\": \"Clean and extract key information from this email, removing HTML while preserving structure:\\n\\n{{ $json.body.content }}\"\n                  }\n                ]\n              },\n              \"operation\": \"text\"\n            },\n            \"typeVersion\": 1.8\n          },\n          {\n            \"id\": \"extract-metadata\",\n            \"name\": \"Extract Email Metadata\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              1160,\n              600\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"emailId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.id }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"subject\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.subject }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"sender\",\n                    \"type\": \"object\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.sender.emailAddress }}\"\n                  },\n                  {\n                    \"id\": \"4\",\n                    \"name\": \"cleanBody\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Clean Email Content').item.json.message.content }}\"\n                  },\n                  {\n                    \"id\": \"5\",\n                    \"name\": \"hasAttachments\",\n                    \"type\": \"boolean\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.hasAttachments }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"classify-email\",\n            \"name\": \"AI Email Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.textClassifier\",\n            \"position\": [\n              1380,\n              600\n            ],\n            \"parameters\": {\n              \"inputText\": \"{{ $json.cleanBody }}\",\n              \"categories\": {\n                \"categories\": [\n                  {\n                    \"category\": \"urgent_action\",\n                    \"description\": \"Emails requiring immediate attention: escalations, critical issues, deadlines, system failures\"\n                  },\n                  {\n                    \"category\": \"business_inquiry\",\n                    \"description\": \"Business opportunities: project inquiries, partnership requests, sales leads\"\n                  },\n                  {\n                    \"category\": \"support_request\",\n                    \"description\": \"Technical support: customer service, troubleshooting, help requests\"\n                  },\n                  {\n                    \"category\": \"billing_finance\",\n                    \"description\": \"Financial matters: invoices, payments, receipts, accounting\"\n                  },\n                  {\n                    \"category\": \"meeting_calendar\",\n                    \"description\": \"Scheduling: meeting requests, calendar invites, appointments\"\n                  },\n                  {\n                    \"category\": \"spam_junk\",\n                    \"description\": \"Unwanted content: spam, phishing, suspicious emails\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"route-category\",\n            \"name\": \"Email Category Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"position\": [\n              1600,\n              600\n            ],\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"outputKey\": \"urgent\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"urgent_action\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  },\n                  {\n                    \"outputKey\": \"business\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"business_inquiry\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  },\n                  {\n                    \"outputKey\": \"spam\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"spam_junk\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.2\n          },\n          {\n            \"id\": \"business-agent\",\n            \"name\": \"Business Inquiry Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              1820,\n              500\n            ],\n            \"parameters\": {\n              \"text\": \"Process this business inquiry:\\n\\nFrom: {{ $json.sender.name }} ({{ $json.sender.address }})\\nSubject: {{ $json.subject }}\\nContent: {{ $json.cleanBody }}\",\n              \"options\": {\n                \"systemMessage\": \"You are a professional business development assistant. For business inquiries:\\n1. Analyze the opportunity and requirements\\n2. Search knowledge base for relevant information\\n3. Create professional draft responses\\n4. Include relevant company capabilities\\n5. Suggest next steps\\n\\nUse the Create Draft tool to generate responses and Knowledge Search to find relevant context.\"\n              },\n              \"promptType\": \"define\"\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"move-spam\",\n            \"name\": \"Move Spam to Junk\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              1820,\n              700\n            ],\n            \"parameters\": {\n              \"folderId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"junk\"\n              },\n              \"messageId\": \"={{ $json.emailId }}\",\n              \"operation\": \"move\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"main-agent\",\n            \"name\": \"Main Email Assistant\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              720,\n              300\n            ],\n            \"parameters\": {\n              \"text\": \"{{ $json.userMessage }}\",\n              \"options\": {\n                \"systemMessage\": \"You are an intelligent email assistant with comprehensive capabilities:\\n\\n**EMAIL MANAGEMENT:**\\n- Search emails by sender, subject, content, or date\\n- Create and send professional responses\\n- Categorize and organize emails\\n- Handle attachments and extract information\\n\\n**CALENDAR FUNCTIONS:**\\n- Check availability and schedule meetings\\n- Manage calendar events and appointments\\n- Send meeting invitations\\n\\n**KNOWLEDGE & CONTEXT:**\\n- Search email history for past communications\\n- Access knowledge base for relevant information\\n- Provide context from previous interactions\\n\\n**COMMON COMMANDS:**\\n- 'Check emails from [sender]'\\n- 'Send email to [recipient] about [topic]'\\n- 'Schedule meeting with [person]'\\n- 'Show urgent emails'\\n- 'Create draft response'\\n- 'What meetings do I have today?'\\n- 'Search emails about [topic]'\\n\\nAlways confirm important actions before executing. Provide clear, actionable responses.\"\n              },\n              \"promptType\": \"define\"\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"create-draft-tool\",\n            \"name\": \"Create Draft Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              200\n            ],\n            \"parameters\": {\n              \"subject\": \"={{ $json.draft_subject || '' }}\",\n              \"resource\": \"draft\",\n              \"bodyContent\": \"={{ $json.draft_body || '' }}\",\n              \"additionalFields\": {\n                \"toRecipients\": \"={{ $json.draft_recipients || '' }}\"\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"send-email-tool\",\n            \"name\": \"Send Email Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              100\n            ],\n            \"parameters\": {\n              \"subject\": \"={{ $json.email_subject || '' }}\",\n              \"bodyContent\": \"={{ $json.email_body || '' }}\",\n              \"toRecipients\": \"={{ $json.email_recipients || '' }}\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"search-emails-tool\",\n            \"name\": \"Search Emails Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              400\n            ],\n            \"parameters\": {\n              \"limit\": 10,\n              \"operation\": \"getAll\",\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"search\": \"={{ $json.search_query || '' }}\",\n                    \"sender\": \"={{ $json.sender_filter || '' }}\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"knowledge-tool\",\n            \"name\": \"Knowledge Search Tool\",\n            \"type\": \"@n8n/n8n-nodes-langchain.vectorStorePGVector\",\n            \"position\": [\n              1160,\n              400\n            ],\n            \"parameters\": {\n              \"mode\": \"retrieve-as-tool\",\n              \"toolName\": \"knowledge_search\",\n              \"tableName\": \"email_knowledge\",\n              \"toolDescription\": \"Search email history and knowledge base for relevant context, past communications, and information\"\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"openai-model\",\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"position\": [\n              1160,\n              200\n            ],\n            \"parameters\": {\n              \"model\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"options\": {\n                \"temperature\": 0.3\n              }\n            },\n            \"typeVersion\": 1.2\n          },\n          {\n            \"id\": \"memory-buffer\",\n            \"name\": \"Memory Buffer\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              1160,\n              100\n            ],\n            \"parameters\": {\n              \"sessionKey\": \"={{ $json.sessionId }}\",\n              \"sessionIdType\": \"customKey\"\n            },\n            \"typeVersion\": 1.3\n          },\n          {\n            \"id\": \"format-response\",\n            \"name\": \"Format Response for WebUI\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              940,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"response\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.output }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $now.toISOString() }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Parse Chat Input').item.json.sessionId }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"send-response\",\n            \"name\": \"Send Response to WebUI\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"position\": [\n              1160,\n              300\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"responseHeaders\": {\n                  \"Content-Type\": \"application/json\"\n                }\n              }\n            },\n            \"typeVersion\": 1.1\n          },\n          {\n            \"id\": \"update-categories\",\n            \"name\": \"Update Email Categories\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              1820,\n              600\n            ],\n            \"parameters\": {\n              \"messageId\": \"={{ $json.emailId }}\",\n              \"operation\": \"update\",\n              \"updateFields\": {\n                \"categories\": [\n                  \"{{ $('AI Email Classifier').item.json.category }}\"\n                ]\n              }\n            },\n            \"typeVersion\": 2\n          }\n        ],\n        \"connections\": {\n          \"Open WebUI Chat Interface\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Parse Chat Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Parse Chat Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Main Email Assistant\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Processing Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Get Unprocessed Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Get Unprocessed Emails\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Each Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Each Email\": {\n            \"main\": [\n              [],\n              [\n                {\n                  \"node\": \"Clean Email Content\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Clean Email Content\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Extract Email Metadata\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Extract Email Metadata\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Email Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Email Classifier\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Category Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Category Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Update Email Categories\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Business Inquiry Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Move Spam to Junk\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Main Email Assistant\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Format Response for WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Format Response for WebUI\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Response to WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"ai_languageModel\": [\n              {\n                \"node\": \"Business Inquiry Agent\"\n              },\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Memory Buffer\": {\n            \"ai_memory\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Create Draft Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              },\n              {\n                \"node\": \"Business Inquiry Agent\"\n              }\n            ]\n          },\n          \"Send Email Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Search Emails Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Knowledge Search Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              },\n              {\n                \"node\": \"Business Inquiry Agent\"\n              }\n            ]\n          },\n          \"Business Inquiry Agent\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Update Email Categories\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"5eb173dd-d285-4cac-a509-2cea38732068\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-15T20:03:34.457Z\",\n        \"updatedAt\": \"2025-11-24T12:24:57.000Z\",\n        \"id\": \"a7aGwsrnXDcjf0jd\",\n        \"name\": \"üß† Ultimate AI Outlook Assistant - Enterprise Edition\",\n        \"active\": false,\n        \"isArchived\": true,\n        \"nodes\": [\n          {\n            \"id\": \"webhook_trigger\",\n            \"name\": \"API Webhook Entry\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"position\": [\n              250,\n              300\n            ],\n            \"parameters\": {\n              \"httpMethod\": \"POST\",\n              \"path\": \"ultimate-ai-assistant\",\n              \"responseMode\": \"responseNode\",\n              \"responseData\": \"allEntries\",\n              \"options\": {\n                \"responseHeaders\": {\n                  \"entries\": [\n                    {\n                      \"name\": \"Content-Type\",\n                      \"value\": \"application/json\"\n                    }\n                  ]\n                }\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"schedule_trigger\",\n            \"name\": \"Auto Email Check\",\n            \"type\": \"n8n-nodes-base.scheduleTrigger\",\n            \"position\": [\n              250,\n              500\n            ],\n            \"parameters\": {\n              \"rule\": {\n                \"interval\": [\n                  {\n                    \"field\": \"minutes\",\n                    \"value\": 5\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"smart_router\",\n            \"name\": \"Enhanced Request Router\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"position\": [\n              450,\n              400\n            ],\n            \"parameters\": {\n              \"functionCode\": \"// Ultimate AI Outlook Assistant - Enterprise Request Router\\nconst input = items[0].json;\\nconst timestamp = new Date().toISOString();\\n\\n// Enhanced routing logic combining your best workflows\\nconst routingData = {\\n  // Request classification from your Unified workflow\\n  requestType: input.message ? 'interactive_chat' : 'email_processing',\\n  priority: input.urgent ? 'high' : 'normal',\\n  \\n  // Security validation from your phishing analysis workflow\\n  security: {\\n    isValidRequest: true,\\n    riskLevel: 'low',\\n    requiresReview: false\\n  },\\n  \\n  // AI configuration from your RAG workflow\\n  aiConfig: {\\n    primaryModel: input.preferred_model || 'claude-3-5-sonnet-20241022',\\n    fallbackModel: 'gpt-4',\\n    embeddingModel: 'text-embedding-3-large',\\n    temperature: parseFloat(input.temperature) || 0.7,\\n    maxTokens: parseInt(input.max_tokens) || 2000,\\n    useRAG: input.use_rag !== false\\n  },\\n  \\n  // User context\\n  userContext: {\\n    userId: input.user_id || 'default',\\n    message: input.message || input.query || input.user_message || '',\\n    sessionId: input.session_id || `session_${Date.now()}`,\\n    preferences: input.preferences || {}\\n  },\\n  \\n  // Metadata for tracking\\n  metadata: {\\n    requestId: `req_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\\n    timestamp,\\n    source: input.source || 'api',\\n    version: '2.0-enterprise'\\n  },\\n  \\n  originalInput: input\\n};\\n\\nreturn [{ json: routingData }];\"\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"security_gate\",\n            \"name\": \"Security Validation\",\n            \"type\": \"n8n-nodes-base.if\",\n            \"position\": [\n              650,\n              400\n            ],\n            \"parameters\": {\n              \"conditions\": {\n                \"boolean\": [\n                  {\n                    \"value1\": \"={{ $json.security.isValidRequest }}\",\n                    \"value2\": true\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"request_dispatcher\",\n            \"name\": \"Request Type Router\",\n            \"type\": \"n8n-nodes-base.if\",\n            \"position\": [\n              850,\n              400\n            ],\n            \"parameters\": {\n              \"conditions\": {\n                \"string\": [\n                  {\n                    \"value1\": \"={{ $json.requestType }}\",\n                    \"value2\": \"interactive_chat\",\n                    \"operation\": \"equal\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"outlook_fetcher\",\n            \"name\": \"Smart Outlook Fetcher\",\n            \"type\": \"n8n-nodes-base.httpRequest\",\n            \"position\": [\n              1050,\n              500\n            ],\n            \"parameters\": {\n              \"url\": \"https://graph.microsoft.com/v1.0/me/mailfolders/inbox/messages\",\n              \"method\": \"GET\",\n              \"qs\": {\n                \"$top\": \"20\",\n                \"$filter\": \"isRead eq false\",\n                \"$select\": \"id,subject,body,from,to,receivedDateTime,hasAttachments,importance\"\n              },\n              \"authentication\": \"predefinedCredential\",\n              \"nodeCredentialType\": \"microsoftGraphApi\",\n              \"options\": {\n                \"timeout\": 30000\n              }\n            },\n            \"typeVersion\": 5\n          },\n          {\n            \"id\": \"email_processor\",\n            \"name\": \"AI Email Intelligence\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"position\": [\n              1250,\n              500\n            ],\n            \"parameters\": {\n              \"functionCode\": \"// Enhanced email processing combining all your workflow insights\\nconst emails = items[0].json.value || [];\\nconst processedEmails = [];\\n\\nfor (const email of emails) {\\n  // Content extraction and cleaning\\n  const content = {\\n    id: email.id,\\n    subject: email.subject || 'No Subject',\\n    body: email.body?.content || email.bodyPreview || '',\\n    sender: email.from?.emailAddress?.address || '',\\n    senderName: email.from?.emailAddress?.name || '',\\n    receivedDateTime: email.receivedDateTime,\\n    importance: email.importance || 'normal'\\n  };\\n  \\n  // Security analysis from your phishing workflow\\n  const securityMetrics = {\\n    phishingScore: 0,\\n    spamScore: 0,\\n    trustScore: 1.0,\\n    riskFactors: []\\n  };\\n  \\n  // Phishing detection patterns\\n  const phishingIndicators = [\\n    /urgent.*action.*required/i,\\n    /verify.*account/i,\\n    /suspended.*account/i,\\n    /click.*here.*immediately/i\\n  ];\\n  \\n  const fullText = content.subject + ' ' + content.body;\\n  phishingIndicators.forEach(pattern => {\\n    if (pattern.test(fullText)) {\\n      securityMetrics.phishingScore += 0.25;\\n      securityMetrics.riskFactors.push('phishing_pattern');\\n    }\\n  });\\n  \\n  // Auto-categorization logic\\n  let category = 'general';\\n  if (/meeting|project|deadline|report/i.test(fullText)) category = 'business';\\n  if (/family|friend|personal/i.test(fullText)) category = 'personal';\\n  if (/urgent|asap|immediately/i.test(fullText)) category = 'urgent';\\n  if (securityMetrics.phishingScore > 0.3) category = 'suspicious';\\n  \\n  // Tone analysis\\n  const toneMetrics = {\\n    formalityScore: /please|thank you|sincerely|regards/i.test(fullText) ? 0.8 : 0.4,\\n    urgencyLevel: /urgent|asap|deadline/i.test(fullText) ? 0.8 : 0.2,\\n    emotionalTone: /great|excellent|love/i.test(fullText) ? 'positive' : \\n                   /problem|issue|concerned/i.test(fullText) ? 'negative' : 'neutral'\\n  };\\n  \\n  processedEmails.push({\\n    json: {\\n      ...content,\\n      category,\\n      security: securityMetrics,\\n      toneAnalysis: toneMetrics,\\n      processingTimestamp: new Date().toISOString(),\\n      needsReview: securityMetrics.phishingScore > 0.25\\n    }\\n  });\\n}\\n\\nreturn processedEmails;\"\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"ai_chat_handler\",\n            \"name\": \"RAG-Enhanced Chat\",\n            \"type\": \"n8n-nodes-base.httpRequest\",\n            \"position\": [\n              1050,\n              300\n            ],\n            \"parameters\": {\n              \"url\": \"https://api.anthropic.com/v1/messages\",\n              \"method\": \"POST\",\n              \"sendBody\": true,\n              \"bodyContentType\": \"json\",\n              \"jsonBody\": \"{\\n  \\\"model\\\": \\\"{{ $json.aiConfig.primaryModel }}\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"system\\\",\\n      \\\"content\\\": \\\"You are an advanced AI email assistant with RAG capabilities. You can search emails, analyze patterns, draft responses, and provide intelligent insights. Current time: {{ $now.format('yyyy-MM-dd HH:mm:ss') }}\\\"\\n    },\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"{{ $json.userContext.message }}\\\"\\n    }\\n  ],\\n  \\\"max_tokens\\\": {{ $json.aiConfig.maxTokens }},\\n  \\\"temperature\\\": {{ $json.aiConfig.temperature }}\\n}\",\n              \"options\": {\n                \"headers\": {\n                  \"Content-Type\": \"application/json\",\n                  \"Authorization\": \"Bearer {{ $credentials.anthropicApi.apiKey }}\",\n                  \"anthropic-version\": \"2023-06-01\"\n                }\n              }\n            },\n            \"typeVersion\": 5\n          },\n          {\n            \"id\": \"smart_reply_generator\",\n            \"name\": \"Context-Aware Reply Generator\",\n            \"type\": \"n8n-nodes-base.httpRequest\",\n            \"position\": [\n              1450,\n              500\n            ],\n            \"parameters\": {\n              \"url\": \"https://api.anthropic.com/v1/messages\",\n              \"method\": \"POST\",\n              \"sendBody\": true,\n              \"bodyContentType\": \"json\",\n              \"jsonBody\": \"{\\n  \\\"model\\\": \\\"claude-3-5-sonnet-20241022\\\",\\n  \\\"messages\\\": [\\n    {\\n      \\\"role\\\": \\\"system\\\",\\n      \\\"content\\\": \\\"Generate professional email responses that match the sender's tone and context. Consider: email category, security analysis, urgency level, and sender relationship. Provide 3 options: Brief, Standard, Detailed.\\\"\\n    },\\n    {\\n      \\\"role\\\": \\\"user\\\",\\n      \\\"content\\\": \\\"Generate responses for:\\\\n\\\\nEmail: {{ $json.subject }}\\\\nFrom: {{ $json.sender }}\\\\nCategory: {{ $json.category }}\\\\nTone: {{ $json.toneAnalysis.emotionalTone }}\\\\nUrgency: {{ $json.toneAnalysis.urgencyLevel }}\\\\nSecurity Score: {{ $json.security.trustScore }}\\\"\\n    }\\n  ],\\n  \\\"max_tokens\\\": 1000,\\n  \\\"temperature\\\": 0.7\\n}\",\n              \"options\": {\n                \"headers\": {\n                  \"Content-Type\": \"application/json\",\n                  \"Authorization\": \"Bearer {{ $credentials.anthropicApi.apiKey }}\",\n                  \"anthropic-version\": \"2023-06-01\"\n                }\n              }\n            },\n            \"typeVersion\": 5\n          },\n          {\n            \"id\": \"response_formatter\",\n            \"name\": \"Enterprise Response Formatter\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"position\": [\n              1650,\n              400\n            ],\n            \"parameters\": {\n              \"functionCode\": \"// Enterprise response formatting for API and internal use\\nconst results = items;\\nconst timestamp = new Date().toISOString();\\n\\n// Compile processing statistics\\nconst stats = {\\n  emailsProcessed: 0,\\n  categoriesDetected: new Set(),\\n  securityAlertsGenerated: 0,\\n  responsesGenerated: 0,\\n  processingTimeMs: Date.now() - new Date(results[0]?.json?.metadata?.timestamp || timestamp).getTime()\\n};\\n\\n// Process results\\nconst processedResults = results.map(item => {\\n  const data = item.json;\\n  \\n  // Update statistics\\n  if (data.id) stats.emailsProcessed++;\\n  if (data.category) stats.categoriesDetected.add(data.category);\\n  if (data.security?.phishingScore > 0.25) stats.securityAlertsGenerated++;\\n  if (data.content?.[0]?.text) stats.responsesGenerated++;\\n  \\n  return {\\n    type: data.routing?.requestType || 'email_processing',\\n    emailId: data.id,\\n    subject: data.subject,\\n    category: data.category,\\n    securityScore: data.security?.trustScore || 1.0,\\n    toneAnalysis: data.toneAnalysis,\\n    aiResponse: data.content?.[0]?.text || data.choices?.[0]?.message?.content,\\n    needsReview: data.needsReview || false,\\n    timestamp: data.processingTimestamp || timestamp\\n  };\\n});\\n\\n// Final API response structure\\nconst apiResponse = {\\n  status: 'success',\\n  version: '2.0-enterprise',\\n  timestamp,\\n  summary: {\\n    ...stats,\\n    categoriesDetected: Array.from(stats.categoriesDetected)\\n  },\\n  results: processedResults,\\n  recommendations: [],\\n  meta: {\\n    workflowId: 'ultimate-ai-outlook-assistant',\\n    aiModelsUsed: ['claude-3-5-sonnet-20241022'],\\n    featuresEnabled: ['security_analysis', 'tone_detection', 'auto_categorization', 'smart_replies']\\n  }\\n};\\n\\n// Add intelligent recommendations\\nif (stats.securityAlertsGenerated > 0) {\\n  apiResponse.recommendations.push({\\n    type: 'security',\\n    message: `${stats.securityAlertsGenerated} emails flagged for security review`,\\n    action: 'review_suspicious_emails'\\n  });\\n}\\n\\nif (stats.emailsProcessed > 15) {\\n  apiResponse.recommendations.push({\\n    type: 'productivity',\\n    message: 'High email volume detected. Consider auto-response rules.',\\n    action: 'setup_auto_responses'\\n  });\\n}\\n\\nreturn [{ json: apiResponse }];\"\n            },\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"webhook_trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"smart_router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"schedule_trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"smart_router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"smart_router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"security_gate\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"security_gate\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"request_dispatcher\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              []\n            ]\n          },\n          \"request_dispatcher\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"ai_chat_handler\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"outlook_fetcher\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"outlook_fetcher\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"email_processor\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"email_processor\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"smart_reply_generator\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"ai_chat_handler\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"response_formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"smart_reply_generator\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"response_formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {\n          \"node:Auto Email Check\": {\n            \"recurrenceRules\": []\n          }\n        },\n        \"meta\": null,\n        \"versionId\": \"4f4bea20-f1ed-4576-bfd9-9551f099a160\",\n        \"triggerCount\": 2,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-16T01:17:34.062Z\",\n        \"updatedAt\": \"2025-06-16T17:02:40.000Z\",\n        \"id\": \"dX83GG6FMux9Jh5f\",\n        \"name\": \"Nodes\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"parameters\": {},\n            \"type\": \"n8n-nodes-base.manualTrigger\",\n            \"typeVersion\": 1,\n            \"position\": [\n              0,\n              0\n            ],\n            \"id\": \"cf2eb9d4-3622-4d9e-b4fb-d80aa73c1b57\",\n            \"name\": \"When clicking ‚ÄòExecute workflow‚Äô\"\n          },\n          {\n            \"parameters\": {\n              \"options\": {}\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.chatTrigger\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              220,\n              0\n            ],\n            \"id\": \"7ad63a45-d32c-494f-92d2-5e76cfbd2258\",\n            \"name\": \"When chat message received\",\n            \"webhookId\": \"93f2a2a3-071c-4eac-b8a4-ae32a9ab7c5c\"\n          },\n          {\n            \"parameters\": {\n              \"options\": {}\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"typeVersion\": 2,\n            \"position\": [\n              440,\n              0\n            ],\n            \"id\": \"0847dde1-dba1-4b1b-b2e4-0f7d3d2db006\",\n            \"name\": \"AI Agent\"\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"calendar\",\n              \"operation\": \"delete\",\n              \"calendarId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              700,\n              260\n            ],\n            \"id\": \"3f5581d6-4fe8-446f-ac29-9e401686e057\",\n            \"name\": \"Microsoft Outlook\",\n            \"webhookId\": \"ce7fa0c2-803a-4ec3-a2eb-bde0abcd67a1\"\n          },\n          {\n            \"parameters\": {\n              \"additionalFields\": {}\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1580,\n              60\n            ],\n            \"id\": \"d7e9071d-9a64-4fd4-8cea-8929ecbdadf8\",\n            \"name\": \"Microsoft Outlook1\",\n            \"webhookId\": \"5df8cf7c-596d-4136-9dcc-93ffb3edfcda\",\n            \"alwaysOutputData\": true,\n            \"executeOnce\": true,\n            \"retryOnFail\": true,\n            \"notesInFlow\": true\n          },\n          {\n            \"parameters\": {},\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"typeVersion\": 1.3,\n            \"position\": [\n              540,\n              220\n            ],\n            \"id\": \"82d4a1a3-1444-424e-bb48-b7d1eca9a32a\",\n            \"name\": \"Simple Memory\"\n          },\n          {\n            \"parameters\": {\n              \"options\": {}\n            },\n            \"type\": \"n8n-nodes-base.httpRequestTool\",\n            \"typeVersion\": 4.2,\n            \"position\": [\n              800,\n              220\n            ],\n            \"id\": \"e4171ccc-ec21-4a79-b0d8-44401352d163\",\n            \"name\": \"HTTP Request\"\n          }\n        ],\n        \"connections\": {\n          \"When clicking ‚ÄòExecute workflow‚Äô\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"When chat message received\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent\": {\n            \"main\": [\n              []\n            ]\n          },\n          \"Simple Memory\": {\n            \"ai_memory\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"ai_memory\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"HTTP Request\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"AI Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\"\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"1f858670-69bc-43dd-8b40-8eac008167e8\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-22T12:51:45.308Z\",\n        \"updatedAt\": \"2025-11-22T12:51:45.308Z\",\n        \"id\": \"diTsKcUQfLaZbMQy\",\n        \"name\": \"Teams-Outlook RAG Assistant (Agent Generated)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              0\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"ea3b040e-d6ec-435d-b852-081cb124dc04\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              0\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body and metadata\\nreturn items;\"\n            },\n            \"id\": \"b5bed161-9bef-447c-8ca1-7243e60e8ff8\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              -150\n            ],\n            \"parameters\": {\n              \"mode\": \"text\"\n            },\n            \"id\": \"11c13cb3-5a0f-4cbd-af34-19427c847edf\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"97910110-86bc-4db0-a675-3ac21065fe82\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"934acccc-9be6-4bef-babd-5c9e193b38c9\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              400\n            ],\n            \"parameters\": {},\n            \"id\": \"be8efe89-6958-4aa2-883a-b17c5cbf00e3\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Format teams message for AI\\nreturn items;\"\n            },\n            \"id\": \"3e491feb-20f7-4b6f-853c-4af6674e72c1\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"systemMessage\": \"You are a helpful Outlook & Teams assistant.\"\n              }\n            },\n            \"id\": \"58023a7a-7dec-4585-8180-4c513e4a7849\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              800,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"4ba145f3-700d-4309-a297-3115cf27d12f\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Postgres Memory\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"position\": [\n              400,\n              600\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\"\n            },\n            \"id\": \"9430c61e-7fc8-43e9-bc4d-ed57e6473ceb\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Search Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              500,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"e4c23273-7b83-475e-ba13-a48d21898a24\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Get Calendar Events\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              650,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"75c089d1-9940-4f69-87c6-b95f2be63f80\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Calendar Event\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              800,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"67ceecde-7f9d-49f0-88ff-202402f0660c\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              950,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"72e387e3-7b50-453b-b9fa-06b8458514ce\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              1100,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"send\"\n            },\n            \"id\": \"9e1d266e-9079-4811-ba8f-efcf54cccc1b\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAiChatModel\",\n            \"position\": [\n              200,\n              400\n            ],\n            \"parameters\": {\n              \"model\": \"gpt-4o\"\n            },\n            \"id\": \"5124b1be-ea59-467f-9c6d-69cc0982a2e2\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Window Buffer Memory\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              200,\n              550\n            ],\n            \"parameters\": {},\n            \"id\": \"9939e3fb-4afc-4801-bd65-44e903c2b2c5\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Postgres Memory\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Search Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Get Calendar Events\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Calendar Event\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Send Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Window Buffer Memory\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"d4a0661e-32cf-4e1e-b299-2e032b978791\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-15T23:25:13.098Z\",\n        \"updatedAt\": \"2025-11-24T12:24:49.000Z\",\n        \"id\": \"eXaLatLLaJ3FyJej\",\n        \"name\": \"üì® Gmail AI Assistant - Working Version\",\n        \"active\": false,\n        \"isArchived\": true,\n        \"nodes\": [\n          {\n            \"name\": \"Manual Trigger\",\n            \"type\": \"n8n-nodes-base.manualTrigger\",\n            \"position\": [\n              250,\n              300\n            ],\n            \"parameters\": {},\n            \"id\": \"f961f642-76af-4c30-9340-17808c4a42ed\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fetch Gmail Emails\",\n            \"type\": \"n8n-nodes-base.gmail\",\n            \"position\": [\n              450,\n              300\n            ],\n            \"parameters\": {\n              \"operation\": \"getAll\",\n              \"returnAll\": false,\n              \"limit\": 10,\n              \"filters\": {\n                \"labelIds\": [\n                  \"INBOX\"\n                ],\n                \"q\": \"is:unread\"\n              }\n            },\n            \"id\": \"93d0b76e-bf12-4d21-acdf-6a7460edc82b\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Email Intelligence Processor\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"position\": [\n              650,\n              300\n            ],\n            \"parameters\": {\n              \"functionCode\": \"// Gmail Email Intelligence with Advanced Analysis\\nconst emails = items;\\nconst processedEmails = [];\\n\\nfor (const item of emails) {\\n  const email = item.json;\\n  \\n  // Gmail-specific data extraction\\n  const emailData = {\\n    id: email.id || 'unknown',\\n    threadId: email.threadId || null,\\n    subject: email.payload?.headers?.find(h => h.name === 'Subject')?.value || 'No Subject',\\n    sender: email.payload?.headers?.find(h => h.name === 'From')?.value || 'Unknown Sender',\\n    date: email.payload?.headers?.find(h => h.name === 'Date')?.value || new Date().toISOString(),\\n    snippet: email.snippet || 'No preview available',\\n    labelIds: email.labelIds || [],\\n    sizeEstimate: email.sizeEstimate || 0\\n  };\\n  \\n  // Extract sender email and name\\n  const senderMatch = emailData.sender.match(/(.*?)\\\\s*<(.+@.+)>/) || [null, emailData.sender, emailData.sender];\\n  const senderName = senderMatch[1]?.trim() || emailData.sender;\\n  const senderEmail = senderMatch[2]?.trim() || emailData.sender;\\n  \\n  // Advanced content analysis\\n  const fullContent = (emailData.subject + ' ' + emailData.snippet).toLowerCase();\\n  \\n  // Smart categorization with confidence scores\\n  const categories = {\\n    meeting: /meeting|schedule|calendar|appointment|zoom|teams/i.test(fullContent),\\n    work: /project|task|deadline|report|deliverable|proposal/i.test(fullContent),\\n    finance: /invoice|payment|bill|receipt|bank|transaction/i.test(fullContent),\\n    urgent: /urgent|asap|immediate|critical|emergency/i.test(fullContent),\\n    marketing: /newsletter|promotion|sale|discount|unsubscribe/i.test(fullContent),\\n    personal: /family|friend|birthday|vacation|personal/i.test(fullContent)\\n  };\\n  \\n  // Determine primary category\\n  let primaryCategory = 'general';\\n  let categoryConfidence = 0;\\n  \\n  Object.entries(categories).forEach(([cat, match]) => {\\n    if (match) {\\n      primaryCategory = cat;\\n      categoryConfidence = 0.8; // High confidence for keyword matches\\n    }\\n  });\\n  \\n  // Security analysis\\n  const securityAnalysis = {\\n    phishingIndicators: [],\\n    riskLevel: 'low',\\n    trustScore: 1.0\\n  };\\n  \\n  // Phishing pattern detection\\n  const phishingPatterns = {\\n    'account_verification': /verify.*account|confirm.*identity/i,\\n    'urgent_action': /urgent.*action.*required|immediate.*response/i,\\n    'suspicious_links': /click.*here.*now|update.*immediately/i,\\n    'account_suspension': /account.*suspended|access.*restricted/i\\n  };\\n  \\n  Object.entries(phishingPatterns).forEach(([pattern, regex]) => {\\n    if (regex.test(fullContent)) {\\n      securityAnalysis.phishingIndicators.push(pattern);\\n      securityAnalysis.trustScore -= 0.3;\\n    }\\n  });\\n  \\n  // Domain analysis\\n  const domain = senderEmail.split('@')[1]?.toLowerCase() || '';\\n  const trustedDomains = ['gmail.com', 'google.com', 'microsoft.com', 'office.com'];\\n  \\n  if (!trustedDomains.includes(domain)) {\\n    securityAnalysis.trustScore -= 0.1;\\n  }\\n  \\n  // Risk level calculation\\n  if (securityAnalysis.trustScore < 0.5) {\\n    securityAnalysis.riskLevel = 'high';\\n    primaryCategory = 'suspicious';\\n  } else if (securityAnalysis.trustScore < 0.7) {\\n    securityAnalysis.riskLevel = 'medium';\\n  }\\n  \\n  // Priority scoring\\n  let priority = 'normal';\\n  if (categories.urgent || securityAnalysis.riskLevel === 'high') {\\n    priority = 'high';\\n  } else if (categories.work || categories.finance) {\\n    priority = 'medium';\\n  }\\n  \\n  // Compile processed email with all analysis\\n  processedEmails.push({\\n    json: {\\n      // Core email data\\n      ...emailData,\\n      senderName,\\n      senderEmail,\\n      domain,\\n      \\n      // Analysis results\\n      category: primaryCategory,\\n      categoryConfidence,\\n      priority,\\n      security: securityAnalysis,\\n      \\n      // Processing metadata\\n      processed: true,\\n      processingTimestamp: new Date().toISOString(),\\n      \\n      // AI analysis prompt\\n      aiPrompt: `Email Analysis Request:\\n      \\nFrom: ${senderName} <${senderEmail}>\\nSubject: ${emailData.subject}\\nCategory: ${primaryCategory} (${Math.round(categoryConfidence * 100)}% confidence)\\nPriority: ${priority}\\nSecurity Risk: ${securityAnalysis.riskLevel}\\nTrust Score: ${securityAnalysis.trustScore.toFixed(2)}\\n      \\nContent Preview:\\n${emailData.snippet}\\n      \\nPlease provide actionable insights for this email.`\\n    }\\n  });\\n}\\n\\nreturn processedEmails;\"\n            },\n            \"id\": \"70ba0595-e49d-411f-b152-f4d44e0c9298\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Analysis Engine\",\n            \"type\": \"n8n-nodes-base.openai\",\n            \"position\": [\n              850,\n              300\n            ],\n            \"parameters\": {\n              \"operation\": \"chat\",\n              \"model\": \"gpt-4o-mini\",\n              \"messages\": [\n                {\n                  \"role\": \"system\",\n                  \"content\": \"You are an expert email assistant providing actionable insights. For each email, analyze and provide:\\n\\n**PRIORITY ASSESSMENT** (Critical/High/Medium/Low)\\n**ACTION REQUIRED** (Reply Now/Schedule Reply/Review/Archive/Flag Security)\\n**KEY INSIGHTS** (One sentence summary of main points)\\n**RESPONSE STRATEGY** (If reply needed: tone, key points to address)\\n**TIME ESTIMATE** (How long to properly handle this email)\\n\\nBe direct, practical, and focus on helping users process emails efficiently.\"\n                },\n                {\n                  \"role\": \"user\",\n                  \"content\": \"{{ $json.aiPrompt }}\"\n                }\n              ],\n              \"options\": {\n                \"maxTokens\": 350,\n                \"temperature\": 0.2\n              }\n            },\n            \"id\": \"413e4132-9346-4e43-8b51-56cbe17db6fa\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Final Output Formatter\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              1050,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"name\": \"emailId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.id }}\"\n                  },\n                  {\n                    \"name\": \"threadId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.threadId }}\"\n                  },\n                  {\n                    \"name\": \"subject\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.subject }}\"\n                  },\n                  {\n                    \"name\": \"senderName\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.senderName }}\"\n                  },\n                  {\n                    \"name\": \"senderEmail\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.senderEmail }}\"\n                  },\n                  {\n                    \"name\": \"category\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.category }}\"\n                  },\n                  {\n                    \"name\": \"priority\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.priority }}\"\n                  },\n                  {\n                    \"name\": \"securityRisk\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.security.riskLevel }}\"\n                  },\n                  {\n                    \"name\": \"trustScore\",\n                    \"type\": \"number\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.security.trustScore }}\"\n                  },\n                  {\n                    \"name\": \"aiRecommendations\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.choices[0].message.content }}\"\n                  },\n                  {\n                    \"name\": \"snippet\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.snippet }}\"\n                  },\n                  {\n                    \"name\": \"processedAt\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $now.toISO() }}\"\n                  },\n                  {\n                    \"name\": \"needsSecurityReview\",\n                    \"type\": \"boolean\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.security.riskLevel !== 'low' }}\"\n                  },\n                  {\n                    \"name\": \"estimatedImportance\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Email Intelligence Processor').item.json.priority === 'high' ? 'Very Important' : $('Email Intelligence Processor').item.json.priority === 'medium' ? 'Moderately Important' : 'Standard' }}\"\n                  }\n                ]\n              }\n            },\n            \"id\": \"02cb7f0d-ef88-48ef-926d-068ca3b60e92\",\n            \"typeVersion\": 3\n          }\n        ],\n        \"connections\": {\n          \"Manual Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fetch Gmail Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Fetch Gmail Emails\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Intelligence Processor\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Intelligence Processor\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Analysis Engine\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Analysis Engine\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Final Output Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"0093d9c8-74ff-4f82-8cc4-c7d7bfd2aa0b\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-19T16:20:03.601Z\",\n        \"updatedAt\": \"2025-06-19T16:26:47.000Z\",\n        \"id\": \"hZY4DTn9n4sfcg9f\",\n        \"name\": \"Attachment Handler Workflow\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"parameters\": {},\n            \"id\": \"f7b5c5af-c822-4506-80c1-bb503a477aef\",\n            \"name\": \"Workflow Trigger\",\n            \"type\": \"n8n-nodes-base.executeWorkflowTrigger\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -1340,\n              120\n            ]\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"messageAttachment\",\n              \"operation\": \"getAll\",\n              \"messageId\": \"={{ $json.messageId }}\",\n              \"options\": {}\n            },\n            \"id\": \"c31b0513-19f1-4b3d-bcff-23ad2d13e7fd\",\n            \"name\": \"Get Email Attachments\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -1140,\n              120\n            ],\n            \"webhookId\": \"34d411ea-74b2-4b8c-964b-3bac0e95a43a\"\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"messageAttachment\",\n              \"operation\": \"download\",\n              \"messageId\": \"={{ $('Workflow Trigger').item.json.messageId }}\",\n              \"attachmentId\": \"={{ $json.id }}\"\n            },\n            \"id\": \"83a0a90d-91cc-41d8-9efb-00ab969ed8a6\",\n            \"name\": \"Download Attachment\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -940,\n              120\n            ],\n            \"webhookId\": \"50287946-1180-430a-85c9-2841a6acc354\"\n          },\n          {\n            \"parameters\": {\n              \"jsCode\": \"// File type detection and validation\\nconst attachment = $input.first();\\nconst binary = attachment.binary.data;\\nconst fileName = binary.fileName || 'unknown';\\nconst mimeType = binary.mimeType || 'application/octet-stream';\\nconst fileSize = Buffer.from(binary.data, 'base64').length;\\n\\n// Define supported file types\\nconst supportedTypes = {\\n  'application/pdf': 'pdf',\\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document': 'docx',\\n  'application/vnd.ms-excel': 'xls',\\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': 'xlsx',\\n  'text/csv': 'csv',\\n  'image/jpeg': 'image',\\n  'image/png': 'image',\\n  'image/gif': 'image',\\n  'text/plain': 'text'\\n};\\n\\nconst fileType = supportedTypes[mimeType] || 'unknown';\\nconst isSupported = fileType !== 'unknown';\\n\\nreturn [{\\n  json: {\\n    fileName,\\n    mimeType,\\n    fileType,\\n    fileSize,\\n    isSupported,\\n    attachmentId: attachment.json.id,\\n    messageId: $('Workflow Trigger').item.json.messageId\\n  },\\n  binary: attachment.binary\\n}];\"\n            },\n            \"id\": \"eebf6633-822b-4e0d-8725-5db9bf8ab2a7\",\n            \"name\": \"Analyze Attachment\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -740,\n              120\n            ]\n          },\n          {\n            \"parameters\": {\n              \"conditions\": {\n                \"boolean\": [\n                  {\n                    \"value1\": \"={{ $json.isSupported }}\",\n                    \"value2\": true\n                  }\n                ]\n              },\n              \"options\": {}\n            },\n            \"id\": \"c875a1c9-96bb-406e-b9bd-623900f20037\",\n            \"name\": \"Check Supported Type\",\n            \"type\": \"n8n-nodes-base.if\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -540,\n              120\n            ]\n          },\n          {\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $json.fileType }}\",\n                          \"rightValue\": \"pdf\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"pdf_processing\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $json.fileType }}\",\n                          \"rightValue\": \"docx\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"docx_processing\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"conditions\": [\n                        {\n                          \"leftValue\": \"={{ $json.fileType }}\",\n                          \"rightValue\": \"image\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"image_processing\"\n                  }\n                ]\n              },\n              \"options\": {}\n            },\n            \"id\": \"b860ffb5-cff4-418e-85a6-441c0b56a849\",\n            \"name\": \"File Type Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"typeVersion\": 3,\n            \"position\": [\n              -340,\n              120\n            ]\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"extractFromPDF\"\n            },\n            \"id\": \"5af069bb-ffa8-4b6f-b90b-04301a8865a8\",\n            \"name\": \"Extract PDF Content\",\n            \"type\": \"n8n-nodes-base.extractFromFile\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -140,\n              20\n            ]\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"extractFromDocx\"\n            },\n            \"id\": \"de53c832-ff8d-4614-a445-ce0317c8fd0b\",\n            \"name\": \"Extract DOCX Content\",\n            \"type\": \"n8n-nodes-base.extractFromFile\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -140,\n              120\n            ]\n          },\n          {\n            \"parameters\": {\n              \"method\": \"POST\",\n              \"url\": \"https://api.openai.com/v1/chat/completions\",\n              \"authentication\": \"predefinedCredentialType\",\n              \"nodeCredentialType\": \"openAiApi\",\n              \"sendHeaders\": true,\n              \"headerParameters\": {\n                \"parameters\": [\n                  {\n                    \"name\": \"Content-Type\",\n                    \"value\": \"application/json\"\n                  }\n                ]\n              },\n              \"sendBody\": true,\n              \"bodyParameters\": {\n                \"parameters\": [\n                  {\n                    \"name\": \"model\",\n                    \"value\": \"gpt-4o\"\n                  },\n                  {\n                    \"name\": \"messages\",\n                    \"value\": \"=[{\\\"role\\\": \\\"user\\\", \\\"content\\\": [{\\\"type\\\": \\\"text\\\", \\\"text\\\": \\\"Analyze this image and extract any text or relevant information.\\\"}, {\\\"type\\\": \\\"image_url\\\", \\\"image_url\\\": {\\\"url\\\": \\\"data:{{ $binary.data.mimeType }};base64,{{ $binary.data.data }}\\\"}}]}]\"\n                  },\n                  {\n                    \"name\": \"max_tokens\",\n                    \"value\": \"1000\"\n                  }\n                ]\n              },\n              \"options\": {}\n            },\n            \"id\": \"e9a65bfb-8e1f-4bfb-85d7-23ab6860c309\",\n            \"name\": \"Analyze Image with Vision\",\n            \"type\": \"n8n-nodes-base.httpRequest\",\n            \"typeVersion\": 4.2,\n            \"position\": [\n              -140,\n              220\n            ]\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"upload\",\n              \"bucketName\": \"email-attachments\",\n              \"fileName\": \"={{ $json.messageId }}/{{ $json.fileName }}\",\n              \"additionalFields\": {}\n            },\n            \"id\": \"4a452db6-58d2-4417-9a52-ebd3286e5d6d\",\n            \"name\": \"Store Attachment in S3\",\n            \"type\": \"n8n-nodes-base.awsS3\",\n            \"typeVersion\": 1,\n            \"position\": [\n              60,\n              120\n            ]\n          },\n          {\n            \"parameters\": {\n              \"schema\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"public\"\n              },\n              \"table\": \"attachments\",\n              \"columns\": \"message_id,attachment_id,filename,mimetype,filesize,filetype,extracted_content,s3_url,processed_at\",\n              \"options\": {}\n            },\n            \"id\": \"2ceb3e7e-adeb-4835-b8b9-c50783575f22\",\n            \"name\": \"Store Attachment Metadata\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"typeVersion\": 2.4,\n            \"position\": [\n              260,\n              120\n            ]\n          }\n        ],\n        \"connections\": {\n          \"Workflow Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Get Email Attachments\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Get Email Attachments\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Download Attachment\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Download Attachment\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Analyze Attachment\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Analyze Attachment\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Check Supported Type\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Check Supported Type\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"File Type Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"File Type Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Extract PDF Content\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Extract DOCX Content\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Analyze Image with Vision\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Extract PDF Content\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Store Attachment in S3\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Extract DOCX Content\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Store Attachment in S3\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Analyze Image with Vision\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Store Attachment in S3\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Store Attachment in S3\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Store Attachment Metadata\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\"\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"fc8a3179-5ef1-44a1-9fec-1f2089791c9a\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-14T00:55:35.207Z\",\n        \"updatedAt\": \"2025-07-14T00:55:35.207Z\",\n        \"id\": \"iIt4NUk8lOupSsLq\",\n        \"name\": \"My workflow 2\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"parameters\": {\n              \"pollTimes\": {\n                \"item\": [\n                  {\n                    \"mode\": \"everyMinute\"\n                  }\n                ]\n              },\n              \"output\": \"raw\",\n              \"filters\": {},\n              \"options\": {}\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -1280,\n              400\n            ],\n            \"id\": \"52ea3ae3-9737-4905-8c57-a906fa8fc14d\",\n            \"name\": \"Microsoft Outlook Trigger\"\n          },\n          {\n            \"parameters\": {\n              \"modelId\": {\n                \"__rl\": true,\n                \"value\": \"gpt-4o-mini\",\n                \"mode\": \"list\",\n                \"cachedResultName\": \"GPT-4O-MINI\"\n              },\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"content\": \"=Here is an incoming email:  {{ $json.body.content }}\"\n                  },\n                  {\n                    \"content\": \"Take the incoming email and clean it up so it is more readable. Get rid of the HTML tagging, but don't get rid of any of the email content. Don't include a subject.\\n\",\n                    \"role\": \"system\"\n                  }\n                ]\n              },\n              \"options\": {}\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n            \"typeVersion\": 1.8,\n            \"position\": [\n              -1100,\n              400\n            ],\n            \"id\": \"3f38e431-7b97-4dbf-b421-cadb7ee3019e\",\n            \"name\": \"Clean Email\"\n          },\n          {\n            \"parameters\": {\n              \"inputText\": \"={{ $json.message.content }}\",\n              \"categories\": {\n                \"categories\": [\n                  {\n                    \"category\": \"High Priority\",\n                    \"description\": \"Emails that require immediate attention, often involving urgent issues, escalations, system failures, or critical business matters.\\n\\nCommon Words/Phrases:\\nUrgent, ASAP, Immediate action required, Critical issue, Escalation, Emergency, System outage, High priority, Downtime, Affected customers, Please respond quickly, Need resolution, Time-sensitive.\"\n                  },\n                  {\n                    \"category\": \"Billing\",\n                    \"description\": \"Emails related to payments, invoices, subscriptions, financial transactions, or account balances. These emails often contain due dates, payment instructions, or financial statements.\\n\\nCommon Words/Phrases:\\nInvoice, Billing statement, Payment due, Past due, Outstanding balance, Subscription renewal, Payment confirmation, Charge notice, Overdue notice, Auto-renewal, Finance department, ACH transfer, Bank details.\"\n                  },\n                  {\n                    \"category\": \"Promotion\",\n                    \"description\": \"Emails related to marketing campaigns, sales offers, discounts, partnership opportunities, or advertisements. These emails are often sent in bulk and contain promotional language.\\n\\nCommon Words/Phrases:\\nSpecial offer, Limited-time deal, Exclusive discount, Save big, Flash sale, Promo code, Get 20% off, Earn rewards, Best deals, New product launch, Marketing campaign, Subscription offer, Early access, Upgrade now, Act fast.\"\n                  }\n                ]\n              },\n              \"options\": {}\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.textClassifier\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -740,\n              400\n            ],\n            \"id\": \"1ff481b6-757e-45f6-87e4-759108f33366\",\n            \"name\": \"Text Classifier\"\n          },\n          {\n            \"parameters\": {\n              \"modelName\": \"models/gemini-2.0-flash\",\n              \"options\": {}\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatGoogleGemini\",\n            \"typeVersion\": 1,\n            \"position\": [\n              -720,\n              620\n            ],\n            \"id\": \"09712c3b-a3a4-47a1-b435-b181cd57dce7\",\n            \"name\": \"Flash 2.0\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"move\",\n              \"messageId\": {\n                \"__rl\": true,\n                \"value\": \"={{ $('Microsoft Outlook Trigger').item.json.id }}\",\n                \"mode\": \"id\"\n              },\n              \"folderId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -260,\n              180\n            ],\n            \"id\": \"7ffde7c0-9385-4ee3-aa09-619073aa0da9\",\n            \"name\": \"High Priority Folder\",\n            \"webhookId\": \"d7869f88-45cf-4d4e-98f9-4b3ac0100851\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"move\",\n              \"messageId\": {\n                \"__rl\": true,\n                \"value\": \"={{ $('Microsoft Outlook Trigger').item.json.id }}\",\n                \"mode\": \"id\"\n              },\n              \"folderId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -260,\n              400\n            ],\n            \"id\": \"9400ee38-eb66-4ec9-8397-e86bfbf71ea3\",\n            \"name\": \"Billing Folder\",\n            \"webhookId\": \"d7869f88-45cf-4d4e-98f9-4b3ac0100851\"\n          },\n          {\n            \"parameters\": {\n              \"promptType\": \"define\",\n              \"text\": \"=Here is the email: {{ $('Clean Email').item.json.message.content }}\",\n              \"options\": {\n                \"systemMessage\": \"=# Overview\\nYou are a billing assistant. Your job is to respond to the incoming emails in a professional manner.\\n\\n## Tools \\nCreate Draft - Use this tool to send an email in response to the one you receive\"\n              }\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"typeVersion\": 1.7,\n            \"position\": [\n              -60,\n              400\n            ],\n            \"id\": \"6e1441e5-2cfc-46ef-95dc-29d4b4974019\",\n            \"name\": \"Billing Agent\"\n          },\n          {\n            \"parameters\": {\n              \"resource\": \"draft\",\n              \"subject\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}\",\n              \"bodyContent\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', `sign off as Bob from ABS Corp`, 'string') }}\",\n              \"additionalFields\": {\n                \"toRecipients\": \"={{ $('Microsoft Outlook Trigger').item.json.sender.emailAddress.address }}\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              140,\n              600\n            ],\n            \"id\": \"1524f553-8b8f-445c-b1a0-6fef21a310a0\",\n            \"name\": \"Create Draft\",\n            \"webhookId\": \"445ca80a-e3b5-4c65-8555-7c5d6d3cfe54\"\n          },\n          {\n            \"parameters\": {\n              \"operation\": \"move\",\n              \"messageId\": {\n                \"__rl\": true,\n                \"value\": \"={{ $('Microsoft Outlook Trigger').item.json.id }}\",\n                \"mode\": \"id\"\n              },\n              \"folderId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"\"\n              }\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -260,\n              620\n            ],\n            \"id\": \"2ecb342f-2a6d-42f4-ab1f-e32669649a47\",\n            \"name\": \"Promotion Folder\",\n            \"webhookId\": \"d7869f88-45cf-4d4e-98f9-4b3ac0100851\"\n          },\n          {\n            \"parameters\": {\n              \"toRecipients\": \"={{ $('Microsoft Outlook Trigger').item.json.from.emailAddress.address }}\",\n              \"subject\": \"Not Interested\",\n              \"bodyContent\": \"={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', `Sign off all emails as Frank`, 'string') }}\",\n              \"additionalFields\": {}\n            },\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"typeVersion\": 2,\n            \"position\": [\n              120,\n              1000\n            ],\n            \"id\": \"cf2945bf-551a-449d-a6d7-70a5934e4a70\",\n            \"name\": \"Send Email\",\n            \"webhookId\": \"47f1e1c3-dcdf-4656-b914-0eeb16cc6bb9\"\n          },\n          {\n            \"parameters\": {\n              \"promptType\": \"define\",\n              \"text\": \"=Here is the incoming email: {{ $('Clean Email').item.json.message.content }}\",\n              \"options\": {\n                \"systemMessage\": \"You will receive promotional emails. Your job is to politely decline all offers. Use the 'Send Email' Tool to do so.\"\n              }\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"typeVersion\": 1.7,\n            \"position\": [\n              -40,\n              780\n            ],\n            \"id\": \"e9b69bdf-dfe8-4a8d-993a-8488ab5f58ee\",\n            \"name\": \"Promotion Agent\"\n          },\n          {\n            \"parameters\": {\n              \"text\": \"=New High Priority Email\\n\\nFrom: {{ $('Microsoft Outlook Trigger').item.json.sender.emailAddress.name }}\\n\\nSubject: {{ $('Microsoft Outlook Trigger').item.json.subject }}\\n\\nDate: {{ $now.format('yyyy-MM-dd') }}\",\n              \"additionalFields\": {\n                \"appendAttribution\": false\n              }\n            },\n            \"type\": \"n8n-nodes-base.telegram\",\n            \"typeVersion\": 1.2,\n            \"position\": [\n              -60,\n              180\n            ],\n            \"id\": \"58871d01-c702-483a-8ec4-72a6218acdf7\",\n            \"name\": \"High Priority Notification\",\n            \"webhookId\": \"816efd19-6ee7-4e4f-ac86-e0778853b21f\"\n          },\n          {\n            \"parameters\": {\n              \"text\": \"=New billing inquiry received at {{ $now.format('hh:mm a') }} from {{ $('Microsoft Outlook Trigger').item.json.sender.emailAddress.name }}.\\n\\nA draft has been created and is sitting in your Outlook.\",\n              \"additionalFields\": {\n                \"appendAttribution\": false\n              }\n            },\n            \"type\": \"n8n-nodes-base.telegram\",\n            \"typeVersion\": 1.2,\n            \"position\": [\n              300,\n              400\n            ],\n            \"id\": \"772af8e7-2d01-4679-833e-c2782aada0d5\",\n            \"name\": \"Billing Notification\",\n            \"webhookId\": \"816efd19-6ee7-4e4f-ac86-e0778853b21f\"\n          },\n          {\n            \"parameters\": {\n              \"model\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"options\": {}\n            },\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"typeVersion\": 1.2,\n            \"position\": [\n              -40,\n              620\n            ],\n            \"id\": \"229978d0-137d-45b2-b72f-d768697c6d5e\",\n            \"name\": \"4o mini\"\n          },\n          {\n            \"parameters\": {\n              \"content\": \"# Outlook Inbox Manager\\n\",\n              \"height\": 1080,\n              \"width\": 1920,\n              \"color\": 4\n            },\n            \"type\": \"n8n-nodes-base.stickyNote\",\n            \"position\": [\n              -1400,\n              80\n            ],\n            \"typeVersion\": 1,\n            \"id\": \"608d485f-07f1-4c6f-93fa-910e3d9416f6\",\n            \"name\": \"Sticky Note\"\n          },\n          {\n            \"parameters\": {\n              \"content\": \"# Nate Herk | AI Automation\",\n              \"height\": 80,\n              \"width\": 500,\n              \"color\": 5\n            },\n            \"type\": \"n8n-nodes-base.stickyNote\",\n            \"position\": [\n              -720,\n              -60\n            ],\n            \"typeVersion\": 1,\n            \"id\": \"76ed57a2-36d3-4f91-986e-4bf89146bafb\",\n            \"name\": \"Sticky Note1\"\n          },\n          {\n            \"parameters\": {\n              \"content\": \"## Set Up\\n- Plug in your credentials/chat models.\\n- The 'Clean Email' node is NOT necessary. If you remove it, you will need to remap some inputs.\",\n              \"width\": 300\n            },\n            \"type\": \"n8n-nodes-base.stickyNote\",\n            \"position\": [\n              -1780,\n              260\n            ],\n            \"typeVersion\": 1,\n            \"id\": \"aa7def28-c5c7-49ac-85c9-25b4c1d74d33\",\n            \"name\": \"Sticky Note2\"\n          }\n        ],\n        \"connections\": {\n          \"Microsoft Outlook Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Clean Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Clean Email\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Text Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Flash 2.0\": {\n            \"ai_languageModel\": [\n              [\n                {\n                  \"node\": \"Text Classifier\",\n                  \"type\": \"ai_languageModel\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Text Classifier\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"High Priority Folder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Billing Folder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Promotion Folder\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"High Priority Folder\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"High Priority Notification\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Billing Folder\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Billing Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Create Draft\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Billing Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Billing Agent\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Billing Notification\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Promotion Folder\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Promotion Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Send Email\": {\n            \"ai_tool\": [\n              [\n                {\n                  \"node\": \"Promotion Agent\",\n                  \"type\": \"ai_tool\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"4o mini\": {\n            \"ai_languageModel\": [\n              [\n                {\n                  \"node\": \"Billing Agent\",\n                  \"type\": \"ai_languageModel\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Promotion Agent\",\n                  \"type\": \"ai_languageModel\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\"\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"e26fa2b4-93c1-4831-b915-1b2c3febca21\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-23T12:06:24.403Z\",\n        \"updatedAt\": \"2025-11-24T12:24:43.000Z\",\n        \"id\": \"irKDBNBQMguzNUON\",\n        \"name\": \"Test Simple Webhook Workflow\",\n        \"active\": false,\n        \"isArchived\": true,\n        \"nodes\": [\n          {\n            \"id\": \"webhook_0\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"name\": \"Webhook\",\n            \"parameters\": {\n              \"path\": \"webhook-data\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\"\n            },\n            \"position\": [\n              240,\n              300\n            ],\n            \"webhookId\": \"jf256dzev\",\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"fovw6olc5\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"name\": \"Process Data 2\",\n            \"parameters\": {\n              \"functionCode\": \"\\n            // Process the incoming data\\n            const processedData = {\\n              timestamp: new Date().toISOString(),\\n              originalData: $input.all(),\\n              processed: true\\n            };\\n            \\n            return [processedData];\\n          \"\n            },\n            \"position\": [\n              540,\n              300\n            ],\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Data 2\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"d7654437-d6bc-4fa2-87a5-00a46a3f9d7e\",\n        \"triggerCount\": 1,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-16T19:18:06.490Z\",\n        \"updatedAt\": \"2025-11-24T12:24:38.000Z\",\n        \"id\": \"jPgnqs7cGTKQT3Fh\",\n        \"name\": \"MCP Enhanced Demo - Smart Email Classifier\",\n        \"active\": false,\n        \"isArchived\": true,\n        \"nodes\": [\n          {\n            \"id\": \"demo-webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"name\": \"Demo Webhook\",\n            \"parameters\": {\n              \"path\": \"mcp-demo\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\"\n            },\n            \"position\": [\n              200,\n              300\n            ],\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"demo-classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.anthropic\",\n            \"name\": \"AI Email Classifier\",\n            \"parameters\": {\n              \"model\": \"claude-3-5-sonnet-20241022\",\n              \"text\": \"Classify this email and extract key information: {{ $json.body.email }}\",\n              \"options\": {\n                \"temperature\": 0.1\n              }\n            },\n            \"position\": [\n              400,\n              300\n            ],\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"demo-response\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"name\": \"Smart Response\",\n            \"parameters\": {},\n            \"position\": [\n              600,\n              300\n            ],\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Demo Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Email Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Email Classifier\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Smart Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"2d420276-927d-4ce9-a679-8a2136fcb8da\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-22T13:44:09.514Z\",\n        \"updatedAt\": \"2025-06-22T13:44:09.514Z\",\n        \"id\": \"kerbDokcCDscra0R\",\n        \"name\": \"AI Outlook Email Assistant - Advanced\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"xwqe5gyt5\",\n            \"name\": \"Email Trigger (IMAP)\",\n            \"type\": \"n8n-nodes-base.emailReadImap\",\n            \"typeVersion\": 2,\n            \"position\": [\n              240,\n              300\n            ],\n            \"parameters\": {\n              \"protocol\": \"imap\",\n              \"host\": \"outlook.office365.com\",\n              \"port\": 993,\n              \"secure\": true,\n              \"mailbox\": \"INBOX\",\n              \"action\": \"read\",\n              \"format\": \"simple\",\n              \"readEmailsFromDate\": \"\",\n              \"options\": {\n                \"allowUnauthorizedCerts\": false,\n                \"connTimeout\": 60000,\n                \"authTimeout\": 5000,\n                \"keepAlive\": {\n                  \"enabled\": true\n                }\n              }\n            },\n            \"credentials\": {\n              \"imap\": {\n                \"id\": \"outlook_imap_credentials\",\n                \"name\": \"Outlook IMAP\"\n              }\n            }\n          },\n          {\n            \"id\": \"wrave6rcd\",\n            \"name\": \"Email Content Processor\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              460,\n              300\n            ],\n            \"parameters\": {\n              \"functionCode\": \"\\n        // Extract and process email data\\n        const emailData = $input.all();\\n        const processedEmails = [];\\n        \\n        for (const email of emailData) {\\n          const processed = {\\n            id: email.json.messageId || generateId(),\\n            subject: email.json.subject || '',\\n            from: email.json.from || '',\\n            to: email.json.to || '',\\n            cc: email.json.cc || '',\\n            bcc: email.json.bcc || '',\\n            date: email.json.date || new Date().toISOString(),\\n            body: email.json.text || email.json.html || '',\\n            html: email.json.html || '',\\n            attachments: email.json.attachments || [],\\n            headers: email.json.headers || {},\\n            receivedAt: new Date().toISOString(),\\n            processed: false,\\n            priority: 'medium',\\n            category: 'unclassified',\\n            sentiment: 'neutral',\\n            urgency: 'normal',\\n            entities: [],\\n            aiAnalysis: null,\\n            draftResponse: null,\\n            conversationId: null\\n          };\\n          \\n          // Extract conversation ID from subject or message ID\\n          const subjectMatch = processed.subject.match(/\\\\[#([A-Z0-9]+)\\\\]/);\\n          if (subjectMatch) {\\n            processed.conversationId = subjectMatch[1];\\n          } else {\\n            processed.conversationId = processed.id.substring(0, 8).toUpperCase();\\n          }\\n          \\n          processedEmails.push(processed);\\n        }\\n        \\n        return processedEmails;\\n      \"\n            }\n          },\n          {\n            \"id\": \"pgpqiu2b0\",\n            \"name\": \"Attachment Handler\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              680,\n              200\n            ],\n            \"parameters\": {\n              \"functionCode\": \"\\n        // Process email attachments\\n        const emails = $input.all();\\n        const processedEmails = [];\\n        \\n        for (const email of emails) {\\n          const emailData = email.json;\\n          \\n          if (emailData.attachments && emailData.attachments.length > 0) {\\n            const processedAttachments = [];\\n            \\n            for (const attachment of emailData.attachments) {\\n              const processed = {\\n                filename: attachment.filename || 'unknown',\\n                contentType: attachment.contentType || 'application/octet-stream',\\n                size: attachment.size || 0,\\n                content: attachment.content || '',\\n                extractedText: '',\\n                fileType: attachment.filename ? attachment.filename.split('.').pop().toLowerCase() : 'unknown',\\n                processed: true,\\n                extractedAt: new Date().toISOString()\\n              };\\n              \\n              // Basic text extraction for common file types\\n              if (processed.fileType === 'txt') {\\n                processed.extractedText = attachment.content;\\n              } else if (processed.fileType === 'pdf') {\\n                processed.extractedText = '[PDF content - requires specialized extraction]';\\n              } else if (['doc', 'docx'].includes(processed.fileType)) {\\n                processed.extractedText = '[Word document - requires specialized extraction]';\\n              }\\n              \\n              processedAttachments.push(processed);\\n            }\\n            \\n            emailData.processedAttachments = processedAttachments;\\n            emailData.hasAttachments = true;\\n          } else {\\n            emailData.processedAttachments = [];\\n            emailData.hasAttachments = false;\\n          }\\n          \\n          processedEmails.push(email);\\n        }\\n        \\n        return processedEmails;\\n      \"\n            }\n          },\n          {\n            \"id\": \"gonzufatz\",\n            \"name\": \"OpenAI Email Classifier\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1,\n            \"position\": [\n              680,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"text\",\n              \"model\": \"gpt-4\",\n              \"prompt\": \"Analyze the following email and provide a JSON response with classification:\\n\\nEmail Subject: {{ $json.subject }}\\nEmail From: {{ $json.from }}\\nEmail Body: {{ $json.body }}\\nHas Attachments: {{ $json.hasAttachments }}\\n\\nPlease classify this email and return a JSON object with the following structure:\\n{\\n  \\\"type\\\": \\\"customer_inquiry|sales_prospect|support_request|internal_communication|spam|newsletter|urgent_request|complaint|compliment|order_status|invoice|meeting_request|other\\\",\\n  \\\"priority\\\": \\\"high|medium|low\\\",\\n  \\\"sentiment\\\": \\\"positive|negative|neutral\\\",\\n  \\\"urgency\\\": \\\"urgent|high|medium|low\\\",\\n  \\\"confidence\\\": 0.95,\\n  \\\"entities\\\": {\\n    \\\"people\\\": [\\\"John Doe\\\", \\\"Jane Smith\\\"],\\n    \\\"organizations\\\": [\\\"Company ABC\\\", \\\"XYZ Corp\\\"],\\n    \\\"dates\\\": [\\\"2024-01-15\\\", \\\"next Monday\\\"],\\n    \\\"amounts\\\": [\\\"$1,000\\\", \\\"‚Ç¨500\\\"],\\n    \\\"products\\\": [\\\"Product A\\\", \\\"Service B\\\"],\\n    \\\"locations\\\": [\\\"New York\\\", \\\"London\\\"]\\n  },\\n  \\\"keyTopics\\\": [\\\"pricing\\\", \\\"demo\\\", \\\"support\\\"],\\n  \\\"actionRequired\\\": true,\\n  \\\"suggestedActions\\\": [\\\"schedule_demo\\\", \\\"provide_quote\\\", \\\"escalate_to_manager\\\"],\\n  \\\"responseUrgency\\\": \\\"within_1_hour|within_4_hours|within_24_hours|within_week\\\",\\n  \\\"emotionalTone\\\": \\\"frustrated|excited|concerned|satisfied|angry|happy|neutral\\\",\\n  \\\"businessValue\\\": \\\"high|medium|low\\\",\\n  \\\"riskLevel\\\": \\\"high|medium|low|none\\\"\\n}\\n\\nOnly return the JSON object, no additional text.\",\n              \"temperature\": 0.1,\n              \"maxTokens\": 1000,\n              \"options\": {}\n            },\n            \"credentials\": {\n              \"openAiApi\": {\n                \"id\": \"openai_credentials\",\n                \"name\": \"OpenAI API\"\n              }\n            }\n          },\n          {\n            \"id\": \"0qblmpukv\",\n            \"name\": \"AI Analysis Parser\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              900,\n              400\n            ],\n            \"parameters\": {\n              \"functionCode\": \"\\n        // Parse OpenAI analysis response\\n        const items = $input.all();\\n        const processedItems = [];\\n        \\n        for (const item of items) {\\n          try {\\n            const emailData = item.json;\\n            const aiResponse = emailData.choices?.[0]?.message?.content || emailData.text || '';\\n            \\n            // Parse JSON response from OpenAI\\n            let aiAnalysis;\\n            try {\\n              aiAnalysis = JSON.parse(aiResponse);\\n            } catch (parseError) {\\n              // Fallback analysis if JSON parsing fails\\n              aiAnalysis = {\\n                type: 'other',\\n                priority: 'medium',\\n                sentiment: 'neutral',\\n                urgency: 'medium',\\n                confidence: 0.5,\\n                entities: { people: [], organizations: [], dates: [], amounts: [], products: [], locations: [] },\\n                keyTopics: [],\\n                actionRequired: false,\\n                suggestedActions: [],\\n                responseUrgency: 'within_24_hours',\\n                emotionalTone: 'neutral',\\n                businessValue: 'medium',\\n                riskLevel: 'none',\\n                parsingError: parseError.message\\n              };\\n            }\\n            \\n            // Merge AI analysis with email data\\n            const enhancedEmail = {\\n              ...emailData,\\n              aiAnalysis: aiAnalysis,\\n              type: aiAnalysis.type,\\n              priority: aiAnalysis.priority,\\n              sentiment: aiAnalysis.sentiment,\\n              urgency: aiAnalysis.urgency,\\n              entities: aiAnalysis.entities,\\n              keyTopics: aiAnalysis.keyTopics,\\n              actionRequired: aiAnalysis.actionRequired,\\n              suggestedActions: aiAnalysis.suggestedActions,\\n              responseUrgency: aiAnalysis.responseUrgency,\\n              emotionalTone: aiAnalysis.emotionalTone,\\n              businessValue: aiAnalysis.businessValue,\\n              riskLevel: aiAnalysis.riskLevel,\\n              confidence: aiAnalysis.confidence,\\n              analysisTimestamp: new Date().toISOString(),\\n              processed: true\\n            };\\n            \\n            processedItems.push({ json: enhancedEmail });\\n          } catch (error) {\\n            console.error('Error processing AI analysis:', error);\\n            processedItems.push(item);\\n          }\\n        }\\n        \\n        return processedItems;\\n      \"\n            }\n          },\n          {\n            \"id\": \"3rz31g1my\",\n            \"name\": \"Vector Embeddings Generator\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1120,\n              300\n            ],\n            \"parameters\": {\n              \"operation\": \"embedding\",\n              \"model\": \"text-embedding-ada-002\",\n              \"text\": \"{{ $json.subject }} {{ $json.body }}\",\n              \"options\": {}\n            },\n            \"credentials\": {\n              \"openAiApi\": {\n                \"id\": \"openai_credentials\",\n                \"name\": \"OpenAI API\"\n              }\n            }\n          },\n          {\n            \"id\": \"1qhvro5fr\",\n            \"name\": \"PostgreSQL Storage\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1340,\n              300\n            ],\n            \"parameters\": {\n              \"operation\": \"insert\",\n              \"schema\": \"public\",\n              \"table\": \"emails\",\n              \"columns\": {\n                \"mappingMode\": \"defineBelow\",\n                \"value\": {\n                  \"id\": \"={{ $json.id }}\",\n                  \"subject\": \"={{ $json.subject }}\",\n                  \"sender\": \"={{ $json.from }}\",\n                  \"recipient\": \"={{ $json.to }}\",\n                  \"body\": \"={{ $json.body }}\",\n                  \"html_body\": \"={{ $json.html }}\",\n                  \"received_at\": \"={{ $json.date }}\",\n                  \"processed_at\": \"={{ $json.analysisTimestamp }}\",\n                  \"email_type\": \"={{ $json.type }}\",\n                  \"priority\": \"={{ $json.priority }}\",\n                  \"sentiment\": \"={{ $json.sentiment }}\",\n                  \"urgency\": \"={{ $json.urgency }}\",\n                  \"confidence\": \"={{ $json.confidence }}\",\n                  \"entities\": \"={{ JSON.stringify($json.entities) }}\",\n                  \"key_topics\": \"={{ JSON.stringify($json.keyTopics) }}\",\n                  \"suggested_actions\": \"={{ JSON.stringify($json.suggestedActions) }}\",\n                  \"response_urgency\": \"={{ $json.responseUrgency }}\",\n                  \"emotional_tone\": \"={{ $json.emotionalTone }}\",\n                  \"business_value\": \"={{ $json.businessValue }}\",\n                  \"risk_level\": \"={{ $json.riskLevel }}\",\n                  \"has_attachments\": \"={{ $json.hasAttachments }}\",\n                  \"attachments_data\": \"={{ JSON.stringify($json.processedAttachments) }}\",\n                  \"conversation_id\": \"={{ $json.conversationId }}\",\n                  \"embedding\": \"={{ JSON.stringify($('Vector Embeddings Generator').item.json.data[0].embedding) }}\",\n                  \"ai_analysis\": \"={{ JSON.stringify($json.aiAnalysis) }}\",\n                  \"headers\": \"={{ JSON.stringify($json.headers) }}\"\n                }\n              },\n              \"options\": {\n                \"queryBatching\": \"transaction\"\n              }\n            },\n            \"credentials\": {\n              \"postgres\": {\n                \"id\": \"postgres_credentials\",\n                \"name\": \"PostgreSQL Database\"\n              }\n            }\n          },\n          {\n            \"id\": \"arqe8be0u\",\n            \"name\": \"Response Generator\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1,\n            \"position\": [\n              900,\n              600\n            ],\n            \"parameters\": {\n              \"operation\": \"text\",\n              \"model\": \"gpt-4\",\n              \"prompt\": \"Generate a professional email response based on the following email analysis:\\n\\nOriginal Email:\\nSubject: {{ $json.subject }}\\nFrom: {{ $json.from }}\\nBody: {{ $json.body }}\\n\\nAI Analysis:\\nType: {{ $json.type }}\\nPriority: {{ $json.priority }}\\nSentiment: {{ $json.sentiment }}\\nUrgency: {{ $json.urgency }}\\nKey Topics: {{ JSON.stringify($json.keyTopics) }}\\nSuggested Actions: {{ JSON.stringify($json.suggestedActions) }}\\nEmotional Tone: {{ $json.emotionalTone }}\\n\\nPlease generate a professional, personalized draft response that:\\n1. Acknowledges the sender's message appropriately\\n2. Addresses the key topics and concerns raised\\n3. Maintains a professional but warm tone\\n4. Includes relevant next steps or actions\\n5. Uses the company's standard email signature format\\n\\nReturn a JSON object with:\\n{\\n  \\\"subject\\\": \\\"Re: [original subject]\\\",\\n  \\\"body\\\": \\\"Complete email response text\\\",\\n  \\\"tone\\\": \\\"professional|friendly|formal|casual\\\",\\n  \\\"nextSteps\\\": [\\\"action1\\\", \\\"action2\\\"],\\n  \\\"priority\\\": \\\"high|medium|low\\\",\\n  \\\"reviewRequired\\\": true/false,\\n  \\\"confidence\\\": 0.95,\\n  \\\"estimatedSentiment\\\": \\\"positive|neutral|negative\\\"\\n}\\n\\nOnly return the JSON object.\",\n              \"temperature\": 0.3,\n              \"maxTokens\": 1500,\n              \"options\": {}\n            },\n            \"credentials\": {\n              \"openAiApi\": {\n                \"id\": \"openai_credentials\",\n                \"name\": \"OpenAI API\"\n              }\n            }\n          },\n          {\n            \"id\": \"qe5ya2xx0\",\n            \"name\": \"Response Parser\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1120,\n              600\n            ],\n            \"parameters\": {\n              \"functionCode\": \"\\n        // Parse AI-generated response\\n        const items = $input.all();\\n        const processedItems = [];\\n        \\n        for (const item of items) {\\n          try {\\n            const responseData = item.json.choices?.[0]?.message?.content || item.json.text || '';\\n            \\n            let draftResponse;\\n            try {\\n              draftResponse = JSON.parse(responseData);\\n            } catch (parseError) {\\n              // Fallback response structure\\n              draftResponse = {\\n                subject: 'Re: ' + (item.json.subject || 'Your Message'),\\n                body: 'Thank you for your message. We have received your inquiry and will respond shortly.',\\n                tone: 'professional',\\n                nextSteps: ['manual_review'],\\n                priority: 'medium',\\n                reviewRequired: true,\\n                confidence: 0.5,\\n                estimatedSentiment: 'neutral',\\n                parsingError: parseError.message\\n              };\\n            }\\n            \\n            const enhancedItem = {\\n              ...item.json,\\n              draftResponse: draftResponse,\\n              responseGenerated: true,\\n              responseGeneratedAt: new Date().toISOString(),\\n              readyForReview: true\\n            };\\n            \\n            processedItems.push({ json: enhancedItem });\\n          } catch (error) {\\n            console.error('Error parsing response:', error);\\n            processedItems.push(item);\\n          }\\n        }\\n        \\n        return processedItems;\\n      \"\n            }\n          },\n          {\n            \"id\": \"b2xz3c3yd\",\n            \"name\": \"High Priority Filter\",\n            \"type\": \"n8n-nodes-base.if\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1340,\n              600\n            ],\n            \"parameters\": {\n              \"conditions\": {\n                \"options\": {\n                  \"caseSensitive\": true,\n                  \"leftValue\": \"\",\n                  \"typeValidation\": \"strict\"\n                },\n                \"conditions\": [\n                  {\n                    \"leftValue\": \"={{ $json.priority }}\",\n                    \"rightValue\": \"high\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    }\n                  }\n                ],\n                \"combineOperation\": \"any\"\n              }\n            }\n          },\n          {\n            \"id\": \"nxy3089mg\",\n            \"name\": \"Teams High Priority Alert\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1560,\n              500\n            ],\n            \"parameters\": {\n              \"operation\": \"postMessage\",\n              \"channelId\": \"{{ $json.teamsChannelId || 'general' }}\",\n              \"message\": \"üö® **HIGH PRIORITY EMAIL ALERT** üö®\\n\\n**From:** {{ $json.from }}\\n**Subject:** {{ $json.subject }}\\n**Type:** {{ $json.type }}\\n**Urgency:** {{ $json.urgency }}\\n**Sentiment:** {{ $json.sentiment }}\\n**Risk Level:** {{ $json.riskLevel }}\\n\\n**Key Topics:** {{ JSON.stringify($json.keyTopics) }}\\n**Suggested Actions:** {{ JSON.stringify($json.suggestedActions) }}\\n\\n**Draft Response Generated:** {{ $json.draftResponse.subject }}\\n\\n**Action Required:** Please review and approve the draft response.\\n\\n**Email ID:** {{ $json.id }}\\n**Conversation ID:** {{ $json.conversationId }}\",\n              \"otherOptions\": {\n                \"includeLinkToWorkflow\": false\n              }\n            },\n            \"credentials\": {\n              \"microsoftTeamsOAuth2Api\": {\n                \"id\": \"teams_credentials\",\n                \"name\": \"Microsoft Teams\"\n              }\n            }\n          },\n          {\n            \"id\": \"roni2718y\",\n            \"name\": \"Teams Regular Notification\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1560,\n              700\n            ],\n            \"parameters\": {\n              \"operation\": \"postMessage\",\n              \"channelId\": \"{{ $json.teamsChannelId || 'email-processing' }}\",\n              \"message\": \"üìß **Email Processed**\\n\\n**From:** {{ $json.from }}\\n**Subject:** {{ $json.subject }}\\n**Type:** {{ $json.type }}\\n**Priority:** {{ $json.priority }}\\n**Sentiment:** {{ $json.sentiment }}\\n\\n**Draft Response:** Ready for review\\n**Confidence:** {{ $json.confidence }}\\n\\n**Email ID:** {{ $json.id }}\",\n              \"otherOptions\": {\n                \"includeLinkToWorkflow\": false\n              }\n            },\n            \"credentials\": {\n              \"microsoftTeamsOAuth2Api\": {\n                \"id\": \"teams_credentials\",\n                \"name\": \"Microsoft Teams\"\n              }\n            }\n          },\n          {\n            \"id\": \"eoyzm9sb3\",\n            \"name\": \"Conversation History Tracker\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1340,\n              800\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\",\n              \"query\": \"\\n        INSERT INTO conversation_history (\\n          conversation_id, email_id, participant, message_type, \\n          subject, body, timestamp, ai_confidence, response_approved\\n        ) VALUES (\\n          '{{ $json.conversationId }}',\\n          '{{ $json.id }}',\\n          '{{ $json.from }}',\\n          'received',\\n          '{{ $json.subject }}',\\n          '{{ $json.body }}',\\n          '{{ $json.date }}',\\n          {{ $json.confidence }},\\n          false\\n        );\\n        \\n        INSERT INTO conversation_history (\\n          conversation_id, email_id, participant, message_type,\\n          subject, body, timestamp, ai_confidence, response_approved\\n        ) VALUES (\\n          '{{ $json.conversationId }}',\\n          '{{ $json.id }}_draft',\\n          'AI Assistant',\\n          'draft_response',\\n          '{{ $json.draftResponse.subject }}',\\n          '{{ $json.draftResponse.body }}',\\n          '{{ $json.responseGeneratedAt }}',\\n          {{ $json.draftResponse.confidence }},\\n          false\\n        );\\n      \",\n              \"options\": {}\n            },\n            \"credentials\": {\n              \"postgres\": {\n                \"id\": \"postgres_credentials\",\n                \"name\": \"PostgreSQL Database\"\n              }\n            }\n          },\n          {\n            \"id\": \"adwgbkwpf\",\n            \"name\": \"Analytics Data Collector\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"typeVersion\": 2,\n            \"position\": [\n              1780,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"insert\",\n              \"schema\": \"public\",\n              \"table\": \"email_analytics\",\n              \"columns\": {\n                \"mappingMode\": \"defineBelow\",\n                \"value\": {\n                  \"date\": \"={{ $now.format('YYYY-MM-DD') }}\",\n                  \"hour\": \"={{ $now.format('HH') }}\",\n                  \"email_type\": \"={{ $json.type }}\",\n                  \"priority\": \"={{ $json.priority }}\",\n                  \"sentiment\": \"={{ $json.sentiment }}\",\n                  \"urgency\": \"={{ $json.urgency }}\",\n                  \"business_value\": \"={{ $json.businessValue }}\",\n                  \"risk_level\": \"={{ $json.riskLevel }}\",\n                  \"response_time_seconds\": \"={{ Math.floor((new Date() - new Date($json.date)) / 1000) }}\",\n                  \"ai_confidence\": \"={{ $json.confidence }}\",\n                  \"has_attachments\": \"={{ $json.hasAttachments }}\",\n                  \"sender_domain\": \"={{ $json.from.split('@')[1] }}\",\n                  \"processing_timestamp\": \"={{ $now.toISOString() }}\"\n                }\n              },\n              \"options\": {\n                \"queryBatching\": \"transaction\"\n              }\n            },\n            \"credentials\": {\n              \"postgres\": {\n                \"id\": \"postgres_credentials\",\n                \"name\": \"PostgreSQL Database\"\n              }\n            }\n          },\n          {\n            \"id\": \"tevakf3l5\",\n            \"name\": \"Error Handler\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              1780,\n              600\n            ],\n            \"parameters\": {\n              \"functionCode\": \"\\n        // Handle errors and implement retry logic\\n        const items = $input.all();\\n        const processedItems = [];\\n        \\n        for (const item of items) {\\n          try {\\n            const errorData = {\\n              errorId: generateId(),\\n              originalEmailId: item.json.id || 'unknown',\\n              errorType: item.json.error?.name || 'UnknownError',\\n              errorMessage: item.json.error?.message || 'No error message available',\\n              errorStack: item.json.error?.stack || '',\\n              timestamp: new Date().toISOString(),\\n              retryCount: item.json.retryCount || 0,\\n              maxRetries: 3,\\n              canRetry: (item.json.retryCount || 0) < 3,\\n              workflowExecution: $workflow.id,\\n              nodeExecution: $node.name\\n            };\\n            \\n            // Log error for monitoring\\n            console.error('Email processing error:', errorData);\\n            \\n            processedItems.push({ json: errorData });\\n          } catch (processingError) {\\n            console.error('Error in error handler:', processingError);\\n            processedItems.push(item);\\n          }\\n        }\\n        \\n        return processedItems;\\n      \"\n            }\n          },\n          {\n            \"id\": \"agpt0st9i\",\n            \"name\": \"Batch Processing Manager\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"typeVersion\": 1,\n            \"position\": [\n              460,\n              100\n            ],\n            \"parameters\": {\n              \"functionCode\": \"\\n        // Manage batch processing for high-volume emails\\n        const items = $input.all();\\n        const batchSize = 10; // Process 10 emails at a time\\n        const batches = [];\\n        \\n        // Split items into batches\\n        for (let i = 0; i < items.length; i += batchSize) {\\n          const batch = items.slice(i, i + batchSize);\\n          batches.push({\\n            json: {\\n              batchId: generateId(),\\n              batchNumber: Math.floor(i / batchSize) + 1,\\n              totalBatches: Math.ceil(items.length / batchSize),\\n              batchSize: batch.length,\\n              totalItems: items.length,\\n              items: batch,\\n              createdAt: new Date().toISOString(),\\n              processed: false\\n            }\\n          });\\n        }\\n        \\n        console.log(`Created ${batches.length} batches for ${items.length} emails`);\\n        return batches;\\n      \"\n            }\n          }\n        ],\n        \"connections\": {\n          \"Email Trigger (IMAP)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Batch Processing Manager\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Email Content Processor\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Content Processor\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Attachment Handler\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"OpenAI Email Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Attachment Handler\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"OpenAI Email Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Email Classifier\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Analysis Parser\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Analysis Parser\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Vector Embeddings Generator\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Response Generator\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Vector Embeddings Generator\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"PostgreSQL Storage\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Response Generator\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Response Parser\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Response Parser\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"High Priority Filter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Conversation History Tracker\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"High Priority Filter\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Teams High Priority Alert\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Teams Regular Notification\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams High Priority Alert\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Analytics Data Collector\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Regular Notification\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Analytics Data Collector\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Conversation History Tracker\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Analytics Data Collector\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"PostgreSQL Storage\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Analytics Data Collector\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 7200,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"d5bb3b07-1344-45d4-a0be-6eba96a375c6\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-19T01:43:36.528Z\",\n        \"updatedAt\": \"2025-07-19T01:43:36.528Z\",\n        \"id\": \"klJIlVcx6ThfIA8R\",\n        \"name\": \"Writing Style Learning System\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"style-learning-trigger\",\n            \"name\": \"Style Learning Trigger\",\n            \"type\": \"n8n-nodes-base.cron\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              200,\n              300\n            ],\n            \"parameters\": {\n              \"triggerTimes\": {\n                \"item\": [\n                  {\n                    \"mode\": \"everyHour\"\n                  }\n                ]\n              }\n            }\n          },\n          {\n            \"id\": \"fetch-recent-sent\",\n            \"name\": \"Fetch Recent Sent Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              400,\n              300\n            ],\n            \"parameters\": {\n              \"operation\": \"getAll\",\n              \"folderId\": {\n                \"__rl\": true,\n                \"value\": \"sentitems\",\n                \"mode\": \"list\"\n              },\n              \"limit\": 20,\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"receivedAfter\": \"={{ $now.minus({ hours: 24 }).toISODate() }}\"\n                  }\n                }\n              },\n              \"options\": {}\n            }\n          },\n          {\n            \"id\": \"style-analyzer\",\n            \"name\": \"Writing Style Analyzer\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"typeVersion\": 1.7,\n            \"position\": [\n              600,\n              300\n            ],\n            \"parameters\": {\n              \"promptType\": \"define\",\n              \"text\": \"=Analyze the following sent emails and extract the user's writing style:\\n\\n{{ $json.map(email => `Subject: ${email.subject}\\nContent: ${email.body?.content || email.bodyPreview}\\n---`).join('\\n') }}\\n\\nExtract and return as JSON:\\n{\\n  \\\"writingStyle\\\": \\\"professional/casual/formal\\\",\\n  \\\"averageLength\\\": \\\"short/medium/long\\\", \\n  \\\"commonPhrases\\\": [\\\"phrase1\\\", \\\"phrase2\\\"],\\n  \\\"signatureStyle\\\": \\\"closing style\\\",\\n  \\\"vocabularyLevel\\\": \\\"simple/business/technical\\\",\\n  \\\"personalityTraits\\\": [\\\"friendly\\\", \\\"direct\\\", \\\"detailed\\\"]\\n}\",\n              \"options\": {\n                \"systemMessage\": \"You are an expert in communication style analysis. Analyze email patterns to extract writing characteristics that can be replicated.\"\n              }\n            }\n          },\n          {\n            \"id\": \"store-style\",\n            \"name\": \"Store Writing Style\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"typeVersion\": 3.4,\n            \"position\": [\n              800,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"style-data\",\n                    \"name\": \"userStyleProfile\",\n                    \"value\": \"={{ $json.output }}\",\n                    \"type\": \"string\"\n                  },\n                  {\n                    \"id\": \"timestamp\",\n                    \"name\": \"lastUpdated\",\n                    \"value\": \"={{ $now.toISOString() }}\",\n                    \"type\": \"string\"\n                  }\n                ]\n              },\n              \"options\": {}\n            }\n          }\n        ],\n        \"connections\": {\n          \"Style Learning Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fetch Recent Sent Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Fetch Recent Sent Emails\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Writing Style Analyzer\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Writing Style Analyzer\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Store Writing Style\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"4f9e539f-6826-4221-a244-61c50f395a69\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-24T11:46:44.340Z\",\n        \"updatedAt\": \"2025-11-24T12:24:30.000Z\",\n        \"id\": \"l5grHFX3Ha93k0fZ\",\n        \"name\": \"Enhanced Complex Workflow Test\",\n        \"active\": false,\n        \"isArchived\": true,\n        \"nodes\": [\n          {\n            \"id\": \"webhook_0\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"name\": \"Webhook\",\n            \"parameters\": {\n              \"path\": \"webhook-data\",\n              \"httpMethod\": \"POST\",\n              \"responseMode\": \"responseNode\"\n            },\n            \"position\": [\n              240,\n              300\n            ],\n            \"webhookId\": \"dris714jm\",\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"email_trigger_1\",\n            \"type\": \"n8n-nodes-base.emailReadImap\",\n            \"name\": \"Email Trigger 2\",\n            \"parameters\": {\n              \"mailbox\": \"INBOX\",\n              \"action\": \"read\",\n              \"format\": \"simple\"\n            },\n            \"position\": [\n              460,\n              300\n            ],\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"v9q20thqu\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"name\": \"Validate Data 3\",\n            \"parameters\": {\n              \"functionCode\": \"\\n            // Validate incoming data\\n            const errors = [];\\n            const data = $input.first().json;\\n            \\n            // Check required fields\\n            if (!data.id) errors.push('Missing required field: id');\\n            if (!data.email || !data.email.includes('@')) errors.push('Invalid email address');\\n            \\n            if (errors.length > 0) {\\n              throw new Error('Validation failed: ' + errors.join(', '));\\n            }\\n            \\n            return [{\\n              ...data,\\n              validated: true,\\n              validatedAt: new Date().toISOString()\\n            }];\\n          \"\n            },\n            \"position\": [\n              840,\n              300\n            ],\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"p4sldg908\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"name\": \"Switch 4\",\n            \"parameters\": {\n              \"conditions\": {\n                \"options\": {\n                  \"caseSensitive\": true,\n                  \"leftValue\": \"\",\n                  \"typeValidation\": \"strict\"\n                },\n                \"conditions\": [\n                  {\n                    \"leftValue\": \"={{ $json.type }}\",\n                    \"rightValue\": \"email\",\n                    \"operator\": {\n                      \"type\": \"string\",\n                      \"operation\": \"equals\"\n                    }\n                  }\n                ]\n              },\n              \"fallbackOutput\": 0\n            },\n            \"position\": [\n              1140,\n              300\n            ],\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"xdvhprjwh\",\n            \"type\": \"n8n-nodes-base.send-email\",\n            \"name\": \"Send Email 5\",\n            \"parameters\": {\n              \"subject\": \"Workflow Notification\",\n              \"text\": \"={{ JSON.stringify($json, null, 2) }}\",\n              \"toEmail\": \"recipient@example.com\",\n              \"options\": {}\n            },\n            \"position\": [\n              1440,\n              300\n            ],\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"rsevupwh6\",\n            \"type\": \"n8n-nodes-base.httpRequest\",\n            \"name\": \"HTTP Request 6\",\n            \"parameters\": {\n              \"url\": \"https://api.example.com/endpoint\",\n              \"method\": \"POST\",\n              \"sendBody\": true,\n              \"bodyContentType\": \"json\",\n              \"jsonBody\": \"={{ $json }}\",\n              \"options\": {}\n            },\n            \"position\": [\n              240,\n              500\n            ],\n            \"typeVersion\": 5\n          },\n          {\n            \"id\": \"poycr78at\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"name\": \"Process Data 7\",\n            \"parameters\": {\n              \"functionCode\": \"\\n            // Process the incoming data\\n            const processedData = {\\n              timestamp: new Date().toISOString(),\\n              originalData: $input.all(),\\n              processed: true\\n            };\\n            \\n            return [processedData];\\n          \"\n            },\n            \"position\": [\n              540,\n              500\n            ],\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"6xoy19lcg\",\n            \"type\": \"n8n-nodes-base.merge\",\n            \"name\": \"Merge Data 8\",\n            \"parameters\": {\n              \"mode\": \"combine\",\n              \"combineBy\": \"combineByPosition\",\n              \"options\": {}\n            },\n            \"position\": [\n              840,\n              500\n            ],\n            \"typeVersion\": 3\n          },\n          {\n            \"id\": \"d9ec72xiz\",\n            \"type\": \"n8n-nodes-base.function\",\n            \"name\": \"Error Handler 9\",\n            \"parameters\": {\n              \"functionCode\": \"\\n            // Handle errors gracefully\\n            try {\\n              const data = $input.first().json;\\n              \\n              return [{\\n                success: true,\\n                data: data,\\n                processedAt: new Date().toISOString()\\n              }];\\n            } catch (error) {\\n              return [{\\n                success: false,\\n                error: error.message,\\n                timestamp: new Date().toISOString(),\\n                retryRecommended: true\\n              }];\\n            }\\n          \"\n            },\n            \"position\": [\n              1140,\n              500\n            ],\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"tg3qqdslh\",\n            \"type\": \"n8n-nodes-base.merge\",\n            \"name\": \"Merge Data 10\",\n            \"parameters\": {\n              \"mode\": \"combine\",\n              \"combineBy\": \"combineByPosition\",\n              \"options\": {}\n            },\n            \"position\": [\n              1440,\n              500\n            ],\n            \"typeVersion\": 3\n          }\n        ],\n        \"connections\": {\n          \"Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Validate Data 3\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Validate Data 3\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Switch 4\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Switch 4\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Email 5\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"HTTP Request 6\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Process Data 7\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Send Email 5\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Merge Data 8\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"HTTP Request 6\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Merge Data 8\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Data 7\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Merge Data 8\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Merge Data 8\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Error Handler 9\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Error Handler 9\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Merge Data 10\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"187cd10b-9d40-4916-9c6a-041944cef4a7\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-13T13:22:47.171Z\",\n        \"updatedAt\": \"2025-11-24T12:24:22.000Z\",\n        \"id\": \"nIa5IwRrxKIsOyIw\",\n        \"name\": \"MCP Test Workflow\",\n        \"active\": false,\n        \"isArchived\": true,\n        \"nodes\": [\n          {\n            \"id\": \"webhook1\",\n            \"name\": \"Test Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"typeVersion\": 2,\n            \"position\": [\n              300,\n              300\n            ],\n            \"parameters\": {\n              \"httpMethod\": \"GET\",\n              \"path\": \"mcp-test\"\n            }\n          }\n        ],\n        \"connections\": {\n          \"Test Webhook\": {\n            \"main\": []\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"e79a6ee9-ec44-440a-8a02-8176ab597074\",\n        \"triggerCount\": 1,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-22T18:25:55.022Z\",\n        \"updatedAt\": \"2025-11-22T18:25:55.022Z\",\n        \"id\": \"oE8DyGVlxgAoRS8B\",\n        \"name\": \"Teams-Outlook RAG Assistant (Agent Generated)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              0\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"3ed8e959-efc2-400f-9abb-bb30cb798e46\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              0\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body and metadata\\nreturn items;\"\n            },\n            \"id\": \"ff049707-1bc7-453c-8758-10eb8043a1b5\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              -150\n            ],\n            \"parameters\": {\n              \"mode\": \"text\"\n            },\n            \"id\": \"f260e769-ac53-4603-8eb7-0946b83777c3\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"148f2e1a-d85a-457f-ba07-a078fb05160d\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"3463ecb6-0fe7-4bcd-808a-21456c83adb7\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              400\n            ],\n            \"parameters\": {},\n            \"id\": \"0f8c0b55-0941-4cf6-9ea5-767f512b02ab\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Format teams message for AI\\nreturn items;\"\n            },\n            \"id\": \"4deb5f86-cd78-4211-9610-d1dc5158b3dd\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"systemMessage\": \"You are a helpful Outlook & Teams assistant.\"\n              }\n            },\n            \"id\": \"d1e2fbc6-c394-4e5e-be91-d708c03591c2\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              800,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"1161f00d-a122-4b96-b1fc-2ded182e7adb\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Postgres Memory\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"position\": [\n              400,\n              600\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\"\n            },\n            \"id\": \"f1ab2529-226d-49d6-ad7e-8e8b1235a57d\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Search Emails\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              500,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"1c77237f-812c-4eef-a192-aafb5be30119\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Get Calendar Events\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              650,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"9bd88332-9bc4-4a4a-a458-e2984d0c2d0e\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Calendar Event\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              800,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"3c58cdca-781d-463d-a015-665f725e3f87\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              950,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"ba9bc754-28f0-45cb-a9ff-0052bafbb133\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Email\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              1100,\n              600\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"send\"\n            },\n            \"id\": \"f3d07be2-ea04-49e9-bfc3-a845539fb959\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAiChatModel\",\n            \"position\": [\n              200,\n              400\n            ],\n            \"parameters\": {\n              \"model\": \"gpt-4o\"\n            },\n            \"id\": \"215c72f0-cca7-468e-a1f6-1cb32e7d4e9e\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Window Buffer Memory\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              200,\n              550\n            ],\n            \"parameters\": {},\n            \"id\": \"9e0383d7-2fda-48ef-80c7-5a8532058ecd\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Postgres Memory\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Search Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Get Calendar Events\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Calendar Event\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Send Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Window Buffer Memory\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"db92586e-bc60-4825-bd62-6dbdac194cff\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-22T11:58:16.729Z\",\n        \"updatedAt\": \"2025-11-22T11:58:16.729Z\",\n        \"id\": \"qnOCZ2d06t7ecrLl\",\n        \"name\": \"Teams-Outlook RAG Assistant (Agent Generated)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              0\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"a33dfae5-f8b0-4bcf-b676-b75bb75bc2c5\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              0\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body and metadata\\nreturn items;\"\n            },\n            \"id\": \"aef1e4fc-69cd-479f-8222-11d569e71e72\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"n8n-nodes-base.aiAgent\",\n            \"position\": [\n              500,\n              -150\n            ],\n            \"parameters\": {\n              \"mode\": \"text\"\n            },\n            \"id\": \"9a746624-b50a-4ad9-ad6e-99f772d4498b\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"n8n-nodes-base.aiAgent\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"31d8b747-9b64-43c6-8eb0-6285109130a6\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"n8n-nodes-base.aiAgent\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"9c0801fd-430a-4b53-9977-b111f1e86fc5\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              400\n            ],\n            \"parameters\": {},\n            \"id\": \"75e77b8e-e251-4ce2-9d05-2655e75328cc\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Format teams message for AI\\nreturn items;\"\n            },\n            \"id\": \"6225b24c-2c27-4e8f-a81a-56c17c9f0a6f\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"n8n-nodes-base.aiAgent\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"systemMessage\": \"You are a helpful Outlook & Teams assistant.\"\n              }\n            },\n            \"id\": \"149dffb1-708a-48d6-a4b1-a881e9de1bd1\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              800,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"1ed7307b-4c53-41ec-99f1-b5da92bfc312\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Postgres Memory\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"position\": [\n              400,\n              650\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\"\n            },\n            \"id\": \"ac359ba3-2891-4d1c-8f93-71eeda379939\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Email Search Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              500,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"c8212a84-a19a-4393-95a1-6c6294ed2bd8\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Calendar Management\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              600,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"0d79e3c5-1393-4956-b2d0-3d8964935e08\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              700,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"60cacfa0-ca5d-416b-bb05-52f9c72693d2\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Postgres Memory\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Email Search Tool\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Calendar Management\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"d692bedd-b745-4ad3-877f-8261998c1104\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-06-19T16:16:16.236Z\",\n        \"updatedAt\": \"2025-06-19T16:17:37.000Z\",\n        \"id\": \"rbg27jIt6Fvemq1m\",\n        \"name\": \"Complete n8n Workflow\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"parameters\": {\n              \"path\": \"ai-email-assistant\",\n              \"responseMode\": \"responseNode\",\n              \"options\": {}\n            },\n            \"id\": \"c1c7722b-71fe-49bd-a773-7bc82e0d3a68\",\n            \"name\": \"AI Assistant Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              -600,\n              100\n            ],\n            \"webhookId\": \"ai-email-assistant-main\"\n          },\n          {\n            \"parameters\": {\n              \"httpMethod\": \"POST\",\n              \"path\": \"open-webui-integration\",\n              \"responseMode\": \"responseNode\",\n              \"options\": {\n                \"rawBody\": false\n              }\n            },\n            \"id\": \"f96098fa-b767-4af0-9e2a-d3b55dc7c2fb\",\n            \"name\": \"Open WebUI Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              -600,\n              300\n            ],\n            \"webhookId\": \"e22ab2e6-8fb5-4c97-bb10-c7b67571a884\"\n          },\n          {\n            \"parameters\": {\n              \"jsCode\": \"// Input validation and routing logic\\nconst input = $input.all();\\nconst processedItems = [];\\n\\nfor (const item of input) {\\n  const data = item.json;\\n  \\n  // Determine input source\\n  let inputText = '';\\n  let hasAttachments = false;\\n  let action = 'chat';\\n  \\n  if (data.chatInput) {\\n    // From chat interface\\n    inputText = data.chatInput;\\n    hasAttachments = data.attachments && data.attachments.length > 0;\\n  } else if (data.body || data.message) {\\n    // From Open WebUI or direct API\\n    inputText = data.body || data.message;\\n  }\\n  \\n  // Parse action from input\\n  if (inputText.toLowerCase().includes('draft email') || inputText.toLowerCase().includes('compose email')) {\\n    action = 'draft';\\n  } else if (inputText.toLowerCase().includes('schedule meeting') || inputText.toLowerCase().includes('calendar')) {\\n    action = 'calendar';\\n  } else if (inputText.toLowerCase().includes('search email') || inputText.toLowerCase().includes('find email')) {\\n    action = 'search';\\n  }\\n  \\n  processedItems.push({\\n    json: {\\n      inputText,\\n      action,\\n      hasAttachments,\\n      originalData: data,\\n      timestamp: new Date().toISOString()\\n    },\\n    binary: item.binary || {}\\n  });\\n}\\n\\nreturn processedItems;\"\n            },\n            \"id\": \"f4253aa3-200c-44ed-bc80-b8b2664eb299\",\n            \"name\": \"Input Processor\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"typeVersion\": 2,\n            \"position\": [\n              -400,\n              200\n            ]\n          },\n          {\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": true,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\"\n                      },\n                      \"conditions\": [\n                        {\n                          \"id\": \"draft_condition\",\n                          \"leftValue\": \"={{ $json.action }}\",\n                          \"rightValue\": \"draft\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"and\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"draft_email\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": true,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\"\n                      },\n                      \"conditions\": [\n                        {\n                          \"id\": \"search_condition\",\n                          \"leftValue\": \"={{ $json.action }}\",\n                          \"rightValue\": \"search\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"and\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"search_email\"\n                  },\n                  {\n                    \"conditions\": {\n                      \"options\": {\n                        \"caseSensitive\": true,\n                        \"leftValue\": \"\",\n                        \"typeValidation\": \"strict\"\n                      },\n                      \"conditions\": [\n                        {\n                          \"id\": \"calendar_condition\",\n                          \"leftValue\": \"={{ $json.action }}\",\n                          \"rightValue\": \"calendar\",\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          }\n                        }\n                      ],\n                      \"combinator\": \"and\"\n                    },\n                    \"renameOutput\": true,\n                    \"outputKey\": \"calendar_action\"\n                  }\n                ]\n              },\n              \"options\": {\n                \"fallbackOutput\": \"extra\",\n                \"allMatchingOutputs\": false\n              }\n            },\n            \"id\": \"5a21a728-47fb-40e0-b04c-fd1608b964c1\",\n            \"name\": \"Action Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"typeVersion\": 3,\n            \"position\": [\n              -200,\n              200\n            ]\n          },\n          {\n            \"parameters\": {\n              \"workflowId\": \"draft_generation_workflow\",\n              \"options\": {}\n            },\n            \"id\": \"96a4599a-f4a9-48bc-884c-dc684f6d3828\",\n            \"name\": \"Execute Draft Workflow\",\n            \"type\": \"n8n-nodes-base.executeWorkflow\",\n            \"typeVersion\": 1,\n            \"position\": [\n              0,\n              0\n            ]\n          },\n          {\n            \"parameters\": {\n              \"workflowId\": \"email_search_workflow\",\n              \"options\": {}\n            },\n            \"id\": \"be4a5448-3882-48d1-bf2b-0519afd0aefe\",\n            \"name\": \"Execute Search Workflow\",\n            \"type\": \"n8n-nodes-base.executeWorkflow\",\n            \"typeVersion\": 1,\n            \"position\": [\n              0,\n              200\n            ]\n          },\n          {\n            \"parameters\": {\n              \"workflowId\": \"calendar_management_workflow\",\n              \"options\": {}\n            },\n            \"id\": \"ff15bf86-50a8-4e4c-84e8-1688ba148ce0\",\n            \"name\": \"Execute Calendar Workflow\",\n            \"type\": \"n8n-nodes-base.executeWorkflow\",\n            \"typeVersion\": 1,\n            \"position\": [\n              0,\n              400\n            ]\n          },\n          {\n            \"parameters\": {},\n            \"id\": \"835a5fcd-1e06-484b-9cd3-45d01dde9b1a\",\n            \"name\": \"General AI Agent\",\n            \"type\": \"n8n-nodes-base.openAi\",\n            \"typeVersion\": 1.3,\n            \"position\": [\n              0,\n              600\n            ]\n          },\n          {\n            \"parameters\": {\n              \"jsCode\": \"// Merge and format responses from different workflows\\nconst input = $input.all();\\nlet response = '';\\nlet status = 'success';\\nlet data = {};\\n\\nfor (const item of input) {\\n  if (item.json.response) {\\n    response = item.json.response;\\n    data = item.json.data || {};\\n  } else if (item.json.choices && item.json.choices[0]) {\\n    response = item.json.choices[0].message.content;\\n  } else if (item.json.message) {\\n    response = item.json.message;\\n  }\\n}\\n\\nreturn [{\\n  json: {\\n    response,\\n    status,\\n    data,\\n    timestamp: new Date().toISOString()\\n  }\\n}];\"\n            },\n            \"id\": \"b5870300-14c1-482c-b730-6f76afa7ff78\",\n            \"name\": \"Response Formatter\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"typeVersion\": 2,\n            \"position\": [\n              200,\n              300\n            ]\n          },\n          {\n            \"parameters\": {\n              \"respondWith\": \"json\",\n              \"responseBody\": \"={{ $json }}\",\n              \"options\": {}\n            },\n            \"id\": \"4635d7d2-df19-4c05-a147-1f1795de1531\",\n            \"name\": \"Webhook Response\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"typeVersion\": 1.1,\n            \"position\": [\n              400,\n              300\n            ]\n          },\n          {\n            \"parameters\": {\n              \"jsCode\": \"// Error handling and logging\\nconst error = $input.first().json;\\nconst errorMessage = error.message || 'Unknown error occurred';\\nconst errorDetails = error.stack || '';\\n\\n// Log error to console\\nconsole.error('Workflow Error:', errorMessage, errorDetails);\\n\\nreturn [{\\n  json: {\\n    response: 'I encountered an error processing your request. Please try again or contact support.',\\n    status: 'error',\\n    error: errorMessage,\\n    timestamp: new Date().toISOString()\\n  }\\n}];\"\n            },\n            \"id\": \"044ccf67-f503-4ac3-99ee-dbbbb943f6b5\",\n            \"name\": \"Error Handler\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"typeVersion\": 2,\n            \"position\": [\n              200,\n              500\n            ]\n          }\n        ],\n        \"connections\": {\n          \"AI Assistant Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Input Processor\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Open WebUI Webhook\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Input Processor\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Input Processor\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Action Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Action Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Execute Draft Workflow\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Execute Search Workflow\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Execute Calendar Workflow\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Execute Draft Workflow\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Response Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Execute Search Workflow\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Response Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Execute Calendar Workflow\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Response Formatter\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Response Formatter\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Webhook Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Error Handler\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Webhook Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\"\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"d1bdb965-1f24-4de4-a16d-76174a41e4be\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-24T05:26:12.646Z\",\n        \"updatedAt\": \"2025-11-24T05:26:12.646Z\",\n        \"id\": \"tbdgq0FZmJKLQlsl\",\n        \"name\": \"Ultimate Outlook AI Assistant - Open WebUI (Updated via MCP)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"webui-webhook\",\n            \"name\": \"Open WebUI Chat Interface\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"position\": [\n              280,\n              300\n            ],\n            \"parameters\": {\n              \"httpMethod\": \"POST\",\n              \"path\": \"email-assistant\",\n              \"responseMode\": \"responseNode\",\n              \"options\": {}\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"parse-input\",\n            \"name\": \"Parse Chat Input\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              500,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"userMessage\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.message || $json.body.text || $json.query.message }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.sessionId || $json.query.sessionId || 'default' }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"userId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.userId || $json.query.userId || 'user' }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"email-trigger\",\n            \"name\": \"Email Processing Trigger\",\n            \"type\": \"n8n-nodes-base.manualTrigger\",\n            \"position\": [\n              280,\n              600\n            ],\n            \"parameters\": {},\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"get-emails\",\n            \"name\": \"Get Unprocessed Emails\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              500,\n              600\n            ],\n            \"parameters\": {\n              \"limit\": 15,\n              \"resource\": \"message\",\n              \"operation\": \"getAll\",\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"custom\": \"flag/flagStatus eq 'notFlagged' and not categories/any()\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"split-emails\",\n            \"name\": \"Process Each Email\",\n            \"type\": \"n8n-nodes-base.splitInBatches\",\n            \"position\": [\n              720,\n              600\n            ],\n            \"parameters\": {\n              \"batchSize\": 1,\n              \"options\": {}\n            },\n            \"typeVersion\": 3\n          },\n          {\n            \"id\": \"clean-content\",\n            \"name\": \"Clean Email Content\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n            \"position\": [\n              940,\n              600\n            ],\n            \"parameters\": {\n              \"modelId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"content\": \"Clean and extract key information from this email, removing HTML while preserving structure:\\n\\n{{ $json.body.content }}\"\n                  }\n                ]\n              },\n              \"operation\": \"text\"\n            },\n            \"typeVersion\": 1.8\n          },\n          {\n            \"id\": \"extract-metadata\",\n            \"name\": \"Extract Email Metadata\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              1160,\n              600\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"emailId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.id }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"subject\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.subject }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"sender\",\n                    \"type\": \"object\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.sender.emailAddress }}\"\n                  },\n                  {\n                    \"id\": \"4\",\n                    \"name\": \"cleanBody\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Clean Email Content').item.json.message.content }}\"\n                  },\n                  {\n                    \"id\": \"5\",\n                    \"name\": \"hasAttachments\",\n                    \"type\": \"boolean\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.hasAttachments }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"classify-email\",\n            \"name\": \"AI Email Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.textClassifier\",\n            \"position\": [\n              1380,\n              600\n            ],\n            \"parameters\": {\n              \"inputText\": \"{{ $json.cleanBody }}\",\n              \"categories\": {\n                \"categories\": [\n                  {\n                    \"category\": \"urgent_action\",\n                    \"description\": \"Emails requiring immediate attention: escalations, critical issues, deadlines, system failures\"\n                  },\n                  {\n                    \"category\": \"business_inquiry\",\n                    \"description\": \"Business opportunities: project inquiries, partnership requests, sales leads\"\n                  },\n                  {\n                    \"category\": \"support_request\",\n                    \"description\": \"Technical support: customer service, troubleshooting, help requests\"\n                  },\n                  {\n                    \"category\": \"billing_finance\",\n                    \"description\": \"Financial matters: invoices, payments, receipts, accounting\"\n                  },\n                  {\n                    \"category\": \"meeting_calendar\",\n                    \"description\": \"Scheduling: meeting requests, calendar invites, appointments\"\n                  },\n                  {\n                    \"category\": \"spam_junk\",\n                    \"description\": \"Unwanted content: spam, phishing, suspicious emails\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"route-category\",\n            \"name\": \"Email Category Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"position\": [\n              1600,\n              600\n            ],\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"outputKey\": \"urgent\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"urgent_action\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  },\n                  {\n                    \"outputKey\": \"business\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"business_inquiry\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  },\n                  {\n                    \"outputKey\": \"spam\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"spam_junk\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.2\n          },\n          {\n            \"id\": \"business-agent\",\n            \"name\": \"Business Inquiry Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              1820,\n              500\n            ],\n            \"parameters\": {\n              \"text\": \"Process this business inquiry:\\n\\nFrom: {{ $json.sender.name }} ({{ $json.sender.address }})\\nSubject: {{ $json.subject }}\\nContent: {{ $json.cleanBody }}\",\n              \"options\": {\n                \"systemMessage\": \"You are a professional business development assistant. For business inquiries:\\n1. Analyze the opportunity and requirements\\n2. Search knowledge base for relevant information\\n3. Create professional draft responses\\n4. Include relevant company capabilities\\n5. Suggest next steps\\n\\nUse the Create Draft tool to generate responses and Knowledge Search to find relevant context.\"\n              },\n              \"promptType\": \"define\"\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"move-spam\",\n            \"name\": \"Move Spam to Junk\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              1820,\n              700\n            ],\n            \"parameters\": {\n              \"folderId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"junk\"\n              },\n              \"messageId\": \"={{ $json.emailId }}\",\n              \"operation\": \"move\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"main-agent\",\n            \"name\": \"Main Email Assistant\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              720,\n              300\n            ],\n            \"parameters\": {\n              \"text\": \"{{ $json.userMessage }}\",\n              \"options\": {\n                \"systemMessage\": \"You are an intelligent email assistant with comprehensive capabilities:\\n\\n**EMAIL MANAGEMENT:**\\n- Search emails by sender, subject, content, or date\\n- Create and send professional responses\\n- Categorize and organize emails\\n- Handle attachments and extract information\\n\\n**CALENDAR FUNCTIONS:**\\n- Check availability and schedule meetings\\n- Manage calendar events and appointments\\n- Send meeting invitations\\n\\n**KNOWLEDGE & CONTEXT:**\\n- Search email history for past communications\\n- Access knowledge base for relevant information\\n- Provide context from previous interactions\\n\\n**COMMON COMMANDS:**\\n- 'Check emails from [sender]'\\n- 'Send email to [recipient] about [topic]'\\n- 'Schedule meeting with [person]'\\n- 'Show urgent emails'\\n- 'Create draft response'\\n- 'What meetings do I have today?'\\n- 'Search emails about [topic]'\\n\\nAlways confirm important actions before executing. Provide clear, actionable responses.\"\n              },\n              \"promptType\": \"define\"\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"create-draft-tool\",\n            \"name\": \"Create Draft Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              200\n            ],\n            \"parameters\": {\n              \"subject\": \"={{ $json.draft_subject || '' }}\",\n              \"resource\": \"draft\",\n              \"bodyContent\": \"={{ $json.draft_body || '' }}\",\n              \"additionalFields\": {\n                \"toRecipients\": \"={{ $json.draft_recipients || '' }}\"\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"send-email-tool\",\n            \"name\": \"Send Email Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              100\n            ],\n            \"parameters\": {\n              \"subject\": \"={{ $json.email_subject || '' }}\",\n              \"bodyContent\": \"={{ $json.email_body || '' }}\",\n              \"toRecipients\": \"={{ $json.email_recipients || '' }}\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"search-emails-tool\",\n            \"name\": \"Search Emails Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              400\n            ],\n            \"parameters\": {\n              \"limit\": 10,\n              \"operation\": \"getAll\",\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"search\": \"={{ $json.search_query || '' }}\",\n                    \"sender\": \"={{ $json.sender_filter || '' }}\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"knowledge-tool\",\n            \"name\": \"Knowledge Search Tool\",\n            \"type\": \"@n8n/n8n-nodes-langchain.vectorStorePGVector\",\n            \"position\": [\n              1160,\n              400\n            ],\n            \"parameters\": {\n              \"mode\": \"retrieve-as-tool\",\n              \"toolName\": \"knowledge_search\",\n              \"tableName\": \"email_knowledge\",\n              \"toolDescription\": \"Search email history and knowledge base for relevant context, past communications, and information\"\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"openai-model\",\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"position\": [\n              1160,\n              200\n            ],\n            \"parameters\": {\n              \"model\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"options\": {\n                \"temperature\": 0.3\n              }\n            },\n            \"typeVersion\": 1.2\n          },\n          {\n            \"id\": \"memory-buffer\",\n            \"name\": \"Memory Buffer\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              1160,\n              100\n            ],\n            \"parameters\": {\n              \"sessionKey\": \"={{ $json.sessionId }}\",\n              \"sessionIdType\": \"customKey\"\n            },\n            \"typeVersion\": 1.3\n          },\n          {\n            \"id\": \"format-response\",\n            \"name\": \"Format Response for WebUI\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              940,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"response\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.output }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $now.toISOString() }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Parse Chat Input').item.json.sessionId }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"send-response\",\n            \"name\": \"Send Response to WebUI\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"position\": [\n              1160,\n              300\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"responseHeaders\": {\n                  \"Content-Type\": \"application/json\"\n                }\n              }\n            },\n            \"typeVersion\": 1.1\n          },\n          {\n            \"id\": \"update-categories\",\n            \"name\": \"Update Email Categories\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              1820,\n              600\n            ],\n            \"parameters\": {\n              \"messageId\": \"={{ $json.emailId }}\",\n              \"operation\": \"update\",\n              \"updateFields\": {\n                \"categories\": [\n                  \"{{ $('AI Email Classifier').item.json.category }}\"\n                ]\n              }\n            },\n            \"typeVersion\": 2\n          }\n        ],\n        \"connections\": {\n          \"Open WebUI Chat Interface\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Parse Chat Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Parse Chat Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Main Email Assistant\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Processing Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Get Unprocessed Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Get Unprocessed Emails\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Each Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Each Email\": {\n            \"main\": [\n              [],\n              [\n                {\n                  \"node\": \"Clean Email Content\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Clean Email Content\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Extract Email Metadata\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Extract Email Metadata\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Email Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Email Classifier\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Category Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Category Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Update Email Categories\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Business Inquiry Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Move Spam to Junk\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Main Email Assistant\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Format Response for WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Format Response for WebUI\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Response to WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"ai_languageModel\": [\n              {\n                \"node\": \"Business Inquiry Agent\"\n              },\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Memory Buffer\": {\n            \"ai_memory\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Create Draft Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              },\n              {\n                \"node\": \"Business Inquiry Agent\"\n              }\n            ]\n          },\n          \"Send Email Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Search Emails Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Knowledge Search Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              },\n              {\n                \"node\": \"Business Inquiry Agent\"\n              }\n            ]\n          },\n          \"Business Inquiry Agent\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Update Email Categories\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"34a8ceb4-0f25-409d-9ccd-59d233f0989e\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-07-16T21:57:45.874Z\",\n        \"updatedAt\": \"2025-11-24T12:24:19.000Z\",\n        \"id\": \"tzfdYTiQmCaW8NRr\",\n        \"name\": \"Test Workflow\",\n        \"active\": false,\n        \"isArchived\": true,\n        \"nodes\": [\n          {\n            \"id\": \"webhook1\",\n            \"name\": \"Webhook\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"typeVersion\": 1,\n            \"position\": [\n              100,\n              200\n            ],\n            \"parameters\": {\n              \"path\": \"/test\"\n            }\n          }\n        ],\n        \"connections\": {\n          \"Webhook\": {\n            \"main\": []\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"31c3f69a-a378-4b1d-a49a-0dc4af9b6ed9\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-24T05:35:23.760Z\",\n        \"updatedAt\": \"2025-11-24T05:35:23.760Z\",\n        \"id\": \"zLRgtz5o1dD6dVur\",\n        \"name\": \"Ultimate Outlook AI Assistant - Open WebUI (Updated via MCP) (RESTORED)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"id\": \"webui-webhook\",\n            \"name\": \"Open WebUI Chat Interface\",\n            \"type\": \"n8n-nodes-base.webhook\",\n            \"position\": [\n              280,\n              300\n            ],\n            \"parameters\": {\n              \"httpMethod\": \"POST\",\n              \"path\": \"email-assistant\",\n              \"responseMode\": \"responseNode\",\n              \"options\": {}\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"parse-input\",\n            \"name\": \"Parse Chat Input\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              500,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"userMessage\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.message || $json.body.text || $json.query.message }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.sessionId || $json.query.sessionId || 'default' }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"userId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.body.userId || $json.query.userId || 'user' }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"email-trigger\",\n            \"name\": \"Email Processing Trigger\",\n            \"type\": \"n8n-nodes-base.manualTrigger\",\n            \"position\": [\n              280,\n              600\n            ],\n            \"parameters\": {},\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"get-emails\",\n            \"name\": \"Get Unprocessed Emails\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              500,\n              600\n            ],\n            \"parameters\": {\n              \"limit\": 15,\n              \"resource\": \"message\",\n              \"operation\": \"getAll\",\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"custom\": \"flag/flagStatus eq 'notFlagged' and not categories/any()\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"split-emails\",\n            \"name\": \"Process Each Email\",\n            \"type\": \"n8n-nodes-base.splitInBatches\",\n            \"position\": [\n              720,\n              600\n            ],\n            \"parameters\": {\n              \"batchSize\": 1,\n              \"options\": {}\n            },\n            \"typeVersion\": 3\n          },\n          {\n            \"id\": \"clean-content\",\n            \"name\": \"Clean Email Content\",\n            \"type\": \"@n8n/n8n-nodes-langchain.openAi\",\n            \"position\": [\n              940,\n              600\n            ],\n            \"parameters\": {\n              \"modelId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"messages\": {\n                \"values\": [\n                  {\n                    \"content\": \"Clean and extract key information from this email, removing HTML while preserving structure:\\n\\n{{ $json.body.content }}\"\n                  }\n                ]\n              },\n              \"operation\": \"text\"\n            },\n            \"typeVersion\": 1.8\n          },\n          {\n            \"id\": \"extract-metadata\",\n            \"name\": \"Extract Email Metadata\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              1160,\n              600\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"emailId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.id }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"subject\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.subject }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"sender\",\n                    \"type\": \"object\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.sender.emailAddress }}\"\n                  },\n                  {\n                    \"id\": \"4\",\n                    \"name\": \"cleanBody\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Clean Email Content').item.json.message.content }}\"\n                  },\n                  {\n                    \"id\": \"5\",\n                    \"name\": \"hasAttachments\",\n                    \"type\": \"boolean\",\n                    \"value\": \"={{ $('Get Unprocessed Emails').item.json.hasAttachments }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"classify-email\",\n            \"name\": \"AI Email Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.textClassifier\",\n            \"position\": [\n              1380,\n              600\n            ],\n            \"parameters\": {\n              \"inputText\": \"{{ $json.cleanBody }}\",\n              \"categories\": {\n                \"categories\": [\n                  {\n                    \"category\": \"urgent_action\",\n                    \"description\": \"Emails requiring immediate attention: escalations, critical issues, deadlines, system failures\"\n                  },\n                  {\n                    \"category\": \"business_inquiry\",\n                    \"description\": \"Business opportunities: project inquiries, partnership requests, sales leads\"\n                  },\n                  {\n                    \"category\": \"support_request\",\n                    \"description\": \"Technical support: customer service, troubleshooting, help requests\"\n                  },\n                  {\n                    \"category\": \"billing_finance\",\n                    \"description\": \"Financial matters: invoices, payments, receipts, accounting\"\n                  },\n                  {\n                    \"category\": \"meeting_calendar\",\n                    \"description\": \"Scheduling: meeting requests, calendar invites, appointments\"\n                  },\n                  {\n                    \"category\": \"spam_junk\",\n                    \"description\": \"Unwanted content: spam, phishing, suspicious emails\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"route-category\",\n            \"name\": \"Email Category Router\",\n            \"type\": \"n8n-nodes-base.switch\",\n            \"position\": [\n              1600,\n              600\n            ],\n            \"parameters\": {\n              \"rules\": {\n                \"values\": [\n                  {\n                    \"outputKey\": \"urgent\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"urgent_action\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  },\n                  {\n                    \"outputKey\": \"business\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"business_inquiry\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  },\n                  {\n                    \"outputKey\": \"spam\",\n                    \"conditions\": {\n                      \"options\": {\n                        \"version\": 2\n                      },\n                      \"conditions\": [\n                        {\n                          \"operator\": {\n                            \"type\": \"string\",\n                            \"operation\": \"equals\"\n                          },\n                          \"leftValue\": \"={{ $('AI Email Classifier').item.json.category }}\",\n                          \"rightValue\": \"spam_junk\"\n                        }\n                      ]\n                    },\n                    \"renameOutput\": true\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.2\n          },\n          {\n            \"id\": \"business-agent\",\n            \"name\": \"Business Inquiry Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              1820,\n              500\n            ],\n            \"parameters\": {\n              \"text\": \"Process this business inquiry:\\n\\nFrom: {{ $json.sender.name }} ({{ $json.sender.address }})\\nSubject: {{ $json.subject }}\\nContent: {{ $json.cleanBody }}\",\n              \"options\": {\n                \"systemMessage\": \"You are a professional business development assistant. For business inquiries:\\n1. Analyze the opportunity and requirements\\n2. Search knowledge base for relevant information\\n3. Create professional draft responses\\n4. Include relevant company capabilities\\n5. Suggest next steps\\n\\nUse the Create Draft tool to generate responses and Knowledge Search to find relevant context.\"\n              },\n              \"promptType\": \"define\"\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"move-spam\",\n            \"name\": \"Move Spam to Junk\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              1820,\n              700\n            ],\n            \"parameters\": {\n              \"folderId\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"junk\"\n              },\n              \"messageId\": \"={{ $json.emailId }}\",\n              \"operation\": \"move\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"main-agent\",\n            \"name\": \"Main Email Assistant\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              720,\n              300\n            ],\n            \"parameters\": {\n              \"text\": \"{{ $json.userMessage }}\",\n              \"options\": {\n                \"systemMessage\": \"You are an intelligent email assistant with comprehensive capabilities:\\n\\n**EMAIL MANAGEMENT:**\\n- Search emails by sender, subject, content, or date\\n- Create and send professional responses\\n- Categorize and organize emails\\n- Handle attachments and extract information\\n\\n**CALENDAR FUNCTIONS:**\\n- Check availability and schedule meetings\\n- Manage calendar events and appointments\\n- Send meeting invitations\\n\\n**KNOWLEDGE & CONTEXT:**\\n- Search email history for past communications\\n- Access knowledge base for relevant information\\n- Provide context from previous interactions\\n\\n**COMMON COMMANDS:**\\n- 'Check emails from [sender]'\\n- 'Send email to [recipient] about [topic]'\\n- 'Schedule meeting with [person]'\\n- 'Show urgent emails'\\n- 'Create draft response'\\n- 'What meetings do I have today?'\\n- 'Search emails about [topic]'\\n\\nAlways confirm important actions before executing. Provide clear, actionable responses.\"\n              },\n              \"promptType\": \"define\"\n            },\n            \"typeVersion\": 1.7\n          },\n          {\n            \"id\": \"create-draft-tool\",\n            \"name\": \"Create Draft Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              200\n            ],\n            \"parameters\": {\n              \"subject\": \"={{ $json.draft_subject || '' }}\",\n              \"resource\": \"draft\",\n              \"bodyContent\": \"={{ $json.draft_body || '' }}\",\n              \"additionalFields\": {\n                \"toRecipients\": \"={{ $json.draft_recipients || '' }}\"\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"send-email-tool\",\n            \"name\": \"Send Email Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              100\n            ],\n            \"parameters\": {\n              \"subject\": \"={{ $json.email_subject || '' }}\",\n              \"bodyContent\": \"={{ $json.email_body || '' }}\",\n              \"toRecipients\": \"={{ $json.email_recipients || '' }}\"\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"search-emails-tool\",\n            \"name\": \"Search Emails Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTool\",\n            \"position\": [\n              940,\n              400\n            ],\n            \"parameters\": {\n              \"limit\": 10,\n              \"operation\": \"getAll\",\n              \"filtersUI\": {\n                \"values\": {\n                  \"filters\": {\n                    \"search\": \"={{ $json.search_query || '' }}\",\n                    \"sender\": \"={{ $json.sender_filter || '' }}\"\n                  }\n                }\n              }\n            },\n            \"typeVersion\": 2\n          },\n          {\n            \"id\": \"knowledge-tool\",\n            \"name\": \"Knowledge Search Tool\",\n            \"type\": \"@n8n/n8n-nodes-langchain.vectorStorePGVector\",\n            \"position\": [\n              1160,\n              400\n            ],\n            \"parameters\": {\n              \"mode\": \"retrieve-as-tool\",\n              \"toolName\": \"knowledge_search\",\n              \"tableName\": \"email_knowledge\",\n              \"toolDescription\": \"Search email history and knowledge base for relevant context, past communications, and information\"\n            },\n            \"typeVersion\": 1\n          },\n          {\n            \"id\": \"openai-model\",\n            \"name\": \"OpenAI Chat Model\",\n            \"type\": \"@n8n/n8n-nodes-langchain.lmChatOpenAi\",\n            \"position\": [\n              1160,\n              200\n            ],\n            \"parameters\": {\n              \"model\": {\n                \"__rl\": true,\n                \"mode\": \"list\",\n                \"value\": \"gpt-4o-mini\"\n              },\n              \"options\": {\n                \"temperature\": 0.3\n              }\n            },\n            \"typeVersion\": 1.2\n          },\n          {\n            \"id\": \"memory-buffer\",\n            \"name\": \"Memory Buffer\",\n            \"type\": \"@n8n/n8n-nodes-langchain.memoryBufferWindow\",\n            \"position\": [\n              1160,\n              100\n            ],\n            \"parameters\": {\n              \"sessionKey\": \"={{ $json.sessionId }}\",\n              \"sessionIdType\": \"customKey\"\n            },\n            \"typeVersion\": 1.3\n          },\n          {\n            \"id\": \"format-response\",\n            \"name\": \"Format Response for WebUI\",\n            \"type\": \"n8n-nodes-base.set\",\n            \"position\": [\n              940,\n              300\n            ],\n            \"parameters\": {\n              \"assignments\": {\n                \"assignments\": [\n                  {\n                    \"id\": \"1\",\n                    \"name\": \"response\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $json.output }}\"\n                  },\n                  {\n                    \"id\": \"2\",\n                    \"name\": \"timestamp\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $now.toISOString() }}\"\n                  },\n                  {\n                    \"id\": \"3\",\n                    \"name\": \"sessionId\",\n                    \"type\": \"string\",\n                    \"value\": \"={{ $('Parse Chat Input').item.json.sessionId }}\"\n                  }\n                ]\n              }\n            },\n            \"typeVersion\": 3.4\n          },\n          {\n            \"id\": \"send-response\",\n            \"name\": \"Send Response to WebUI\",\n            \"type\": \"n8n-nodes-base.respondToWebhook\",\n            \"position\": [\n              1160,\n              300\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"responseHeaders\": {\n                  \"Content-Type\": \"application/json\"\n                }\n              }\n            },\n            \"typeVersion\": 1.1\n          },\n          {\n            \"id\": \"update-categories\",\n            \"name\": \"Update Email Categories\",\n            \"type\": \"n8n-nodes-base.outlook\",\n            \"position\": [\n              1820,\n              600\n            ],\n            \"parameters\": {\n              \"messageId\": \"={{ $json.emailId }}\",\n              \"operation\": \"update\",\n              \"updateFields\": {\n                \"categories\": [\n                  \"{{ $('AI Email Classifier').item.json.category }}\"\n                ]\n              }\n            },\n            \"typeVersion\": 2\n          }\n        ],\n        \"connections\": {\n          \"Open WebUI Chat Interface\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Parse Chat Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Parse Chat Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Main Email Assistant\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Processing Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Get Unprocessed Emails\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Get Unprocessed Emails\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Each Email\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Each Email\": {\n            \"main\": [\n              [],\n              [\n                {\n                  \"node\": \"Clean Email Content\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Clean Email Content\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Extract Email Metadata\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Extract Email Metadata\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Email Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Email Classifier\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Email Category Router\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Email Category Router\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Update Email Categories\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Business Inquiry Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ],\n              [\n                {\n                  \"node\": \"Move Spam to Junk\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Main Email Assistant\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Format Response for WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Format Response for WebUI\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Response to WebUI\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"OpenAI Chat Model\": {\n            \"ai_languageModel\": [\n              {\n                \"node\": \"Business Inquiry Agent\"\n              },\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Memory Buffer\": {\n            \"ai_memory\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Create Draft Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              },\n              {\n                \"node\": \"Business Inquiry Agent\"\n              }\n            ]\n          },\n          \"Send Email Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Search Emails Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              }\n            ]\n          },\n          \"Knowledge Search Tool\": {\n            \"ai_tool\": [\n              {\n                \"node\": \"Main Email Assistant\"\n              },\n              {\n                \"node\": \"Business Inquiry Agent\"\n              }\n            ]\n          },\n          \"Business Inquiry Agent\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Update Email Categories\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"saveExecutionProgress\": true,\n          \"saveManualExecutions\": true,\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"executionTimeout\": 3600,\n          \"timezone\": \"UTC\"\n        },\n        \"staticData\": {},\n        \"meta\": null,\n        \"versionId\": \"4a95fc13-342e-402e-8832-4e2f90b4a931\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      },\n      {\n        \"createdAt\": \"2025-11-22T12:04:07.970Z\",\n        \"updatedAt\": \"2025-11-22T12:04:07.970Z\",\n        \"id\": \"zsdsYxCJx1IXI29b\",\n        \"name\": \"Teams-Outlook RAG Assistant (Agent Generated)\",\n        \"active\": false,\n        \"isArchived\": false,\n        \"nodes\": [\n          {\n            \"name\": \"Outlook Email Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftOutlookTrigger\",\n            \"position\": [\n              0,\n              0\n            ],\n            \"parameters\": {\n              \"pollInterval\": 60\n            },\n            \"id\": \"0030ff6f-73b6-41b9-ad9b-2e2385db7996\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Email for RAG\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              0\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Extract email body and metadata\\nreturn items;\"\n            },\n            \"id\": \"561c7354-aabc-41b3-bc29-9f5fe98f165b\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Fraud Classifier\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              -150\n            ],\n            \"parameters\": {\n              \"mode\": \"text\"\n            },\n            \"id\": \"eb902071-bb14-49b9-b4b9-7b724f55e103\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Billing RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              0\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"183a2a4c-3aa4-4ffc-a76b-866d9e974263\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"High Priority RAG Agent\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              150\n            ],\n            \"parameters\": {\n              \"mode\": \"chat\"\n            },\n            \"id\": \"488d4e41-a70f-4996-bd9d-7959d0d8c6af\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Teams Message Trigger\",\n            \"type\": \"n8n-nodes-base.microsoftTeamsTrigger\",\n            \"position\": [\n              0,\n              400\n            ],\n            \"parameters\": {},\n            \"id\": \"e5d677c4-63a3-4f7f-9473-e1c4ede6598f\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Process Teams Input\",\n            \"type\": \"n8n-nodes-base.code\",\n            \"position\": [\n              250,\n              400\n            ],\n            \"parameters\": {\n              \"jsCode\": \"// Format teams message for AI\\nreturn items;\"\n            },\n            \"id\": \"3d3d55f8-1df3-4ed6-ac09-862b3f5ed1cb\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"AI Agent (Central)\",\n            \"type\": \"@n8n/n8n-nodes-langchain.agent\",\n            \"position\": [\n              500,\n              400\n            ],\n            \"parameters\": {\n              \"options\": {\n                \"systemMessage\": \"You are a helpful Outlook & Teams assistant.\"\n              }\n            },\n            \"id\": \"316d2c45-acc8-4f24-a7a7-bf32903a33b5\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Send Teams Response\",\n            \"type\": \"n8n-nodes-base.microsoftTeams\",\n            \"position\": [\n              800,\n              400\n            ],\n            \"parameters\": {\n              \"operation\": \"sendMessage\"\n            },\n            \"id\": \"49481f1e-2e19-445c-88fc-7004db4b55ca\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Postgres Memory\",\n            \"type\": \"n8n-nodes-base.postgres\",\n            \"position\": [\n              400,\n              650\n            ],\n            \"parameters\": {\n              \"operation\": \"executeQuery\"\n            },\n            \"id\": \"fb8210ea-7c5b-4e64-89fd-afb49887ad77\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Email Search Tool\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              500,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"db8f7c29-6e55-4d30-8c16-63664108e592\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Calendar Management\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              600,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"event\",\n              \"operation\": \"getAll\"\n            },\n            \"id\": \"5569fd9d-e308-4777-85e6-a297808ff7ac\",\n            \"typeVersion\": 1\n          },\n          {\n            \"name\": \"Create Draft\",\n            \"type\": \"n8n-nodes-base.microsoftOutlook\",\n            \"position\": [\n              700,\n              650\n            ],\n            \"parameters\": {\n              \"resource\": \"message\",\n              \"operation\": \"create\"\n            },\n            \"id\": \"bfc08bb0-1e8b-4c96-9999-8700938e4cfe\",\n            \"typeVersion\": 1\n          }\n        ],\n        \"connections\": {\n          \"Outlook Email Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Email for RAG\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Email for RAG\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Fraud Classifier\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Billing RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"High Priority RAG Agent\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Teams Message Trigger\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Process Teams Input\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"Process Teams Input\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"AI Agent (Central)\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          },\n          \"AI Agent (Central)\": {\n            \"main\": [\n              [\n                {\n                  \"node\": \"Send Teams Response\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Postgres Memory\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Email Search Tool\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Calendar Management\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                },\n                {\n                  \"node\": \"Create Draft\",\n                  \"type\": \"main\",\n                  \"index\": 0\n                }\n              ]\n            ]\n          }\n        },\n        \"settings\": {\n          \"executionOrder\": \"v1\",\n          \"saveDataErrorExecution\": \"all\",\n          \"saveDataSuccessExecution\": \"all\",\n          \"saveManualExecutions\": true,\n          \"saveExecutionProgress\": true\n        },\n        \"staticData\": null,\n        \"meta\": null,\n        \"versionId\": \"3f1c3159-4588-48df-ae5c-40327e45c67d\",\n        \"triggerCount\": 0,\n        \"tags\": []\n      }\n    ],\n    \"nextCursor\": null,\n    \"total\": 45\n  }\n}"
    }
  ]
}
[2025-11-25T00:56:18.342Z] 
Response Text:
[2025-11-25T00:56:18.342Z] {
  "success": true,
  "data": {
    "workflows": [
      {
        "createdAt": "2025-11-22T11:57:53.354Z",
        "updatedAt": "2025-11-22T11:57:53.354Z",
        "id": "2vxQTBROMOu5N4ss",
        "name": "Teams-Outlook RAG Assistant (Agent Generated)",
        "active": false,
        "isArchived": false,
        "nodes": [
          {
            "name": "Outlook Email Trigger",
            "type": "n8n-nodes-base.microsoftOutlookTrigger",
            "position": [
              0,
        ...
[2025-11-25T00:56:18.344Z] 
Parsed Response:
[2025-11-25T00:56:18.344Z]   success: true
[2025-11-25T00:56:18.344Z]   data type: object
[2025-11-25T00:56:18.344Z]   data keys: workflows, nextCursor, total
[2025-11-25T00:56:18.344Z]   workflows count: 45
[2025-11-25T00:56:18.345Z] 
First 3 workflows:
[2025-11-25T00:56:18.345Z]     1. Teams-Outlook RAG Assistant (Agent Generated) (2vxQTBROMOu5N4ss)
[2025-11-25T00:56:18.345Z]     2. Draft Generation (5nwLsvR36Q9bACa5)
[2025-11-25T00:56:18.345Z]     3. Teams-Outlook RAG Assistant (Agent Generated) (6MDNTFs7ZBZKP8Dg)
[2025-11-25T00:56:18.345Z] 
‚úÖ Found target: "üéØ Ultimate AI Outlook Assistant - Proper Nodes" (Baf9nylVDD1pzj9Q)
[2025-11-25T00:56:18.345Z] 
STEP 3: Getting workflow details...
[2025-11-25T00:56:18.346Z] Request: { name: 'workflow_manager', arguments: { action: 'get', id: 'Baf9nylVDD1pzj9Q' } }
[2025-11-25T00:56:18.362Z] 
Raw MCP Response:
[2025-11-25T00:56:18.362Z] {
  "content": [
    {
      "type": "text",
      "text": "{\n  \"success\": true,\n  \"data\": {\n    \"createdAt\": \"2025-06-15T22:54:49.604Z\",\n    \"updatedAt\": \"2025-11-24T12:22:44.538Z\",\n    \"id\": \"Baf9nylVDD1pzj9Q\",\n    \"name\": \"üéØ Ultimate AI Outlook Assistant - Proper Nodes\",\n    \"active\": false,\n    \"isArchived\": false,\n    \"nodes\": [\n      {\n        \"id\": \"webhook_trigger\",\n        \"name\": \"üåê API Webhook\",\n        \"type\": \"n8n-nodes-base.webhook\",\n        \"position\": [\n          250,\n          300\n        ],\n        \"parameters\": {\n          \"path\": \"outlook-ai-ultimate\",\n          \"httpMethod\": \"POST\",\n          \"responseMode\": \"responseNode\"\n        },\n        \"typeVersion\": 1\n      },\n      {\n        \"id\": \"manual_trigger\",\n        \"name\": \"‚ñ∂Ô∏è Manual Test\",\n        \"type\": \"n8n-nodes-base.manualTrigger\",\n        \"position\": [\n          250,\n          500\n        ],\n        \"para...
[2025-11-25T00:56:18.362Z] 
Parsed Response:
[2025-11-25T00:56:18.362Z]   success: true
[2025-11-25T00:56:18.362Z]   ‚úÖ Got workflow with 8 nodes
[2025-11-25T00:56:18.363Z] 
STEP 4: Analyzing workflow structure...
[2025-11-25T00:56:18.363Z] 
Nodes (8):
[2025-11-25T00:56:18.363Z]   1. üåê API Webhook (n8n-nodes-base.webhook)
[2025-11-25T00:56:18.363Z]   2. ‚ñ∂Ô∏è Manual Test (n8n-nodes-base.manualTrigger)
[2025-11-25T00:56:18.363Z]   3. üß† Smart Request Router (n8n-nodes-base.code)
[2025-11-25T00:56:18.363Z]   4. üö¶ Request Dispatcher (n8n-nodes-base.switch)
[2025-11-25T00:56:18.363Z]   5. üìß Microsoft Graph Email Fetcher (n8n-nodes-base.httpRequest)
[2025-11-25T00:56:18.364Z]   6. üîç Email Intelligence Processor (n8n-nodes-base.code)
[2025-11-25T00:56:18.364Z]   7. ü§ñ AI Chat Handler (n8n-nodes-base.httpRequest)
[2025-11-25T00:56:18.364Z]   8. üìä Final Response Formatter (n8n-nodes-base.code)
[2025-11-25T00:56:18.364Z] 
Connections:
[2025-11-25T00:56:18.364Z]   Found 7 nodes with outputs:
[2025-11-25T00:56:18.364Z]     webhook_trigger ‚Üí smart_router
[2025-11-25T00:56:18.365Z]     manual_trigger ‚Üí smart_router
[2025-11-25T00:56:18.365Z]     smart_router ‚Üí request_dispatcher
[2025-11-25T00:56:18.365Z]     request_dispatcher ‚Üí ai_chat_handler
[2025-11-25T00:56:18.365Z]     outlook_email_fetcher ‚Üí email_intelligence
[2025-11-25T00:56:18.365Z]     email_intelligence ‚Üí final_response
[2025-11-25T00:56:18.365Z]     ai_chat_handler ‚Üí final_response
[2025-11-25T00:56:18.365Z] 
STEP 5: Identifying broken nodes...
[2025-11-25T00:56:18.366Z]   ‚ùå üåê API Webhook has NO output
[2025-11-25T00:56:18.366Z]   ‚ùå üß† Smart Request Router has NO output
[2025-11-25T00:56:18.366Z]   ‚ùå üö¶ Request Dispatcher has NO output
[2025-11-25T00:56:18.366Z]   ‚ùå üìß Microsoft Graph Email Fetcher has NO output
[2025-11-25T00:56:18.366Z]   ‚ùå üîç Email Intelligence Processor has NO output
[2025-11-25T00:56:18.366Z]   ‚ùå ü§ñ AI Chat Handler has NO output
[2025-11-25T00:56:18.366Z] 
‚ö†Ô∏è  Found 6 broken node(s)
[2025-11-25T00:56:18.366Z] 
=== SESSION COMPLETE ===
[2025-11-25T00:56:18.367Z] Check mcp-agent-log.txt for full details
