{"nodes":[{"name":"Outlook Email Trigger","type":"n8n-nodes-base.microsoftOutlookTrigger","position":[0,200],"typeVersion":1,"parameters":{"pollInterval":60},"credentials":{}},{"name":"Teams Message Trigger","type":"n8n-nodes-base.microsoftTeamsTrigger","position":[0,600],"typeVersion":1,"parameters":{},"credentials":{}},{"name":"Process Email for RAG","type":"n8n-nodes-base.code","position":[250,200],"typeVersion":1,"parameters":{"jsCode":"// Extract email body for RAG processing"},"credentials":{}},{"name":"Process Teams Input","type":"n8n-nodes-base.code","position":[250,600],"typeVersion":1,"parameters":{"jsCode":"// Prepare Teams message for agent"},"credentials":{}},{"name":"OpenAI Chat Model","type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","position":[500,0],"typeVersion":1,"parameters":{"model":"gpt-4o","options":{}},"credentials":{}},{"name":"Window Buffer Memory","type":"@n8n/n8n-nodes-langchain.memoryBufferWindow","position":[500,150],"typeVersion":1,"parameters":{},"credentials":{}},{"name":"Fraud Classifier","type":"@n8n/n8n-nodes-langchain.agent","position":[800,100],"typeVersion":1,"parameters":{"text":"You are a fraud detection expert. Analyze the email content for suspicious patterns.","options":{"systemMessage":"Classify the email as 'Fraud' or 'Safe'."}},"credentials":{}},{"name":"Billing RAG Agent","type":"@n8n/n8n-nodes-langchain.agent","position":[800,300],"typeVersion":1,"parameters":{"text":"You are a billing support agent. Answer questions about invoices and payments.","options":{"systemMessage":"Use the RAG tools to find billing information."}},"credentials":{}},{"name":"High Priority RAG Agent","type":"@n8n/n8n-nodes-langchain.agent","position":[800,500],"typeVersion":1,"parameters":{"text":"You are a priority support agent. Handle urgent requests immediately.","options":{"systemMessage":"Prioritize this request above all others."}},"credentials":{}},{"name":"AI Agent (Central)","type":"@n8n/n8n-nodes-langchain.agent","position":[500,800],"typeVersion":1,"parameters":{"text":"You are the central orchestrator. Coordinate between specialized agents and tools.","options":{"systemMessage":"Route the request to the appropriate agent or tool."}},"credentials":{}},{"name":"Postgres Memory","type":"n8n-nodes-base.postgres","position":[900,700],"typeVersion":1,"parameters":{"operation":"executeQuery"},"credentials":{}},{"name":"Search Emails","type":"n8n-nodes-base.microsoftOutlook","position":[900,850],"typeVersion":2,"parameters":{"resource":"message","operation":"getAll"},"credentials":{}},{"name":"Get Calendar Events","type":"n8n-nodes-base.microsoftOutlook","position":[900,1000],"typeVersion":2,"parameters":{"resource":"event","operation":"getAll"},"credentials":{}},{"name":"Create Calendar Event","type":"n8n-nodes-base.microsoftOutlook","position":[1100,1000],"typeVersion":2,"parameters":{"resource":"event","operation":"create","subject":"Meeting","startDateTime":"2024-01-01T09:00:00","endDateTime":"2024-01-01T10:00:00"},"credentials":{}},{"name":"Create Draft","type":"n8n-nodes-base.microsoftOutlook","position":[1100,850],"typeVersion":2,"parameters":{"resource":"message","operation":"send","toRecipients":"draft@example.com","body":"Draft content"},"credentials":{}},{"name":"Send Email","type":"n8n-nodes-base.microsoftOutlook","position":[1300,850],"typeVersion":2,"parameters":{"resource":"message","operation":"send","toRecipients":"recipient@example.com","subject":"Hello","body":"Content"},"credentials":{}},{"name":"Send Teams Response","type":"n8n-nodes-base.microsoftTeams","position":[900,1150],"typeVersion":2,"parameters":{"operation":"sendMessage","content":"Response"},"credentials":{}}],"connections":{"Outlook Email Trigger":{"main":[[{"node":"Process Email for RAG","type":"main","index":0}]]},"Process Email for RAG":{"main":[[{"node":"Fraud Classifier","type":"main","index":0},{"node":"Billing RAG Agent","type":"main","index":0},{"node":"High Priority RAG Agent","type":"main","index":0}]]},"Teams Message Trigger":{"main":[[{"node":"Process Teams Input","type":"main","index":0}]]},"Process Teams Input":{"main":[[{"node":"AI Agent (Central)","type":"main","index":0}]]},"AI Agent (Central)":{"main":[[{"node":"Send Teams Response","type":"main","index":0}]]},"OpenAI Chat Model":{"ai_languageModel":[[{"node":"Fraud Classifier","type":"ai_languageModel","index":0},{"node":"Billing RAG Agent","type":"ai_languageModel","index":0},{"node":"High Priority RAG Agent","type":"ai_languageModel","index":0},{"node":"AI Agent (Central)","type":"ai_languageModel","index":0}]]},"Window Buffer Memory":{"ai_memory":[[{"node":"Fraud Classifier","type":"ai_memory","index":0},{"node":"Billing RAG Agent","type":"ai_memory","index":0},{"node":"High Priority RAG Agent","type":"ai_memory","index":0},{"node":"AI Agent (Central)","type":"ai_memory","index":0}]]},"Postgres Memory":{"ai_tool":[[{"node":"AI Agent (Central)","type":"ai_tool","index":0}]]},"Search Emails":{"ai_tool":[[{"node":"AI Agent (Central)","type":"ai_tool","index":0}]]},"Get Calendar Events":{"ai_tool":[[{"node":"AI Agent (Central)","type":"ai_tool","index":0}]]},"Create Calendar Event":{"ai_tool":[[{"node":"AI Agent (Central)","type":"ai_tool","index":0}]]},"Create Draft":{"ai_tool":[[{"node":"AI Agent (Central)","type":"ai_tool","index":0}]]},"Send Email":{"ai_tool":[[{"node":"AI Agent (Central)","type":"ai_tool","index":0}]]}},"name":"Teams-Outlook RAG Assistant - Natural Language Ready (Fixed)","active":true,"tags":["auto-fixed"]}