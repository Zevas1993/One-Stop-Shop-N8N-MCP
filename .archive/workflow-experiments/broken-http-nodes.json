[
  {
    "id": "outlook_email_fetcher",
    "name": "ðŸ“§ Microsoft Graph Email Fetcher",
    "type": "n8n-nodes-base.httpRequest",
    "position": [
      850,
      400
    ],
    "parameters": {
      "requestMethod": "GET",
      "url": "https://graph.microsoft.com/v1.0/me/mailfolders/inbox/messages",
      "qs": {
        "$top": "={{ $json.emailConfig.maxEmails }}",
        "$select": "id,subject,body,bodyPreview,from,to,receivedDateTime,hasAttachments,importance"
      },
      "authentication": "predefinedCredential",
      "options": {}
    },
    "typeVersion": 5,
    "credentials": {}
  },
  {
    "id": "ai_chat_handler",
    "name": "ðŸ¤– AI Chat Handler",
    "type": "n8n-nodes-base.httpRequest",
    "position": [
      850,
      200
    ],
    "parameters": {
      "requestMethod": "POST",
      "url": "https://api.openai.com/v1/chat/completions",
      "authentication": "predefinedCredential",
      "sendHeaders": true,
      "headerParameters": {
        "parameters": [
          {
            "name": "Content-Type",
            "value": "application/json"
          }
        ]
      },
      "sendBody": true,
      "bodyContentType": "json",
      "jsonBody": "{\n  \"model\": \"{{ $json.aiConfig.model }}\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are an expert AI email assistant. Provide helpful responses based on user queries about their emails.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"{{ $json.userMessage }}\"\n    }\n  ],\n  \"max_tokens\": {{ $json.aiConfig.maxTokens }},\n  \"temperature\": {{ $json.aiConfig.temperature }}\n}",
      "options": {}
    },
    "typeVersion": 5,
    "credentials": {}
  }
]